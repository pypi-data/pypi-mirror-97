"use strict";
/* Copyright: Ankitects Pty Ltd and contributors
 * License: GNU AGPL, version 3 or later; http://www.gnu.org/licenses/agpl.html */
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var ankiPlatform = "desktop";
var typeans;
var _updatingQueue = Promise.resolve();
var qFade = 50;
var aFade = 0;
var onUpdateHook;
var onShownHook;
function _runHook(arr) {
    const promises = [];
    for (let i = 0; i < arr.length; i++) {
        promises.push(arr[i]());
    }
    return Promise.all(promises);
}
function _queueAction(action) {
    _updatingQueue = _updatingQueue.then(action);
}
function _updateQA(html, fadeTime, onupdate, onshown) {
    return __awaiter(this, void 0, void 0, function* () {
        onUpdateHook = [onupdate];
        onShownHook = [onshown];
        const qa = $("#qa");
        const renderError = (kind) => (error) => {
            const errorMessage = String(error).substring(0, 2000);
            const errorStack = String(error.stack).substring(0, 2000);
            qa.html(`Invalid ${kind} on card: ${errorMessage}\n${errorStack}`.replace(/\n/g, "<br />"));
        };
        // fade out current text
        yield qa.fadeTo(fadeTime, 0).promise();
        // update text
        try {
            qa.html(html);
        }
        catch (error) {
            renderError("HTML")(error);
        }
        yield _runHook(onUpdateHook);
        // wait for mathjax to ready
        yield MathJax.startup.promise
            .then(() => {
            // clear MathJax buffers from previous typesets
            MathJax.typesetClear();
            return MathJax.typesetPromise(qa.slice(0, 1));
        })
            .catch(renderError("MathJax"));
        // and reveal when processing is done
        yield qa.fadeTo(fadeTime, 1).promise();
        yield _runHook(onShownHook);
    });
}
function _showQuestion(q, bodyclass) {
    _queueAction(() => _updateQA(q, qFade, function () {
        // return to top of window
        window.scrollTo(0, 0);
        document.body.className = bodyclass;
    }, function () {
        // focus typing area if visible
        typeans = document.getElementById("typeans");
        if (typeans) {
            typeans.focus();
        }
    }));
}
function _showAnswer(a, bodyclass) {
    _queueAction(() => _updateQA(a, aFade, function () {
        if (bodyclass) {
            //  when previewing
            document.body.className = bodyclass;
        }
        // scroll to answer?
        var e = $("#answer");
        if (e[0]) {
            e[0].scrollIntoView();
        }
    }, function () { }));
}
const _flagColours = {
    1: "#ff6666",
    2: "#ff9900",
    3: "#77ff77",
    4: "#77aaff",
};
function _drawFlag(flag) {
    var elem = $("#_flag");
    if (flag === 0) {
        elem.hide();
        return;
    }
    elem.show();
    elem.css("color", _flagColours[flag]);
}
function _drawMark(mark) {
    var elem = $("#_mark");
    if (!mark) {
        elem.hide();
    }
    else {
        elem.show();
    }
}
function _typeAnsPress() {
    if (window.event.keyCode === 13) {
        pycmd("ans");
    }
}
function _emulateMobile(enabled) {
    const list = document.documentElement.classList;
    if (enabled) {
        list.add("mobile");
    }
    else {
        list.remove("mobile");
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmV2aWV3ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9xdC9hcXQvZGF0YS93ZWIvanMvcmV2aWV3ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO2tGQUNrRjs7Ozs7Ozs7OztBQU1sRixJQUFJLFlBQVksR0FBRyxTQUFTLENBQUM7QUFDN0IsSUFBSSxPQUFPLENBQUM7QUFDWixJQUFJLGNBQWMsR0FBa0IsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO0FBRXRELElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQztBQUNmLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztBQUVkLElBQUksWUFBNkIsQ0FBQztBQUNsQyxJQUFJLFdBQTRCLENBQUM7QUFFakMsU0FBUyxRQUFRLENBQUMsR0FBb0I7SUFDbEMsTUFBTSxRQUFRLEdBQUcsRUFBRSxDQUFDO0lBRXBCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ2pDLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUMzQjtJQUVELE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNqQyxDQUFDO0FBRUQsU0FBUyxZQUFZLENBQUMsTUFBZ0I7SUFDbEMsY0FBYyxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUVELFNBQWUsU0FBUyxDQUNwQixJQUFZLEVBQ1osUUFBZ0IsRUFDaEIsUUFBa0IsRUFDbEIsT0FBaUI7O1FBRWpCLFlBQVksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzFCLFdBQVcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXhCLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNw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QVM7SUFDWixDQUFDLEVBQUUsU0FBUztJQUNaLENBQUMsRUFBRSxTQUFTO0lBQ1osQ0FBQyxFQUFFLFNBQVM7Q0FDZixDQUFDO0FBRUYsU0FBUyxTQUFTLENBQUMsSUFBdUI7SUFDdEMsSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3ZCLElBQUksSUFBSSxLQUFLLENBQUMsRUFBRTtRQUNaLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNaLE9BQU87S0FDVjtJQUNELElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNaLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQzFDLENBQUM7QUFFRCxTQUFTLFNBQVMsQ0FBQyxJQUFhO0lBQzVCLElBQUksSUFBSSxHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUN2QixJQUFJLENBQUMsSUFBSSxFQUFFO1FBQ1AsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0tBQ2Y7U0FBTTtRQUNILElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztLQUNmO0FBQ0wsQ0FBQztBQUVELFNBQVMsYUFBYTtJQUNsQixJQUFLLE1BQU0sQ0FBQyxLQUF1QixDQUFDLE9BQU8sS0FBSyxFQUFFLEVBQUU7UUFDaEQsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ2hCO0FBQ0wsQ0FBQztBQUVELFNBQVMsY0FBYyxDQUFDLE9BQWdCO0lBQ3BDLE1BQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDO0lBQ2hELElBQUksT0FBTyxFQUFFO1FBQ1QsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUN0QjtTQUFNO1FBQ0gsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUN6QjtBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBDb3B5cmlnaHQ6IEFua2l0ZWN0cyBQdHkgTHRkIGFuZCBjb250cmlidXRvcnNcbiAqIExpY2Vuc2U6IEdOVSBBR1BMLCB2ZXJzaW9uIDMgb3IgbGF0ZXI7IGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9hZ3BsLmh0bWwgKi9cblxuZGVjbGFyZSB2YXIgTWF0aEpheDogYW55O1xuXG50eXBlIENhbGxiYWNrID0gKCkgPT4gdm9pZCB8IFByb21pc2U8dm9pZD47XG5cbnZhciBhbmtpUGxhdGZvcm0gPSBcImRlc2t0b3BcIjtcbnZhciB0eXBlYW5zO1xudmFyIF91cGRhdGluZ1F1ZXVlOiBQcm9taXNlPHZvaWQ+ID0gUHJvbWlzZS5yZXNvbHZlKCk7XG5cbnZhciBxRmFkZSA9IDUwO1xudmFyIGFGYWRlID0gMDtcblxudmFyIG9uVXBkYXRlSG9vazogQXJyYXk8Q2FsbGJhY2s+O1xudmFyIG9uU2hvd25Ib29rOiBBcnJheTxDYWxsYmFjaz47XG5cbmZ1bmN0aW9uIF9ydW5Ib29rKGFycjogQXJyYXk8Q2FsbGJhY2s+KTogUHJvbWlzZTx2b2lkW10+IHtcbiAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcHJvbWlzZXMucHVzaChhcnJbaV0oKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTtcbn1cblxuZnVuY3Rpb24gX3F1ZXVlQWN0aW9uKGFjdGlvbjogQ2FsbGJhY2spOiB2b2lkIHtcbiAgICBfdXBkYXRpbmdRdWV1ZSA9IF91cGRhdGluZ1F1ZXVlLnRoZW4oYWN0aW9uKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gX3VwZGF0ZVFBKFxuICAgIGh0bWw6IHN0cmluZyxcbiAgICBmYWRlVGltZTogbnVtYmVyLFxuICAgIG9udXBkYXRlOiBDYWxsYmFjayxcbiAgICBvbnNob3duOiBDYWxsYmFja1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgb25VcGRhdGVIb29rID0gW29udXBkYXRlXTtcbiAgICBvblNob3duSG9vayA9IFtvbnNob3duXTtcblxuICAgIGNvbnN0IHFhID0gJChcIiNxYVwiKTtcbiAgICBjb25zdCByZW5kZXJFcnJvciA9IChraW5kOiBzdHJpbmcpID0+IChlcnJvcjogRXJyb3IpOiB2b2lkID0+IHtcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gU3RyaW5nKGVycm9yKS5zdWJzdHJpbmcoMCwgMjAwMCk7XG4gICAgICAgIGNvbnN0IGVycm9yU3RhY2sgPSBTdHJpbmcoZXJyb3Iuc3RhY2spLnN1YnN0cmluZygwLCAyMDAwKTtcblxuICAgICAgICBxYS5odG1sKFxuICAgICAgICAgICAgYEludmFsaWQgJHtraW5kfSBvbiBjYXJkOiAke2Vycm9yTWVzc2FnZX1cXG4ke2Vycm9yU3RhY2t9YC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgIC9cXG4vZyxcbiAgICAgICAgICAgICAgICBcIjxiciAvPlwiXG4gICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIC8vIGZhZGUgb3V0IGN1cnJlbnQgdGV4dFxuICAgIGF3YWl0IHFhLmZhZGVUbyhmYWRlVGltZSwgMCkucHJvbWlzZSgpO1xuXG4gICAgLy8gdXBkYXRlIHRleHRcbiAgICB0cnkge1xuICAgICAgICBxYS5odG1sKGh0bWwpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlbmRlckVycm9yKFwiSFRNTFwiKShlcnJvcik7XG4gICAgfVxuXG4gICAgYXdhaXQgX3J1bkhvb2sob25VcGRhdGVIb29rKTtcblxuICAgIC8vIHdhaXQgZm9yIG1hdGhqYXggdG8gcmVhZHlcbiAgICBhd2FpdCBNYXRoSmF4LnN0YXJ0dXAucHJvbWlzZVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAvLyBjbGVhciBNYXRoSmF4IGJ1ZmZlcnMgZnJvbSBwcmV2aW91cyB0eXBlc2V0c1xuICAgICAgICAgICAgTWF0aEpheC50eXBlc2V0Q2xlYXIoKTtcblxuICAgICAgICAgICAgcmV0dXJuIE1hdGhKYXgudHlwZXNldFByb21pc2UocWEuc2xpY2UoMCwgMSkpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2gocmVuZGVyRXJyb3IoXCJNYXRoSmF4XCIpKTtcblxuICAgIC8vIGFuZCByZXZlYWwgd2hlbiBwcm9jZXNzaW5nIGlzIGRvbmVcbiAgICBhd2FpdCBxYS5mYWRlVG8oZmFkZVRpbWUsIDEpLnByb21pc2UoKTtcbiAgICBhd2FpdCBfcnVuSG9vayhvblNob3duSG9vayk7XG59XG5cbmZ1bmN0aW9uIF9zaG93UXVlc3Rpb24ocTogc3RyaW5nLCBib2R5Y2xhc3M6IHN0cmluZyk6IHZvaWQge1xuICAgIF9xdWV1ZUFjdGlvbigoKSA9PlxuICAgICAgICBfdXBkYXRlUUEoXG4gICAgICAgICAgICBxLFxuICAgICAgICAgICAgcUZhZGUsXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRvIHRvcCBvZiB3aW5kb3dcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG5cbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTmFtZSA9IGJvZHljbGFzcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gZm9jdXMgdHlwaW5nIGFyZWEgaWYgdmlzaWJsZVxuICAgICAgICAgICAgICAgIHR5cGVhbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInR5cGVhbnNcIik7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVhbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZWFucy5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICk7XG59XG5cbmZ1bmN0aW9uIF9zaG93QW5zd2VyKGE6IHN0cmluZywgYm9keWNsYXNzOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBfcXVldWVBY3Rpb24oKCkgPT5cbiAgICAgICAgX3VwZGF0ZVFBKFxuICAgICAgICAgICAgYSxcbiAgICAgICAgICAgIGFGYWRlLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChib2R5Y2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gIHdoZW4gcHJldmlld2luZ1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTmFtZSA9IGJvZHljbGFzcztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBzY3JvbGwgdG8gYW5zd2VyP1xuICAgICAgICAgICAgICAgIHZhciBlID0gJChcIiNhbnN3ZXJcIik7XG4gICAgICAgICAgICAgICAgaWYgKGVbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgZVswXS5zY3JvbGxJbnRvVmlldygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7fVxuICAgICAgICApXG4gICAgKTtcbn1cblxuY29uc3QgX2ZsYWdDb2xvdXJzID0ge1xuICAgIDE6IFwiI2ZmNjY2NlwiLFxuICAgIDI6IFwiI2ZmOTkwMFwiLFxuICAgIDM6IFwiIzc3ZmY3N1wiLFxuICAgIDQ6IFwiIzc3YWFmZlwiLFxufTtcblxuZnVuY3Rpb24gX2RyYXdGbGFnKGZsYWc6IDAgfCAxIHwgMiB8IDMgfCA0KTogdm9pZCB7XG4gICAgdmFyIGVsZW0gPSAkKFwiI19mbGFnXCIpO1xuICAgIGlmIChmbGFnID09PSAwKSB7XG4gICAgICAgIGVsZW0uaGlkZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsZW0uc2hvdygpO1xuICAgIGVsZW0uY3NzKFwiY29sb3JcIiwgX2ZsYWdDb2xvdXJzW2ZsYWddKTtcbn1cblxuZnVuY3Rpb24gX2RyYXdNYXJrKG1hcms6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB2YXIgZWxlbSA9ICQoXCIjX21hcmtcIik7XG4gICAgaWYgKCFtYXJrKSB7XG4gICAgICAgIGVsZW0uaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW0uc2hvdygpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX3R5cGVBbnNQcmVzcygpOiB2b2lkIHtcbiAgICBpZiAoKHdpbmRvdy5ldmVudCBhcyBLZXlib2FyZEV2ZW50KS5rZXlDb2RlID09PSAxMykge1xuICAgICAgICBweWNtZChcImFuc1wiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9lbXVsYXRlTW9iaWxlKGVuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdDtcbiAgICBpZiAoZW5hYmxlZCkge1xuICAgICAgICBsaXN0LmFkZChcIm1vYmlsZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBsaXN0LnJlbW92ZShcIm1vYmlsZVwiKTtcbiAgICB9XG59XG4iXX0=