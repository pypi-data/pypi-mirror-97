<div class="part" ng-show="sections">
	<section ng-repeat="sec_info in sections" class="section section_rec_{{section_list[sec_info.id].depth}}" ng-class="{'highlight': hasHighlightedTags(tagTypeList(sectionTags(section_list[sec_info.id])))}">
		<div class="{{section_list[sec_info.id].heuristic.score | section_color}}"></div>
		<div class="indent_{{section_list[sec_info.id].depth}}" style="width: 100%">
			<div class="result_title" data-toggle="collapse" data-target="#{{parent}}_s{{sec_info.id}}" ng-class="{'highlight': hasHighlightedTags(tagTypeList(sectionTags(section_list[sec_info.id])))}"><span class="text-info"><strong><span class="{{section_list[sec_info.id].classification | class_text_color }}" ng-if="user.c12n_enforcing">({{section_list[sec_info.id].classification | class_sm}})&nbsp;&nbsp;</span><span ng-if="section_list[sec_info.id].heuristic.score" title="{{section_list[sec_info.id].heuristic.score | score_label}} (Score: {{ section_list[sec_info.id].heuristic.score }})" class="text-fixed label label-tag {{section_list[sec_info.id].heuristic.score | label_color}}"><strong>{{section_list[sec_info.id].heuristic.score | score_label | firstLetter }}</strong></span><span ng-if="section_list[sec_info.id].heuristic.score" class="text-muted">::&nbsp;</span></strong></span><span replace-tags  data="section_list[sec_info.id].title_text" tags="tagTypeList(section_list[sec_info.id].tags)"></span></div>
			<div id="{{parent}}_s{{sec_info.id}}" class="collapse in">
				<div ng-if="section_list[sec_info.id].body_format=='TEXT'&&section_list[sec_info.id].body!=null" class="result_body"><div replace-tags data="section_list[sec_info.id].body" tags="tagTypeList(section_list[sec_info.id].tags)"></div></div>
				<pre ng-if="section_list[sec_info.id].body_format=='MEMORY_DUMP'&&section_list[sec_info.id].body!=null" class="result_body">{{section_list[sec_info.id].body}}</pre>
				<div graph-section ng-if="section_list[sec_info.id].body_format=='GRAPH_DATA'&&section_list[sec_info.id].body!=null" class="result_body" ng-model="section_list[sec_info.id].body"></div>
				<div url-section ng-if="section_list[sec_info.id].body_format=='URL'&&section_list[sec_info.id].body!=null" class="result_body" ng-model="section_list[sec_info.id].body"></div>
				<div ng-if="section_list[sec_info.id].body_format=='JSON'&&section_list[sec_info.id].body!=null" class="result_body"><div ng-jsoneditor ng-model="section_list[sec_info.id].body" options="{'mode': 'view'}" style="width: 100%; height: 300px;"></div></div>
				<div kv-section ng-if="section_list[sec_info.id].body_format=='KEY_VALUE'&&section_list[sec_info.id].body!=null" class="result_body" ng-model="section_list[sec_info.id].body"></div>
				<div nc-section ng-if="section_list[sec_info.id].body_format=='PROCESS_TREE'&&section_list[sec_info.id].body!=null" class="result_body" ng-model="section_list[sec_info.id].body"></div>
				<div table-section ng-if="section_list[sec_info.id].body_format=='TABLE'&&section_list[sec_info.id].body!=null" class="result_body" ng-model="section_list[sec_info.id].body"></div>

				<div style="margin-left: 2.5em; margin-bottom: .25em;" ng-if="section_list[sec_info.id].heuristic||section_list[sec_info.id].tags.length!=0">
					<span ng-if="section_list[sec_info.id].heuristic" title="Malware heuristic: {{section_list[sec_info.id].heuristic.name}} [{{section_list[sec_info.id].heuristic.heur_id}}]" class="label label-tag {{section_list[sec_info.id].heuristic.score | label_color}}" style="cursor: pointer;" ng-class="{'label-highlight': isHighlighted('heuristic', section_list[sec_info.id].heuristic.heur_id)}" ng-click="trigger_highlight('heuristic', section_list[sec_info.id].heuristic.heur_id);" >[HEURISTIC] {{section_list[sec_info.id].heuristic.name | breakableStr }}<a href='/search.html?search_scope=result&query=result.sections.heuristic.name:"{{section_list[sec_info.id].heuristic.name}}"' class="search_tag clickable_color glyphicon glyphicon-search" ng-click="$event.stopPropagation();"></a></span>
					<span ng-if="section_list[sec_info.id].heuristic.attack.length!=0" ng-repeat="attack in section_list[sec_info.id].heuristic.attack" title="ATT&CK Pattern: {{attack.pattern}} [{{attack.attack_id}}]" class="label label-tag {{section_list[sec_info.id].heuristic.score | label_color}}" style="cursor: pointer;" ng-class="{'label-highlight': isHighlighted('attack_pattern', attack.attack_id)}" ng-click="trigger_highlight('attack_pattern', attack.attack_id);">[ATT&CK] {{attack.pattern | breakableStr }}<a href='/search.html?search_scope=result&query=result.sections.heuristic.attack.pattern:"{{uri_encode(attack.pattern)}}"' class="search_tag clickable_color glyphicon glyphicon-search" ng-click="$event.stopPropagation();"></a></span>
					<span ng-if="section_list[sec_info.id].heuristic.signature.length!=0" ng-repeat="signature in section_list[sec_info.id].heuristic.signature" title="Heuristic Signature: {{signature.name}} [Frequency: {{signature.frequency}}x]" class="label label-tag {{section_list[sec_info.id].heuristic.score | label_color}}" style="cursor: pointer;" ng-class="{'label-highlight': isHighlighted('heuristic.signature', signature.name)}" ng-click="trigger_highlight('heuristic.signature', signature.name);">[SIGNATURE] {{signature.name | breakableStr }}<span style="display: contents" ng-if="signature.frequency>1">&nbsp;&nbsp;({{signature.frequency}}x)</span><a href='/search.html?search_scope=result&query=result.sections.heuristic.signature.name:"{{uri_encode(signature.name)}}"' class="search_tag clickable_color glyphicon glyphicon-search" ng-click="$event.stopPropagation();"></a></span>
					<span title="{{tag.type}}: {{tag.value}}" class="label label-tag {{section_list[sec_info.id].heuristic.score | label_color}}" style="cursor: pointer;" ng-repeat="tag in section_list[sec_info.id].tags | orderBy:'type'" ng-class="{'label-highlight': isHighlighted(tag.type, tag.value)}" ng-click="trigger_highlight(tag.type, tag.value);" >[{{tag.short_type.toUpperCase()}}] {{tag.value | breakableStr }}<a href='/search.html?search_scope=result&query=result.sections.tags.{{tag.type}}:"{{uri_encode(tag.value)}}"' class="search_tag clickable_color glyphicon glyphicon-search" ng-click="$event.stopPropagation();"></a></span>
				</div>
				<div ng-if="sec_info.children.length != 0" >
					<div ng-include="'/static/ng-template/result_section_rec.html'" ng-init="sections=sec_info.children;section_list=section_list;parent=parent;"></div>
				</div>
				<div style="min-height: 8px" ng-if="sec_info.children.length == 0 && section_list[sec_info.id].body!=null"></div>
			</div>
		</div>
	</section>
</div>

