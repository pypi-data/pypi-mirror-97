

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>API Reference &mdash; astLib  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://assets.readthedocs.org/static/css/badge_only.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Introduction and Installation" href="usage.html" /> 

<!-- RTD Extra Head -->

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": "", "api_host": "", "build_date": "2021-02-03T11:39:08Z", "builder": "sphinx", "canonical_url": "", "commit": "", "docroot": "", "features": {"docsearch_disabled": false}, "global_analytics_code": null, "language": "", "page": "reference", "programming_language": "", "project": "", "source_suffix": ".rst", "subprojects": {}, "theme": "", "user_analytics_code": null, "version": ""}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> astLib
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Introduction and Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-astLib.astCalc">astCalc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-astLib.astCoords">astCoords</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-astLib.astImages">astImages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-astLib.astPlots">astPlots</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-astLib.astWCS">astWCS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-astLib.astSED">astSED</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">astLib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API Reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/reference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-reference">
<span id="referencepage"></span><h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<p>You can find automatically generated documentation for each module in the <code class="docutils literal notranslate"><span class="pre">astLib</span></code> package below.</p>
<div class="section" id="module-astLib.astCalc">
<span id="astcalc"></span><h2>astCalc<a class="headerlink" href="#module-astLib.astCalc" title="Permalink to this headline">¶</a></h2>
<p>Module for performing common calculations.</p>
<ol class="loweralpha simple" start="3">
<li><p>2007-2011 Matt Hilton</p></li>
</ol>
<ol class="loweralpha simple" start="3">
<li><p>2013-2014 Matt Hilton &amp; Steven Boada</p></li>
</ol>
<p>The focus in this module is at present on calculations of distances in a given
cosmology. The parameters for the cosmological model are set using the
variables OMEGA_M0, OMEGA_L0, OMEGA_R0, H0 in the module namespace.</p>
<dl class="py data">
<dt id="astLib.astCalc.C_LIGHT">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">C_LIGHT</code><em class="property"> = 300000.0</em><a class="headerlink" href="#astLib.astCalc.C_LIGHT" title="Permalink to this definition">¶</a></dt>
<dd><p>The speed of light in km/s.</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.DeltaVz">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">DeltaVz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.DeltaVz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the density contrast of a virialised region S{Delta}V(z),
assuming a S{Lambda}CDM-type flat cosmology. See, e.g., Bryan &amp; Norman
1998 (ApJ, 495, 80).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>density contrast of a virialised region at redshift z</p>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>If OMEGA_M0+OMEGA_L0 is not equal to 1, this routine exits and</p>
</dd>
</dl>
<p>prints an error
message to the console.</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.Ez">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">Ez</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.Ez" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the value of E(z), which describes evolution of the Hubble
parameter with redshift, at redshift z for the current set of cosmological
parameters. See, e.g., Bryan &amp; Norman 1998 (ApJ, 495, 80).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>value of E(z) at redshift z</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.Ez2">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">Ez2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.Ez2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the value of E(z)^2, which describes evolution of the Hubble
parameter with redshift, at redshift z for the current set of cosmological
parameters. See, e.g., Bryan &amp; Norman 1998 (ApJ, 495, 80).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>value of E(z)^2 at redshift z</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt id="astLib.astCalc.H0">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">H0</code><em class="property"> = 70.0</em><a class="headerlink" href="#astLib.astCalc.H0" title="Permalink to this definition">¶</a></dt>
<dd><p>The Hubble parameter (in km/s/Mpc) at z=0.</p>
</dd></dl>

<dl class="py data">
<dt id="astLib.astCalc.OMEGA_L0">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">OMEGA_L0</code><em class="property"> = 0.7</em><a class="headerlink" href="#astLib.astCalc.OMEGA_L0" title="Permalink to this definition">¶</a></dt>
<dd><p>The dark energy density (in the form of a cosmological constant) at z=0.</p>
</dd></dl>

<dl class="py data">
<dt id="astLib.astCalc.OMEGA_M0">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">OMEGA_M0</code><em class="property"> = 0.3</em><a class="headerlink" href="#astLib.astCalc.OMEGA_M0" title="Permalink to this definition">¶</a></dt>
<dd><p>The matter density parameter at z=0.</p>
</dd></dl>

<dl class="py data">
<dt id="astLib.astCalc.OMEGA_R0">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">OMEGA_R0</code><em class="property"> = 8.24e-05</em><a class="headerlink" href="#astLib.astCalc.OMEGA_R0" title="Permalink to this definition">¶</a></dt>
<dd><p>The radiation density at z=0 (note this is only used currently in calculation of <a class="reference internal" href="#astLib.astCalc.Ez" title="astLib.astCalc.Ez"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Ez</span></code></a>).</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.OmegaLz">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">OmegaLz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.OmegaLz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the dark energy density of the universe at redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dark energy density of universe at redshift z</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.OmegaMz">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">OmegaMz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.OmegaMz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the matter density of the universe at redshift z. See, e.g.,
Bryan &amp; Norman 1998 (ApJ, 495, 80).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>matter density of universe at redshift z</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.OmegaRz">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">OmegaRz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.OmegaRz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the radiation density of the universe at redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>radiation density of universe at redshift z</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.RVirialXRayCluster">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">RVirialXRayCluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kT</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">betaT</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.RVirialXRayCluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the virial radius (in Mpc) of a galaxy cluster at redshift z
with X-ray temperature kT, assuming self-similar evolution and a flat
cosmology. See Arnaud et al. 2002 (A&amp;A, 389, 1) and Bryan &amp; Norman 1998
(ApJ, 495, 80). A flat S{Lambda}CDM-type flat cosmology is assumed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kT</strong> (<em>float</em>) – cluster X-ray temperature in keV</p></li>
<li><p><strong>z</strong> (<em>float</em>) – redshift</p></li>
<li><p><strong>betaT</strong> (<em>float</em>) – the normalisation of the virial relation, for which Evrard et</p></li>
</ul>
</dd>
</dl>
<p>al. 1996 (ApJ,469, 494) find a value of 1.05
:rtype: float
:return: virial radius of cluster in Mpc</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>If OMEGA_M0+OMEGA_L0 is not equal to 1, this routine exits and</p>
</dd>
</dl>
<p>prints an error message to the console.</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.absMag">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">absMag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">appMag</span></em>, <em class="sig-param"><span class="n">distMpc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.absMag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the absolute magnitude of an object at given luminosity
distance in Mpc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>appMag</strong> (<em>float</em>) – apparent magnitude of object</p></li>
<li><p><strong>distMpc</strong> (<em>float</em>) – distance to object in Mpc</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>absolute magnitude of object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.dVcdz">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">dVcdz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.dVcdz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the line of sight comoving volume element per steradian dV/dz
at redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>comoving volume element per steradian</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.da">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">da</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.da" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angular diameter distance in Mpc at redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>angular diameter distance in Mpc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.dc">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">dc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.dc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the line of sight comoving distance in Mpc at redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>transverse comoving distance (proper motion distance) in Mpc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.dc2z">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">dc2z</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">distanceMpc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.dc2z" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the redshift z corresponding to the comoving distance given
in Mpc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>distanceMpc</strong> (<em>float</em>) – distance in Mpc</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>redshift</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.dl">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">dl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.dl" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the luminosity distance in Mpc at redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>luminosity distance in Mpc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.dl2z">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">dl2z</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">distanceMpc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.dl2z" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the redshift z corresponding to the luminosity distance given
in Mpc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>distanceMpc</strong> (<em>float</em>) – distance in Mpc</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>redshift</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.dm">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">dm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.dm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the transverse comoving distance (proper motion distance) in
Mpc at redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>transverse comoving distance (proper motion distance) in Mpc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.t0">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">t0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.t0" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the age of the universe in Gyr at z=0 for the current set of
cosmological parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>age of the universe in Gyr at z=0</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.tl">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">tl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.tl" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the lookback time in Gyr to redshift z for the current set
of cosmological parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>lookback time in Gyr to redshift z</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.tl2z">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">tl2z</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tlGyr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.tl2z" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the redshift z corresponding to lookback time tlGyr given in
Gyr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tlGyr</strong> (<em>float</em>) – lookback time in Gyr</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>redshift</p>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>Raises ValueError if tlGyr is not positive.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.tz">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">tz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.tz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the age of the universe at redshift z for the current set of
cosmological parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>age of the universe in Gyr at redshift z</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCalc.tz2z">
<code class="sig-prename descclassname">astLib.astCalc.</code><code class="sig-name descname">tz2z</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tzGyr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCalc.tz2z" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the redshift z corresponding to age of the universe tzGyr
given in Gyr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tzGyr</strong> (<em>float</em>) – age of the universe in Gyr</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>redshift</p>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>Raises ValueError if Universe age not positive</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-astLib.astCoords">
<span id="astcoords"></span><h2>astCoords<a class="headerlink" href="#module-astLib.astCoords" title="Permalink to this headline">¶</a></h2>
<p>Module for coordinate manipulation (conversions, calculations etc.).</p>
<ol class="loweralpha simple" start="3">
<li><p>2007-2012 Matt Hilton</p></li>
</ol>
<ol class="loweralpha simple" start="3">
<li><p>2013-2016 Matt Hilton &amp; Steven Boada</p></li>
</ol>
<dl class="py function">
<dt id="astLib.astCoords.calcAngSepDeg">
<code class="sig-prename descclassname">astLib.astCoords.</code><code class="sig-name descname">calcAngSepDeg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">RADeg1</span></em>, <em class="sig-param"><span class="n">decDeg1</span></em>, <em class="sig-param"><span class="n">RADeg2</span></em>, <em class="sig-param"><span class="n">decDeg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCoords.calcAngSepDeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angular separation of two positions on the sky (specified
in decimal degrees) in decimal degrees. Note that RADeg2, decDeg2 can be numpy
arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RADeg1</strong> (<em>float</em>) – R.A. in decimal degrees for position 1</p></li>
<li><p><strong>decDeg1</strong> (<em>float</em>) – dec. in decimal degrees for position 1</p></li>
<li><p><strong>RADeg2</strong> (<em>float</em><em> or </em><em>numpy array</em>) – R.A. in decimal degrees for position 2</p></li>
<li><p><strong>decDeg2</strong> (<em>float</em><em> or </em><em>numpy array</em>) – dec. in decimal degrees for position 2</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float or numpy array, depending upon type of RADeg2, decDeg2</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>angular separation in decimal degrees</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCoords.calcRADecSearchBox">
<code class="sig-prename descclassname">astLib.astCoords.</code><code class="sig-name descname">calcRADecSearchBox</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">RADeg</span></em>, <em class="sig-param"><span class="n">decDeg</span></em>, <em class="sig-param"><span class="n">radiusSkyDeg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCoords.calcRADecSearchBox" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates minimum and maximum RA, dec coords needed to define a box
enclosing a circle of radius radiusSkyDeg around the given RADeg, decDeg
coordinates. Useful for freeform queries of e.g. SDSS, UKIDSS etc.. Uses
<a class="reference internal" href="#astLib.astCoords.calcAngSepDeg" title="astLib.astCoords.calcAngSepDeg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calcAngSepDeg</span></code></a>, so has the same limitations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RADeg</strong> (<em>float</em>) – RA coordinate of centre of search region</p></li>
<li><p><strong>decDeg</strong> (<em>float</em>) – dec coordinate of centre of search region</p></li>
<li><p><strong>radiusSkyDeg</strong> (<em>float</em>) – radius in degrees on the sky used to define search
region</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[RAMin, RAMax, decMin, decMax] - coordinates in decimal degrees
defining search box</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCoords.convertCoords">
<code class="sig-prename descclassname">astLib.astCoords.</code><code class="sig-name descname">convertCoords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputSystem</span></em>, <em class="sig-param"><span class="n">outputSystem</span></em>, <em class="sig-param"><span class="n">coordX</span></em>, <em class="sig-param"><span class="n">coordY</span></em>, <em class="sig-param"><span class="n">epoch</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCoords.convertCoords" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts specified coordinates (given in decimal degrees) between J2000,
B1950, and Galactic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputSystem</strong> (<em>string</em>) – system of the input coordinates (either “J2000”,
“B1950” or “GALACTIC”)</p></li>
<li><p><strong>outputSystem</strong> (<em>string</em>) – system of the returned coordinates (either “J2000”,
“B1950” or “GALACTIC”)</p></li>
<li><p><strong>coordX</strong> (<em>float</em>) – longitude coordinate in decimal degrees, e.g. R. A.</p></li>
<li><p><strong>coordY</strong> (<em>float</em>) – latitude coordinate in decimal degrees, e.g. dec.</p></li>
<li><p><strong>epoch</strong> (<em>float</em>) – epoch of the input coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>coordinates in decimal degrees in requested output system</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCoords.decimal2dms">
<code class="sig-prename descclassname">astLib.astCoords.</code><code class="sig-name descname">decimal2dms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decDeg</span></em>, <em class="sig-param"><span class="n">delimiter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCoords.decimal2dms" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts decimal degrees to string in Degrees:Minutes:Seconds format
with user specified delimiter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decDeg</strong> (<em>float</em>) – coordinate in decimal degrees</p></li>
<li><p><strong>delimiter</strong> (<em>string</em>) – delimiter character in returned string</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>coordinate string in D:M:S format</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCoords.decimal2hms">
<code class="sig-prename descclassname">astLib.astCoords.</code><code class="sig-name descname">decimal2hms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">RADeg</span></em>, <em class="sig-param"><span class="n">delimiter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCoords.decimal2hms" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts decimal degrees to string in Hours:Minutes:Seconds format with
user specified delimiter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RADeg</strong> (<em>float</em>) – coordinate in decimal degrees</p></li>
<li><p><strong>delimiter</strong> (<em>string</em>) – delimiter character in returned string</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>coordinate string in H:M:S format</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCoords.dms2decimal">
<code class="sig-prename descclassname">astLib.astCoords.</code><code class="sig-name descname">dms2decimal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decString</span></em>, <em class="sig-param"><span class="n">delimiter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCoords.dms2decimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a delimited string of Degrees:Minutes:Seconds format into
decimal degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decString</strong> (<em>string</em>) – coordinate string in D:M:S format</p></li>
<li><p><strong>delimiter</strong> (<em>string</em>) – delimiter character in decString</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>coordinate in decimal degrees</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCoords.hms2decimal">
<code class="sig-prename descclassname">astLib.astCoords.</code><code class="sig-name descname">hms2decimal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">RAString</span></em>, <em class="sig-param"><span class="n">delimiter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCoords.hms2decimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a delimited string of Hours:Minutes:Seconds format into decimal
degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RAString</strong> (<em>string</em>) – coordinate string in H:M:S format</p></li>
<li><p><strong>delimiter</strong> (<em>string</em>) – delimiter character in RAString</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>coordinate in decimal degrees</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astCoords.shiftRADec">
<code class="sig-prename descclassname">astLib.astCoords.</code><code class="sig-name descname">shiftRADec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ra1</span></em>, <em class="sig-param"><span class="n">dec1</span></em>, <em class="sig-param"><span class="n">deltaRA</span></em>, <em class="sig-param"><span class="n">deltaDec</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astCoords.shiftRADec" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes new right ascension and declination shifted from the original
by some delta RA and delta DEC. Input position is decimal degrees. Shifts
(deltaRA, deltaDec) are arcseconds, and output is decimal degrees. Based on
an IDL routine of the same name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra1</strong> (<em>R.A. in decimal degrees</em>) – float</p></li>
<li><p><strong>dec1</strong> (<em>dec. in decimal degrees</em>) – float</p></li>
<li><p><strong>deltaRA</strong> (<em>shift in R.A. in arcseconds</em>) – float</p></li>
<li><p><strong>deltaDec</strong> (<em>shift in dec. in arcseconds</em>) – float</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float [newRA, newDec]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>shifted R.A. and dec.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-astLib.astImages">
<span id="astimages"></span><h2>astImages<a class="headerlink" href="#module-astLib.astImages" title="Permalink to this headline">¶</a></h2>
<p>Module for simple .fits image tasks (rotation, clipping out sections, making .pngs etc.).</p>
<ol class="loweralpha simple" start="3">
<li><p>2007-2018 Matt Hilton</p></li>
</ol>
<p>Some routines in this module will fail if, e.g., asked to clip a section from a .fits image at a
position not found within the image (as determined using the WCS). Where this occurs, the function
will return None. An error message will be printed to the console when this happens if
astImages.REPORT_ERRORS=True (the default). Testing if an astImages function returns None can be
used to handle errors in scripts.</p>
<dl class="py function">
<dt id="astLib.astImages.clipImageSectionPix">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">clipImageSectionPix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">XCoord</span></em>, <em class="sig-param"><span class="n">YCoord</span></em>, <em class="sig-param"><span class="n">clipSizePix</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.clipImageSectionPix" title="Permalink to this definition">¶</a></dt>
<dd><p>Clips a square or rectangular section from an image array at the given pixel coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>XCoord</strong> (<em>float</em>) – coordinate in pixels</p></li>
<li><p><strong>YCoord</strong> (<em>float</em>) – coordinate in pixels</p></li>
<li><p><strong>clipSizePix</strong> (<em>float</em><em> or </em><em>list in format</em><em> [</em><em>widthPix</em><em>, </em><em>heightPix</em><em>]</em>) – if float, size of square clipped section in pixels; if list,</p></li>
</ul>
</dd>
</dl>
<p>size of clipped section in pixels in x, y axes of output image respectively
:rtype: np array
:return: clipped image section</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.clipImageSectionWCS">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">clipImageSectionWCS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">imageWCS</span></em>, <em class="sig-param"><span class="n">RADeg</span></em>, <em class="sig-param"><span class="n">decDeg</span></em>, <em class="sig-param"><span class="n">clipSizeDeg</span></em>, <em class="sig-param"><span class="n">returnWCS</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.clipImageSectionWCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Clips a square or rectangular section from an image array at the given celestial coordinates.
An updated WCS for the clipped section is optionally returned, as well as the x, y pixel
coordinates in the original image corresponding to the clipped section.</p>
<p>Note that the clip size is specified in degrees on the sky. For projections that have varying
real pixel scale across the map (e.g. CEA), use <a class="reference internal" href="#astLib.astImages.clipUsingRADecCoords" title="astLib.astImages.clipUsingRADecCoords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clipUsingRADecCoords</span></code></a> instead.</p>
<p>Similarly, this routine will not work for a WCS that has polynomial distortion coefficients
in the header (e.g., CTYPE1 = ‘RA—TAN-SIP’ etc.) - again <a class="reference internal" href="#astLib.astImages.clipUsingRADecCoords" title="astLib.astImages.clipUsingRADecCoords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clipUsingRADecCoords</span></code></a> can be used
in such cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>imageWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object</p></li>
<li><p><strong>RADeg</strong> (<em>float</em>) – coordinate in decimal degrees</p></li>
<li><p><strong>decDeg</strong> (<em>float</em>) – coordinate in decimal degrees</p></li>
<li><p><strong>clipSizeDeg</strong> (<em>float</em><em> or </em><em>list in format</em><em> [</em><em>widthDeg</em><em>, </em><em>heightDeg</em><em>]</em>) – if float, size of square clipped section in decimal degrees; if list,</p></li>
</ul>
</dd>
</dl>
<p>size of clipped section in degrees in x, y axes of image respectively
:type returnWCS: bool
:param returnWCS: if True, return an updated WCS for the clipped section
:rtype: dictionary
:return: clipped image section (np array), updated astWCS WCS object for
clipped image section, and coordinates of clipped section in imageData in format
{‘data’, ‘wcs’, ‘clippedSection’}.</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.clipRotatedImageSectionWCS">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">clipRotatedImageSectionWCS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">imageWCS</span></em>, <em class="sig-param"><span class="n">RADeg</span></em>, <em class="sig-param"><span class="n">decDeg</span></em>, <em class="sig-param"><span class="n">clipSizeDeg</span></em>, <em class="sig-param"><span class="n">returnWCS</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.clipRotatedImageSectionWCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Clips a square or rectangular section from an image array at the given celestial coordinates.
The resulting clip is rotated and/or flipped such that North is at the top, and East appears at
the left. An updated WCS for the clipped section is also returned. Note that the alignment
of the rotated WCS is currently not perfect - however, it is probably good enough in most
cases for use with <code class="xref py py-obj docutils literal notranslate"><span class="pre">ImagePlot</span></code> for plotting purposes.</p>
<p>Note that the clip size is specified in degrees on the sky. For projections that have varying
real pixel scale across the map (e.g. CEA), use <a class="reference internal" href="#astLib.astImages.clipUsingRADecCoords" title="astLib.astImages.clipUsingRADecCoords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clipUsingRADecCoords</span></code></a> instead.</p>
<p>Similarly, this routine will not work for a WCS that has polynomial distortion coefficients
in the header (e.g., CTYPE1 = ‘RA—TAN-SIP’ etc.) - again <a class="reference internal" href="#astLib.astImages.clipUsingRADecCoords" title="astLib.astImages.clipUsingRADecCoords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clipUsingRADecCoords</span></code></a> can be used
in such cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>imageWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object</p></li>
<li><p><strong>RADeg</strong> (<em>float</em>) – coordinate in decimal degrees</p></li>
<li><p><strong>decDeg</strong> (<em>float</em>) – coordinate in decimal degrees</p></li>
<li><p><strong>clipSizeDeg</strong> (<em>float</em>) – if float, size of square clipped section in decimal degrees; if list,</p></li>
</ul>
</dd>
</dl>
<p>size of clipped section in degrees in RA, dec. axes of output rotated image respectively
:type returnWCS: bool
:param returnWCS: if True, return an updated WCS for the clipped section
:rtype: dictionary
:return: clipped image section (np array), updated astWCS WCS object for
clipped image section, in format {‘data’, ‘wcs’}.</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>Returns ‘None’ if the requested position is not found within the image. If the image</p>
</dd>
</dl>
<p>WCS does not have keywords of the form CD1_1 etc., the output WCS will not be rotated.</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.clipUsingRADecCoords">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">clipUsingRADecCoords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">imageWCS</span></em>, <em class="sig-param"><span class="n">RAMin</span></em>, <em class="sig-param"><span class="n">RAMax</span></em>, <em class="sig-param"><span class="n">decMin</span></em>, <em class="sig-param"><span class="n">decMax</span></em>, <em class="sig-param"><span class="n">returnWCS</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.clipUsingRADecCoords" title="Permalink to this definition">¶</a></dt>
<dd><p>Clips a section from an image array at the pixel coordinates corresponding to the given
celestial coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>imageWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object</p></li>
<li><p><strong>RAMin</strong> (<em>float</em>) – minimum RA coordinate in decimal degrees</p></li>
<li><p><strong>RAMax</strong> (<em>float</em>) – maximum RA coordinate in decimal degrees</p></li>
<li><p><strong>decMin</strong> (<em>float</em>) – minimum dec coordinate in decimal degrees</p></li>
<li><p><strong>decMax</strong> (<em>float</em>) – maximum dec coordinate in decimal degrees</p></li>
<li><p><strong>returnWCS</strong> (<em>bool</em>) – if True, return an updated WCS for the clipped section</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>clipped image section (np array), updated astWCS WCS object for</p>
</dd>
</dl>
<p>clipped image section, and corresponding pixel coordinates in imageData in format
{‘data’, ‘wcs’, ‘clippedSection’}.</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>Returns ‘None’ if the requested position is not found within the image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.generateContourOverlay">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">generateContourOverlay</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">backgroundImageData</span></em>, <em class="sig-param"><span class="n">backgroundImageWCS</span></em>, <em class="sig-param"><span class="n">contourImageData</span></em>, <em class="sig-param"><span class="n">contourImageWCS</span></em>, <em class="sig-param"><span class="n">contourLevels</span></em>, <em class="sig-param"><span class="n">contourSmoothFactor</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">highAccuracy</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.generateContourOverlay" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescales an image array to be used as a contour overlay to have the same dimensions as the
background image, and generates a set of contour levels. The image array from which the contours
are to be generated will be resampled to the same dimensions as the background image data, and
can be optionally smoothed using a Gaussian filter. The sigma of the Gaussian filter
(contourSmoothFactor) is specified in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backgroundImageData</strong> (<em>np array</em>) – background image data array</p></li>
<li><p><strong>backgroundImageWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object of the background image data array</p></li>
<li><p><strong>contourImageData</strong> (<em>np array</em>) – image data array from which contours are to be generated</p></li>
<li><p><strong>contourImageWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object corresponding to contourImageData</p></li>
<li><p><strong>contourLevels</strong> (<em>list</em>) – sets the contour levels - available options:
- values: contourLevels=[list of values specifying each level]
- linear spacing: contourLevels=[‘linear’, min level value, max level value, number
of levels] - can use “min”, “max” to automatically set min, max levels from image data
- log spacing: contourLevels=[‘log’, min level value, max level value, number of
levels] - can use “min”, “max” to automatically set min, max levels from image data</p></li>
<li><p><strong>contourSmoothFactor</strong> (<em>float</em>) – standard deviation (in arcsec) of Gaussian filter for</p></li>
</ul>
</dd>
</dl>
<p>pre-smoothing of contour image data (set to 0 for no smoothing)
:type highAccuracy: bool
:param highAccuracy: if True, sample every corresponding pixel in each image; otherwise, sample</p>
<blockquote>
<div><p>every nth pixel, where n = the ratio of the image scales.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.histEq">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">histEq</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputArray</span></em>, <em class="sig-param"><span class="n">numBins</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.histEq" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs histogram equalisation of the input np array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputArray</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>numBins</strong> (<em>int</em>) – number of bins in which to perform the operation (e.g. 1024)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np array</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>image data array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.intensityCutImage">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">intensityCutImage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">cutLevels</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.intensityCutImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a matplotlib.pylab plot of an image array with the specified cuts in intensity
applied. This routine is used by <a class="reference internal" href="#astLib.astImages.saveBitmap" title="astLib.astImages.saveBitmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saveBitmap</span></code></a> and <a class="reference internal" href="#astLib.astImages.saveContourOverlayBitmap" title="astLib.astImages.saveContourOverlayBitmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saveContourOverlayBitmap</span></code></a>, which both
produce output as .png, .jpg, etc. images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>cutLevels</strong> (<em>list</em>) – sets the image scaling - available options:
- pixel values: cutLevels=[low value, high value].
- histogram equalisation: cutLevels=[“histEq”, number of bins ( e.g. 1024)]
- relative: cutLevels=[“relative”, cut per cent level (e.g. 99.5)]
- smart: cutLevels=[“smart”, cut per cent level (e.g. 99.5)]</p></li>
</ul>
</dd>
</dl>
<p>[“smart”, 99.5] seems to provide good scaling over a range of different images.
:rtype: dictionary
:return: image section (np.array), matplotlib image normalisation (matplotlib.colors.Normalize), in the format {‘image’, ‘norm’}.</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>If cutLevels[0] == “histEq”, then only {‘image’} is returned.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.normalise">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">normalise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputArray</span></em>, <em class="sig-param"><span class="n">clipMinMax</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.normalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Clips the inputArray in intensity and normalises the array such that minimum and maximum
values are 0, 1. Clip in intensity is specified by clipMinMax, a list in the format
[clipMin, clipMax]</p>
<p>Used for normalising image arrays so that they can be turned into RGB arrays that matplotlib
can plot (see <code class="xref py py-obj docutils literal notranslate"><span class="pre">astPlots.ImagePlot</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputArray</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>clipMinMax</strong> (<em>list</em>) – [minimum value of clipped array, maximum value of clipped array]</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np array</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>normalised array with minimum value 0, maximum value 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.resampleToTanProjection">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">resampleToTanProjection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">imageWCS</span></em>, <em class="sig-param"><span class="n">outputPixDimensions</span><span class="o">=</span><span class="default_value">[600, 600]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.resampleToTanProjection" title="Permalink to this definition">¶</a></dt>
<dd><p>Resamples an image and WCS to a tangent plane projection. Purely for plotting purposes
(e.g., ensuring RA, dec. coordinate axes perpendicular).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>imageWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object</p></li>
<li><p><strong>outputPixDimensions</strong> (<em>list</em>) – [width, height] of output image in pixels</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>image data (np array), updated astWCS WCS object for image, in format {‘data’, ‘wcs’}.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.resampleToWCS">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">resampleToWCS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im1Data</span></em>, <em class="sig-param"><span class="n">im1WCS</span></em>, <em class="sig-param"><span class="n">im2Data</span></em>, <em class="sig-param"><span class="n">im2WCS</span></em>, <em class="sig-param"><span class="n">highAccuracy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">onlyOverlapping</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.resampleToWCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Resamples data corresponding to second image (with data im2Data, WCS im2WCS) onto the WCS
of the first image (im1Data, im1WCS). The output, resampled image is of the pixel same
dimensions of the first image. This routine is for assisting in plotting - performing
photometry on the output is not recommended.</p>
<p>Set highAccuracy == True to sample every corresponding pixel in each image; otherwise only
every nth pixel (where n is the ratio of the image scales) will be sampled, with values
in between being set using a linear interpolation (much faster).</p>
<p>Set onlyOverlapping == True to speed up resampling by only resampling the overlapping
area defined by both image WCSs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im1Data</strong> (<em>np array</em>) – image data array for first image</p></li>
<li><p><strong>im1WCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object corresponding to im1Data</p></li>
<li><p><strong>im2Data</strong> (<em>np array</em>) – image data array for second image (to be resampled to match first image)</p></li>
<li><p><strong>im2WCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object corresponding to im2Data</p></li>
<li><p><strong>highAccuracy</strong> (<em>bool</em>) – if True, sample every corresponding pixel in each image; otherwise, sample
every nth pixel, where n = the ratio of the image scales.</p></li>
<li><p><strong>onlyOverlapping</strong> (<em>bool</em>) – if True, only consider the overlapping area defined by both image WCSs
(speeds things up)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>np image data array and associated WCS in format {‘data’, ‘wcs’}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.saveBitmap">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">saveBitmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputFileName</span></em>, <em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">cutLevels</span></em>, <em class="sig-param"><span class="n">size</span></em>, <em class="sig-param"><span class="n">colorMapName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.saveBitmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a bitmap image from an image array; the image format is specified by the
filename extension. (e.g. “.jpg” =JPEG, “.png”=PNG).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputFileName</strong> (<em>string</em>) – filename of output bitmap image</p></li>
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>cutLevels</strong> (<em>list</em>) – sets the image scaling - available options:
- pixel values: cutLevels=[low value, high value].
- histogram equalisation: cutLevels=[“histEq”, number of bins ( e.g. 1024)]
- relative: cutLevels=[“relative”, cut per cent level (e.g. 99.5)]
- smart: cutLevels=[“smart”, cut per cent level (e.g. 99.5)]</p></li>
</ul>
</dd>
</dl>
<p>[“smart”, 99.5] seems to provide good scaling over a range of different images.
:type size: int
:param size: size of output image in pixels
:type colorMapName: string
:param colorMapName: name of a standard matplotlib colormap, e.g. “hot”, “cool”, “gray”
etc. (do “help(pylab.colormaps)” in the Python interpreter to see available options)</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.saveContourOverlayBitmap">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">saveContourOverlayBitmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputFileName</span></em>, <em class="sig-param"><span class="n">backgroundImageData</span></em>, <em class="sig-param"><span class="n">backgroundImageWCS</span></em>, <em class="sig-param"><span class="n">cutLevels</span></em>, <em class="sig-param"><span class="n">size</span></em>, <em class="sig-param"><span class="n">colorMapName</span></em>, <em class="sig-param"><span class="n">contourImageData</span></em>, <em class="sig-param"><span class="n">contourImageWCS</span></em>, <em class="sig-param"><span class="n">contourSmoothFactor</span></em>, <em class="sig-param"><span class="n">contourLevels</span></em>, <em class="sig-param"><span class="n">contourColor</span></em>, <em class="sig-param"><span class="n">contourWidth</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.saveContourOverlayBitmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a bitmap image from an image array, with a set of contours generated from a
second image array overlaid. The image format is specified by the file extension
(e.g. “.jpg”=JPEG, “.png”=PNG). The image array from which the contours are to be generated
can optionally be pre-smoothed using a Gaussian filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputFileName</strong> (<em>string</em>) – filename of output bitmap image</p></li>
<li><p><strong>backgroundImageData</strong> (<em>np array</em>) – background image data array</p></li>
<li><p><strong>backgroundImageWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object of the background image data array</p></li>
<li><p><strong>cutLevels</strong> (<em>list</em>) – sets the image scaling - available options:
- pixel values: cutLevels=[low value, high value].
- histogram equalisation: cutLevels=[“histEq”, number of bins ( e.g. 1024)]
- relative: cutLevels=[“relative”, cut per cent level (e.g. 99.5)]
- smart: cutLevels=[“smart”, cut per cent level (e.g. 99.5)]</p></li>
</ul>
</dd>
</dl>
<p>[“smart”, 99.5] seems to provide good scaling over a range of different images.
:type size: int
:param size: size of output image in pixels
:type colorMapName: string
:param colorMapName: name of a standard matplotlib colormap, e.g. “hot”, “cool”, “gray”
etc. (do “help(pylab.colormaps)” in the Python interpreter to see available options)
:type contourImageData: np array
:param contourImageData: image data array from which contours are to be generated
:type contourImageWCS: astWCS.WCS
:param contourImageWCS: astWCS.WCS object corresponding to contourImageData
:type contourSmoothFactor: float
:param contourSmoothFactor: standard deviation (in pixels) of Gaussian filter for
pre-smoothing of contour image data (set to 0 for no smoothing)
:type contourLevels: list
:param contourLevels: sets the contour levels - available options:</p>
<blockquote>
<div><ul class="simple">
<li><p>values: contourLevels=[list of values specifying each level]</p></li>
<li><p>linear spacing: contourLevels=[‘linear’, min level value, max level value, number</p></li>
</ul>
<p>of levels] - can use “min”, “max” to automatically set min, max levels from image data
- log spacing: contourLevels=[‘log’, min level value, max level value, number of
levels] - can use “min”, “max” to automatically set min, max levels from image data</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contourColor</strong> (<em>string</em>) – color of the overlaid contours, specified by the name of a standard</p>
</dd>
</dl>
<p>matplotlib color, e.g., “black”, “white”, “cyan”
etc. (do “help(pylab.colors)” in the Python interpreter to see available options)
:type contourWidth: int
:param contourWidth: width of the overlaid contours</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.saveFITS">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">saveFITS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputFileName</span></em>, <em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">imageWCS</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.saveFITS" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes an image array to a new .fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputFileName</strong> (<em>string</em>) – filename of output FITS image</p></li>
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>imageWCS</strong> (<em>astWCS.WCS object</em>) – image WCS object</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>If imageWCS=None, the FITS image will be written with a rudimentary header containing</p>
</dd>
</dl>
<p>no meta data.</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astImages.scaleImage">
<code class="sig-prename descclassname">astLib.astImages.</code><code class="sig-name descname">scaleImage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">imageWCS</span></em>, <em class="sig-param"><span class="n">scaleFactor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astImages.scaleImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Scales image array and WCS by the given scale factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageData</strong> (<em>np array</em>) – image data array</p></li>
<li><p><strong>imageWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object</p></li>
<li><p><strong>scaleFactor</strong> (<em>float</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – factor to resize image by - if tuple or list, in format
[x scale factor, y scale factor]</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>image data (np array), updated astWCS WCS object for image, in format {‘data’, ‘wcs’}.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-astLib.astPlots">
<span id="astplots"></span><h2>astPlots<a class="headerlink" href="#module-astLib.astPlots" title="Permalink to this headline">¶</a></h2>
<p>Module for producing astronomical plots.</p>
<ol class="loweralpha simple" start="3">
<li><p>2007-2018 Matt Hilton</p></li>
</ol>
<p>This module provides the matplotlib powered ImagePlot class, which is designed to be flexible.
ImagePlots can have RA, Dec. coordinate axes, contour overlays, and have objects marked in them,
using WCS coordinates. RGB plots are supported too.</p>
<dl class="py data">
<dt id="astLib.astPlots.DECIMAL_TICK_STEPS">
<code class="sig-prename descclassname">astLib.astPlots.</code><code class="sig-name descname">DECIMAL_TICK_STEPS</code><em class="property"> = [0.001, 0.0025, 0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1.0, 2.0, 2.5, 5.0, 10.0, 30.0, 90.0]</em><a class="headerlink" href="#astLib.astPlots.DECIMAL_TICK_STEPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the possible coordinate label steps on both coordinate axes in decimal degrees mode.</p>
</dd></dl>

<dl class="py data">
<dt id="astLib.astPlots.DEC_TICK_STEPS">
<code class="sig-prename descclassname">astLib.astPlots.</code><code class="sig-name descname">DEC_TICK_STEPS</code><em class="property"> = [{'deg': 0.0002777777777777778, 'unit': 's'}, {'deg': 0.0005555555555555556, 'unit': 's'}, {'deg': 0.0013888888888888887, 'unit': 's'}, {'deg': 0.0027777777777777775, 'unit': 's'}, {'deg': 0.008333333333333333, 'unit': 's'}, {'deg': 0.016666666666666666, 'unit': 'm'}, {'deg': 0.03333333333333333, 'unit': 'm'}, {'deg': 0.08333333333333333, 'unit': 'm'}, {'deg': 0.25, 'unit': 'm'}, {'deg': 0.5, 'unit': 'm'}, {'deg': 1.0, 'unit': 'd'}, {'deg': 2.0, 'unit': 'd'}, {'deg': 4.0, 'unit': 'd'}, {'deg': 5.0, 'unit': 'd'}, {'deg': 10.0, 'unit': 'd'}, {'deg': 20.0, 'unit': 'd'}, {'deg': 30.0, 'unit': 'd'}]</em><a class="headerlink" href="#astLib.astPlots.DEC_TICK_STEPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the possible coordinate label steps on the delination axis in
sexagesimal mode. Dictionary format: {‘deg’, ‘unit’}</p>
</dd></dl>

<dl class="py class">
<dt id="astLib.astPlots.ImagePlot">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astPlots.</code><code class="sig-name descname">ImagePlot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageData</span></em>, <em class="sig-param"><span class="n">imageWCS</span></em>, <em class="sig-param"><span class="n">axes</span><span class="o">=</span><span class="default_value">[0.1, 0.1, 0.8, 0.8]</span></em>, <em class="sig-param"><span class="n">cutLevels</span><span class="o">=</span><span class="default_value">['smart', 99.5]</span></em>, <em class="sig-param"><span class="n">colorMapName</span><span class="o">=</span><span class="default_value">'gray'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">axesLabels</span><span class="o">=</span><span class="default_value">'sexagesimal'</span></em>, <em class="sig-param"><span class="n">axesFontFamily</span><span class="o">=</span><span class="default_value">'serif'</span></em>, <em class="sig-param"><span class="n">axesFontSize</span><span class="o">=</span><span class="default_value">12.0</span></em>, <em class="sig-param"><span class="n">RATickSteps</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em class="sig-param"><span class="n">decTickSteps</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em class="sig-param"><span class="n">colorBar</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">interpolation</span><span class="o">=</span><span class="default_value">'bilinear'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot" title="Permalink to this definition">¶</a></dt>
<dd><p>This class describes a matplotlib image plot containing an astronomical image with an
associated WCS.</p>
<p>Objects within the image boundaries can be marked by passing their WCS coordinates to
<a class="reference internal" href="#astLib.astPlots.ImagePlot.addPlotObjects" title="astLib.astPlots.ImagePlot.addPlotObjects"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImagePlot.addPlotObjects</span></code></a>.</p>
<p>Other images can be overlaid using <a class="reference internal" href="#astLib.astPlots.ImagePlot.addContourOverlay" title="astLib.astPlots.ImagePlot.addContourOverlay"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImagePlot.addContourOverlay</span></code></a>.</p>
<p>For images rotated with North at the top, East at the left (as can be done using
<code class="xref py py-obj docutils literal notranslate"><span class="pre">astImages.clipRotatedImageSectionWCS</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">astImages.resampleToTanProjection</span></code>, WCS coordinate
axes can be plotted, with tick marks set appropriately for the image size. Otherwise, a compass
can be plotted showing the directions of North and East in the image.</p>
<p>RGB images are also supported.</p>
<p>The plot can of course be tweaked further after creation using matplotlib/pylab commands.</p>
<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.addCompass">
<code class="sig-name descname">addCompass</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">location</span></em>, <em class="sig-param"><span class="n">sizeArcSec</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'white'</span></em>, <em class="sig-param"><span class="n">fontSize</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">20.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.addCompass" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a compass to the ImagePlot at the given location (‘N’, ‘NE’, ‘E’, ‘SE’, ‘S’,
‘SW’, ‘W’, or ‘NW’). Note these aren’t directions on the WCS coordinate grid, they are
relative positions on the plot - so N is top centre, NE is top right, SW is bottom right etc..
Alternatively, pixel coordinates (x, y) in the image can be given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>location</strong> (<em>string</em><em> or </em><em>tuple</em>) – location in the plot where the compass is drawn:
- string: N, NE, E, SE, S, SW, W or NW
- tuple: (x, y)</p></li>
<li><p><strong>sizeArcSec</strong> (<em>float</em>) – length of the compass arrows on the plot in arc seconds</p></li>
<li><p><strong>color</strong> (<em>string</em>) – any valid matplotlib color string</p></li>
<li><p><strong>fontSize</strong> (<em>float</em>) – size of font used to label N and E, in points</p></li>
<li><p><strong>width</strong> (<em>float</em>) – width of arrows used to mark compass</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.addContourOverlay">
<code class="sig-name descname">addContourOverlay</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contourImageData</span></em>, <em class="sig-param"><span class="n">contourWCS</span></em>, <em class="sig-param"><span class="n">tag</span></em>, <em class="sig-param"><span class="n">levels</span><span class="o">=</span><span class="default_value">['linear', 'min', 'max', 5]</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'white'</span></em>, <em class="sig-param"><span class="n">smooth</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">highAccuracy</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.addContourOverlay" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds image data to the ImagePlot as a contour overlay. The contours can be removed using
<a class="reference internal" href="#astLib.astPlots.ImagePlot.removeContourOverlay" title="astLib.astPlots.ImagePlot.removeContourOverlay"><code class="xref py py-obj docutils literal notranslate"><span class="pre">removeContourOverlay</span></code></a>. If a contour overlay already exists with this tag, it will be replaced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contourImageData</strong> (<em>numpy array</em>) – image data array from which contours are to be generated</p></li>
<li><p><strong>contourWCS</strong> (<a class="reference internal" href="#astLib.astWCS.WCS" title="astLib.astWCS.WCS"><em>astWCS.WCS</em></a>) – astWCS.WCS object for the image to be contoured</p></li>
<li><p><strong>tag</strong> (<em>string</em>) – identifying tag for this set of contours</p></li>
<li><p><strong>levels</strong> (<em>list</em>) – sets the contour levels - available options:
- values: contourLevels=[list of values specifying each level]
- linear spacing: contourLevels=[‘linear’, min level value, max level value, number
of levels] - can use “min”, “max” to automatically set min, max levels from image data
- log spacing: contourLevels=[‘log’, min level value, max level value, number of
levels] - can use “min”, “max” to automatically set min, max levels from image data</p></li>
<li><p><strong>width</strong> (<em>int</em>) – width of the overlaid contours</p></li>
<li><p><strong>color</strong> (<em>string</em>) – color of the overlaid contours, specified by the name of a standard
matplotlib color, e.g., “black”, “white”, “cyan”
etc. (do “help(pylab.colors)” in the Python interpreter to see available options)</p></li>
<li><p><strong>smooth</strong> (<em>float</em>) – standard deviation (in arcsec) of Gaussian filter for
pre-smoothing of contour image data (set to 0 for no smoothing)</p></li>
<li><p><strong>highAccuracy</strong> (<em>bool</em>) – if True, sample every corresponding pixel in each image; otherwise, sample
every nth pixel, where n = the ratio of the image scales.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.addPlotObjects">
<code class="sig-name descname">addPlotObjects</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">objRAs</span></em>, <em class="sig-param"><span class="n">objDecs</span></em>, <em class="sig-param"><span class="n">tag</span></em>, <em class="sig-param"><span class="n">symbol</span><span class="o">=</span><span class="default_value">'circle'</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">4.0</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'yellow'</span></em>, <em class="sig-param"><span class="n">objLabels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">objLabelSize</span><span class="o">=</span><span class="default_value">12.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.addPlotObjects" title="Permalink to this definition">¶</a></dt>
<dd><p>Add objects with RA, dec coords objRAs, objDecs to the ImagePlot. Only objects that fall within
the image boundaries will be plotted.</p>
<p>symbol specifies the type of symbol with which to mark the object in the image. The following
values are allowed:</p>
<blockquote>
<div><ul class="simple">
<li><p>“circle”</p></li>
<li><p>“box”</p></li>
<li><p>“cross”</p></li>
<li><p>“diamond”</p></li>
</ul>
</div></blockquote>
<p>size specifies the diameter in arcsec of the symbol (if plotSymbol == “circle”), or the width
of the box in arcsec (if plotSymbol == “box”)</p>
<p>width specifies the thickness of the symbol lines in pixels</p>
<p>color can be any valid matplotlib color (e.g. “red”, “green”, etc.)</p>
<p>The objects can be removed from the plot by using removePlotObjects(), and then calling
draw(). If the ImagePlot already has a set of plotObjects with the same tag, they will be
replaced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objRAs</strong> (<em>numpy array</em><em> or </em><em>list</em>) – object RA coords in decimal degrees</p></li>
<li><p><strong>objDecs</strong> (<em>numpy array</em><em> or </em><em>list</em>) – corresponding object Dec. coords in decimal degrees</p></li>
<li><p><strong>tag</strong> (<em>string</em>) – identifying tag for this set of objects</p></li>
<li><p><strong>symbol</strong> (<em>string</em>) – either “circle”, “box”, “cross”, or “diamond”</p></li>
<li><p><strong>size</strong> (<em>float</em>) – size of symbols to plot (radius in arcsec, or width of box)</p></li>
<li><p><strong>width</strong> (<em>float</em>) – width of symbols in pixels</p></li>
<li><p><strong>color</strong> (<em>string</em>) – any valid matplotlib color string, e.g. “red”, “green” etc.</p></li>
<li><p><strong>objLabels</strong> (<em>list</em>) – text labels to plot next to objects in figure</p></li>
<li><p><strong>objLabelSize</strong> (<em>float</em>) – size of font used for object labels (in points)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.addScaleBar">
<code class="sig-name descname">addScaleBar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">location</span></em>, <em class="sig-param"><span class="n">sizeArcSec</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'white'</span></em>, <em class="sig-param"><span class="n">fontSize</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">20.0</span></em>, <em class="sig-param"><span class="n">label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">style</span><span class="o">=</span><span class="default_value">'whiskers'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.addScaleBar" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a scale bar to the ImagePlot at the given location (‘N’, ‘NE’, ‘E’, ‘SE’, ‘S’,
‘SW’, ‘W’, or ‘NW’). Note these aren’t directions on the WCS coordinate grid, they are
relative positions on the plot - so N is top centre, NE is top right, SW is bottom right etc..
Alternatively, pixel coordinates (x, y) in the image can be given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>location</strong> (<em>string</em><em> or </em><em>tuple</em>) – location in the plot where the compass is drawn:
- string: N, NE, E, SE, S, SW, W or NW
- tuple: (x, y)</p></li>
<li><p><strong>sizeArcSec</strong> (<em>float</em>) – scale length to indicate on the plot in arc seconds</p></li>
<li><p><strong>color</strong> (<em>string</em>) – any valid matplotlib color string</p></li>
<li><p><strong>fontSize</strong> (<em>float</em>) – size of font used to label N and E, in points</p></li>
<li><p><strong>width</strong> (<em>float</em>) – width of arrow used to mark scale</p></li>
<li><p><strong>label</strong> (<em>string</em>) – overrides the displayed label if not None (if None, label is the angular size)</p></li>
<li><p><strong>style</strong> (<em>string</em>) – either “whiskers” or “arrows”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.calcWCSAxisLabels">
<code class="sig-name descname">calcWCSAxisLabels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">axesLabels</span><span class="o">=</span><span class="default_value">'decimal'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.calcWCSAxisLabels" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculates the positions of coordinate labels for the RA and Dec axes of the
ImagePlot. The tick steps are calculated automatically unless self.RATickSteps,
self.decTickSteps are set to values other than “auto” (see <code class="xref py py-obj docutils literal notranslate"><span class="pre">ImagePlot.__init__</span></code>).</p>
<p>The ImagePlot must be redrawn for changes to be applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>axesLabels</strong> (<em>string</em>) – either “sexagesimal” (for H:M:S, D:M:S), “decimal” (for decimal degrees),</p>
</dd>
</dl>
<p>or None for no coordinate axes labels</p>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Redraws the ImagePlot.</p>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.getTickSteps">
<code class="sig-name descname">getTickSteps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.getTickSteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Chooses the appropriate WCS coordinate tick steps for the plot based on its size.
Whether the ticks are decimal or sexagesimal is set by self.axesLabels.</p>
<p>Note: minor ticks not used at the moment.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tick step sizes for major, minor plot ticks, in format {‘major’, ‘minor’}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.removeContourOverlay">
<code class="sig-name descname">removeContourOverlay</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tag</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.removeContourOverlay" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the contourOverlay from the ImagePlot corresponding to the tag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tag</strong> (<em>string</em>) – tag for contour overlay in ImagePlot.contourOverlays to be removed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.removePlotObjects">
<code class="sig-name descname">removePlotObjects</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tag</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.removePlotObjects" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the plotObjects from the ImagePlot corresponding to the tag. The plot must be redrawn
for the change to take effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tag</strong> (<em>string</em>) – tag for set of objects in ImagePlot.plotObjects to be removed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astPlots.ImagePlot.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astPlots.ImagePlot.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the ImagePlot in any format that matplotlib can understand, as determined from the
fileName extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fileName</strong> (<em>string</em>) – path where plot will be written</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt id="astLib.astPlots.RA_TICK_STEPS">
<code class="sig-prename descclassname">astLib.astPlots.</code><code class="sig-name descname">RA_TICK_STEPS</code><em class="property"> = [{'deg': 0.0020833333333333333, 'unit': 's'}, {'deg': 0.004166666666666667, 'unit': 's'}, {'deg': 0.008333333333333333, 'unit': 's'}, {'deg': 0.016666666666666666, 'unit': 's'}, {'deg': 0.020833333333333332, 'unit': 's'}, {'deg': 0.041666666666666664, 'unit': 's'}, {'deg': 0.08333333333333333, 'unit': 's'}, {'deg': 0.125, 'unit': 's'}, {'deg': 0.25, 'unit': 'm'}, {'deg': 0.5, 'unit': 'm'}, {'deg': 1.25, 'unit': 'm'}, {'deg': 2.5, 'unit': 'm'}, {'deg': 5.0, 'unit': 'm'}, {'deg': 7.5, 'unit': 'm'}, {'deg': 15.0, 'unit': 'h'}, {'deg': 45.0, 'unit': 'h'}, {'deg': 90.0, 'unit': 'h'}, {'deg': 180.0, 'unit': 'h'}]</em><a class="headerlink" href="#astLib.astPlots.RA_TICK_STEPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the possible coordinate label steps on the right ascension axis in
sexagesimal mode. Dictionary format: {‘deg’, ‘unit’}</p>
</dd></dl>

</div>
<div class="section" id="module-astLib.astWCS">
<span id="astwcs"></span><h2>astWCS<a class="headerlink" href="#module-astLib.astWCS" title="Permalink to this headline">¶</a></h2>
<p>Module for handling World Coordinate Systems (WCS).</p>
<ol class="loweralpha simple" start="3">
<li><p>2007-2012 Matt Hilton</p></li>
</ol>
<ol class="loweralpha simple" start="3">
<li><p>2013-2020 Matt Hilton &amp; Steven Boada</p></li>
</ol>
<p>This is a higher level interface to some of the routines in PyWCSTools
(distributed with astLib).
PyWCSTools is a simple SWIG wrapping of WCSTools by Jessica Mink
(<a class="reference external" href="http://tdc-www.harvard.edu/software/wcstools/">http://tdc-www.harvard.edu/software/wcstools/</a>). It is intended is to make
this interface complete enough such that direct use of PyWCSTools is
unnecessary.</p>
<dl class="py data">
<dt id="astLib.astWCS.NUMPY_MODE">
<code class="sig-prename descclassname">astLib.astWCS.</code><code class="sig-name descname">NUMPY_MODE</code><em class="property"> = True</em><a class="headerlink" href="#astLib.astWCS.NUMPY_MODE" title="Permalink to this definition">¶</a></dt>
<dd><p>If True (default), pixel coordinates accepted/returned by routines such as
<code class="xref py py-obj docutils literal notranslate"><span class="pre">astWCS.WCS.pix2wcs</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">astWCS.WCS.wcs2pix</span></code> have (0, 0) as the origin. Set
to False to make these routines accept/return pixel coords with (1, 1) as the
origin (i.e. to match the FITS convention, default behaviour prior to astLib
version 0.3.0).</p>
</dd></dl>

<dl class="py class">
<dt id="astLib.astWCS.WCS">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astWCS.</code><code class="sig-name descname">WCS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">headerSource</span></em>, <em class="sig-param"><span class="n">extensionName</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'image'</span></em>, <em class="sig-param"><span class="n">zapKeywords</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">useAstropyWCS</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS" title="Permalink to this definition">¶</a></dt>
<dd><p>This class provides methods for accessing information from the World
Coordinate System (WCS) contained in the header of a FITS image.
Conversions between pixel and WCS coordinates can also be performed.</p>
<p>To create a WCS object from a FITS file called “test.fits”, simply:</p>
<p>WCS=astWCS.WCS(“test.fits”)</p>
<p>Likewise, to create a WCS object from the pyfits.header of “test.fits”:</p>
<p>img=pyfits.open(“test.fits”)
header=img[0].header
WCS=astWCS.WCS(header, mode = “pyfits”)</p>
<dl class="py method">
<dt id="astLib.astWCS.WCS.coordsAreInImage">
<code class="sig-name descname">coordsAreInImage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">RADeg</span></em>, <em class="sig-param"><span class="n">decDeg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.coordsAreInImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the given RA, dec coordinate is within the image
boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if coordinate within image, False if not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies the WCS object to a new object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astWCS.WCS object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>WCS object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getCentreWCSCoords">
<code class="sig-name descname">getCentreWCSCoords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getCentreWCSCoords" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the RA and dec coordinates (in decimal degrees) at the
centre of the WCS.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coordinates in decimal degrees in format [RADeg, decDeg]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getEpoch">
<code class="sig-name descname">getEpoch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getEpoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the epoch of the WCS.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>epoch of the WCS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getEquinox">
<code class="sig-name descname">getEquinox</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getEquinox" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the equinox of the WCS.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>equinox of the WCS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getFullSizeSkyDeg">
<code class="sig-name descname">getFullSizeSkyDeg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getFullSizeSkyDeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the width, height of the image according to the WCS in
decimal degrees on the sky (i.e., with the projection taken into
account).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>width and height of image in decimal degrees on the sky in
format [width, height]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getHalfSizeDeg">
<code class="sig-name descname">getHalfSizeDeg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getHalfSizeDeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the half-width, half-height of the image according to the
WCS in RA and dec degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>half-width and half-height of image in R.A., dec. decimal
degrees in format [half-width, half-height]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getImageMinMaxWCSCoords">
<code class="sig-name descname">getImageMinMaxWCSCoords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getImageMinMaxWCSCoords" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum, maximum WCS coords defined by the size of the
parent image (as defined by the NAXIS keywords in the image header).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[minimum R.A., maximum R.A., minimum Dec., maximum Dec.]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getPixelSizeDeg">
<code class="sig-name descname">getPixelSizeDeg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getPixelSizeDeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pixel scale of the WCS. This is the average of the x, y
pixel scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pixel size in decimal degrees</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getRotationDeg">
<code class="sig-name descname">getRotationDeg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getRotationDeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the rotation angle in degrees around the axis, North through
East.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rotation angle in degrees</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getXPixelSizeDeg">
<code class="sig-name descname">getXPixelSizeDeg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getXPixelSizeDeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pixel scale along the x-axis of the WCS in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pixel size in decimal degrees</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.getYPixelSizeDeg">
<code class="sig-name descname">getYPixelSizeDeg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.getYPixelSizeDeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pixel scale along the y-axis of the WCS in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pixel size in decimal degrees</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.isFlipped">
<code class="sig-name descname">isFlipped</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.isFlipped" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns 1 if image is reflected around axis, otherwise returns 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1 if image is flipped, 0 otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.pix2wcs">
<code class="sig-name descname">pix2wcs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.pix2wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the WCS coordinates corresponding to the input pixel
coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>WCS coordinates in format [RADeg, decDeg]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.updateFromHeader">
<code class="sig-name descname">updateFromHeader</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.updateFromHeader" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the WCS object using information from WCS.header. This
routine should be called whenever changes are made to WCS keywords in
WCS.header.</p>
</dd></dl>

<dl class="py method">
<dt id="astLib.astWCS.WCS.wcs2pix">
<code class="sig-name descname">wcs2pix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">RADeg</span></em>, <em class="sig-param"><span class="n">decDeg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.WCS.wcs2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pixel coordinates corresponding to the input WCS
coordinates (given in decimal degrees). RADeg, decDeg can be single
floats, or lists or np arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pixel coordinates in format [x, y]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="astLib.astWCS.findWCSOverlap">
<code class="sig-prename descclassname">astLib.astWCS.</code><code class="sig-name descname">findWCSOverlap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wcs1</span></em>, <em class="sig-param"><span class="n">wcs2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astWCS.findWCSOverlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the minimum, maximum WCS coords that overlap between wcs1 and
wcs2. Returns these coordinates, plus the corresponding pixel coordinates
for each wcs. Useful for clipping overlapping region between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary with keys ‘overlapWCS’ (min, max RA, dec of overlap
between wcs1, wcs2) ‘wcs1Pix’, ‘wcs2Pix’ (pixel coords in each input
WCS that correspond to ‘overlapWCS’ coords)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-astLib.astSED">
<span id="astsed"></span><h2>astSED<a class="headerlink" href="#module-astLib.astSED" title="Permalink to this headline">¶</a></h2>
<p>Module for performing calculations on Spectral Energy Distributions (SEDs).</p>
<ol class="loweralpha simple" start="3">
<li><p>2007-2013 Matt Hilton</p></li>
</ol>
<p>This module provides classes for manipulating SEDs, in particular the Bruzual &amp; Charlot 2003, Maraston
2005, and Percival et al 2009 stellar population synthesis models are currently supported. Functions are
provided for calculating the evolution of colours and magnitudes in these models with redshift etc., and
for fitting broadband photometry using these models.</p>
<dl class="py data">
<dt id="astLib.astSED.AB">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">AB</code><em class="property"> = &lt;astLib.astSED.SED object&gt;</em><a class="headerlink" href="#astLib.astSED.AB" title="Permalink to this definition">¶</a></dt>
<dd><p>Flat spectrum SED, used for calculation of magnitudes on the AB system (<a class="reference internal" href="#astLib.astSED.SED" title="astLib.astSED.SED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SED</span></code></a> object).</p>
</dd></dl>

<dl class="py class">
<dt id="astLib.astSED.BC03Model">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">BC03Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.BC03Model" title="Permalink to this definition">¶</a></dt>
<dd><p>This class describes a Bruzual &amp; Charlot 2003 stellar population model, extracted from a GALAXEV .ised
file using the galaxevpl program that is included in GALAXEV. The file format is white space delimited,
with wavelength in the first column. Subsequent columns contain the model fluxes for SEDs of different
ages, as specified when running galaxevpl. The age corresponding to each flux column is taken from the
comment line beginning “# Age (yr)”, and is converted to Gyr.</p>
<p>For example, to load a tau = 0.1 Gyr burst of star formation,  solar metallicity, Salpeter IMF model
stored in a file (created by galaxevpl) called “csp_lr_solar_0p1Gyr.136”:</p>
<p>bc03model = BC03Model(“csp_lr_solar_0p1Gyr.136”)</p>
<p>The wavelength units of SEDs from BC03 models are Angstroms. Flux is converted into units of
erg/s/Angstrom (the units in the files output by galaxevpl are LSun/Angstrom).</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astSED.Jy2Mag">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">Jy2Mag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fluxJy</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.Jy2Mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts flux density in Jy into AB magnitude</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fluxJy</strong> (<em>float</em>) – flux density in Jy</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>AB magnitude</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="astLib.astSED.M05Model">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">M05Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em>, <em class="sig-param"><span class="n">fileType</span><span class="o">=</span><span class="default_value">'csp'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.M05Model" title="Permalink to this definition">¶</a></dt>
<dd><p>This class describes a Maraston 2005 stellar population model. To load a composite stellar population
model (CSP) for a tau = 0.1 Gyr burst of star formation, solar metallicity, Salpeter IMF:</p>
<p>m05csp = astSED.M05Model(M05_DIR+”/csp_e_0.10_z02_salp.sed_agb”)</p>
<p>where M05_DIR is set to point to the directory where the Maraston 2005 models are stored on your system.</p>
<p>The file format of the Maraston 2005 simple stellar poulation (SSP) models is different to the file
format used for the CSPs, and this needs to be specified using the fileType parameter. To load a SSP with
solar metallicity, red horizontal branch morphology:</p>
<p>m05ssp = astSED.M05Model(M05_DIR+”/sed.ssz002.rhb”, fileType = “ssp”)</p>
<p>The wavelength units of SEDs from M05 models are Angstroms, with flux in units of erg/s/Angstrom.</p>
</dd></dl>

<dl class="py class">
<dt id="astLib.astSED.P09Model">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">P09Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.P09Model" title="Permalink to this definition">¶</a></dt>
<dd><p>This class describes a Percival et al 2009 (BaSTI; <a class="reference external" href="http://albione.oa-teramo.inaf.it">http://albione.oa-teramo.inaf.it</a>) stellar
population model. We assume that the synthetic spectra for each model are unpacked under the directory
pointed to by fileName.</p>
<p>The wavelength units of SEDs from P09 models are converted to Angstroms. Flux is converted into units of
erg/s/Angstrom (the units in the BaSTI low-res spectra are 4.3607e-33 erg/s/m).</p>
</dd></dl>

<dl class="py class">
<dt id="astLib.astSED.Passband">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">Passband</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em>, <em class="sig-param"><span class="n">normalise</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">inputUnits</span><span class="o">=</span><span class="default_value">'angstroms'</span></em>, <em class="sig-param"><span class="n">wavelengthColumn</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transmissionColumn</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.Passband" title="Permalink to this definition">¶</a></dt>
<dd><p>This class describes a filter transmission curve. Passband objects are created by loading data from
from text files containing wavelength in angstroms in the first column, relative transmission efficiency
in the second column (whitespace delimited). For example, to create a Passband object for the 2MASS J
filter:</p>
<p>passband=astSED.Passband(“J_2MASS.res”)</p>
<p>where “J_2MASS.res” is a file in the current working directory that describes the filter.</p>
<p>Wavelength units can be specified as ‘angstroms’, ‘nanometres’ or ‘microns’; if either of the latter,
they will be converted to angstroms.</p>
<dl class="py method">
<dt id="astLib.astSED.Passband.asList">
<code class="sig-name descname">asList</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.Passband.asList" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a two dimensional list of [wavelength, transmission], suitable for plotting by gnuplot.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list in format [wavelength, transmission]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.Passband.effectiveWavelength">
<code class="sig-name descname">effectiveWavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.Passband.effectiveWavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates effective wavelength for the passband. This is the same as equation (3) of
Carter et al. 2009.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>effective wavelength of the passband, in Angstroms</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.Passband.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xmin</span><span class="o">=</span><span class="default_value">'min'</span></em>, <em class="sig-param"><span class="n">xmax</span><span class="o">=</span><span class="default_value">'max'</span></em>, <em class="sig-param"><span class="n">maxTransmission</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.Passband.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the passband, rescaling the maximum of the tranmission curve to maxTransmission if
required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmin</strong> (<em>float</em><em> or </em><em>'min'</em>) – minimum of the wavelength range of the plot</p></li>
<li><p><strong>xmax</strong> (<em>float</em><em> or </em><em>'max'</em>) – maximum of the wavelength range of the plot</p></li>
<li><p><strong>maxTransmission</strong> (<em>float</em>) – maximum value of rescaled transmission curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.Passband.rescale">
<code class="sig-name descname">rescale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maxTransmission</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.Passband.rescale" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescales the passband so that maximum value of the transmission is equal to maxTransmission.
Useful for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>maxTransmission</strong> (<em>float</em>) – maximum value of rescaled transmission curve</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="astLib.astSED.SED">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">SED</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">flux</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">ageGyr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalise</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">label</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED" title="Permalink to this definition">¶</a></dt>
<dd><p>This class describes a Spectral Energy Distribution (SED).</p>
<p>To create a SED object, lists (or numpy arrays) of wavelength and relative flux must be provided. The SED
can optionally be redshifted. The wavelength units of SEDs are assumed to be Angstroms - flux
calculations using Passband and SED objects specified with different wavelength units will be incorrect.</p>
<p>The <a class="reference internal" href="#astLib.astSED.StellarPopulation" title="astLib.astSED.StellarPopulation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StellarPopulation</span></code></a> class (and derivatives) can be used to extract SEDs for specified ages from e.g.
the Bruzual &amp; Charlot 2003 or Maraston 2005 models.</p>
<dl class="py method">
<dt id="astLib.astSED.SED.asList">
<code class="sig-name descname">asList</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.asList" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a two dimensional list of [wavelength, flux], suitable for plotting by gnuplot.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list in format [wavelength, flux]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.calcColour">
<code class="sig-name descname">calcColour</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">passband1</span></em>, <em class="sig-param"><span class="n">passband2</span></em>, <em class="sig-param"><span class="n">magType</span><span class="o">=</span><span class="default_value">'Vega'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.calcColour" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the colour passband1-passband2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>passband1</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – filter passband through which to calculate the first magnitude</p></li>
<li><p><strong>passband1</strong> – filter passband through which to calculate the second magnitude</p></li>
<li><p><strong>magType</strong> (<em>string</em>) – either “Vega” or “AB”</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>colour defined by passband1 - passband2 on the specified magnitude system</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.calcFlux">
<code class="sig-name descname">calcFlux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">passband</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.calcFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates flux in the given passband.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>passband</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – filter passband through which to calculate the flux from the SED</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flux</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.calcMag">
<code class="sig-name descname">calcMag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">passband</span></em>, <em class="sig-param"><span class="n">addDistanceModulus</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">magType</span><span class="o">=</span><span class="default_value">'Vega'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.calcMag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates magnitude in the given passband. If addDistanceModulus == True,
then the distance modulus (5.0*log10*(dl*1e5), where dl is the luminosity distance
in Mpc at the redshift of the <a class="reference internal" href="#astLib.astSED.SED" title="astLib.astSED.SED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SED</span></code></a>) is added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>passband</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – filter passband through which to calculate the magnitude from the SED</p></li>
<li><p><strong>addDistanceModulus</strong> (<em>bool</em>) – if True, adds 5.0*log10*(dl*1e5) to the mag returned, where
dl is the luminosity distance (Mpc) corresponding to the SED z</p></li>
<li><p><strong>magType</strong> (<em>string</em>) – either “Vega” or “AB”</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>magnitude through the given passband on the specified magnitude system</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies the SED, returning a new SED object</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#astLib.astSED.SED" title="astLib.astSED.SED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SED</span></code></a> object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SED</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.extinctionCalzetti">
<code class="sig-name descname">extinctionCalzetti</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">EBMinusV</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.extinctionCalzetti" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Calzetti et al. 2000 (ApJ, 533, 682) extinction law to the SED with the given
E(B-V) amount of extinction. R_v’ = 4.05 is assumed (see equation (5) of Calzetti et al.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>EBMinusV</strong> (<em>float</em>) – extinction E(B-V), in magnitudes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.getSEDDict">
<code class="sig-name descname">getSEDDict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">passbands</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.getSEDDict" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a convenience function for pulling out fluxes from a SED for a given set of passbands
in the same format as made by <a class="reference internal" href="#astLib.astSED.mags2SEDDict" title="astLib.astSED.mags2SEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mags2SEDDict</span></code></a> - designed to make fitting code simpler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>passbands</strong> (list of <a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> objects) – list of passbands through which fluxes will be calculated</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.integrate">
<code class="sig-name descname">integrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelengthMin</span><span class="o">=</span><span class="default_value">'min'</span></em>, <em class="sig-param"><span class="n">wavelengthMax</span><span class="o">=</span><span class="default_value">'max'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates flux in SED within given wavelength range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelengthMin</strong> (<em>float</em><em> or </em><em>'min'</em>) – minimum of the wavelength range</p></li>
<li><p><strong>wavelengthMax</strong> (<em>float</em><em> or </em><em>'max'</em>) – maximum of the wavelength range</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>relative flux</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.loadFromFile">
<code class="sig-name descname">loadFromFile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.loadFromFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads SED from a white space delimited file in the format wavelength, flux. Lines beginning with
# are ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fileName</strong> (<em>string</em>) – path to file containing wavelength, flux data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.matchFlux">
<code class="sig-name descname">matchFlux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">matchSED</span></em>, <em class="sig-param"><span class="n">minWavelength</span></em>, <em class="sig-param"><span class="n">maxWavelength</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.matchFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Matches the flux in the wavelength range given by minWavelength, maxWavelength to the
flux in the same region in matchSED. Useful for plotting purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matchSED</strong> (<a class="reference internal" href="#astLib.astSED.SED" title="astLib.astSED.SED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SED</span></code></a> object) – SED to match flux to</p></li>
<li><p><strong>minWavelength</strong> (<em>float</em>) – minimum of range in which to match flux of current SED to matchSED</p></li>
<li><p><strong>maxWavelength</strong> (<em>float</em>) – maximum of range in which to match flux of current SED to matchSED</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.normalise">
<code class="sig-name descname">normalise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">minWavelength</span><span class="o">=</span><span class="default_value">'min'</span></em>, <em class="sig-param"><span class="n">maxWavelength</span><span class="o">=</span><span class="default_value">'max'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.normalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalises the SED such that the area under the specified wavelength range is equal to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minWavelength</strong> (<em>float</em><em> or </em><em>'min'</em>) – minimum wavelength of range over which to normalise SED</p></li>
<li><p><strong>maxWavelength</strong> (<em>float</em><em> or </em><em>'max'</em>) – maximum wavelength of range over which to normalise SED</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.normaliseToMag">
<code class="sig-name descname">normaliseToMag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ABMag</span></em>, <em class="sig-param"><span class="n">passband</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.normaliseToMag" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalises the SED to match the flux equivalent to the given AB magnitude in the given passband.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ABMag</strong> (<em>float</em>) – AB magnitude to which the SED is to be normalised at the given passband</p></li>
<li><p><strong>passband</strong> (an <a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – passband at which normalisation to AB magnitude is calculated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xmin</span><span class="o">=</span><span class="default_value">'min'</span></em>, <em class="sig-param"><span class="n">xmax</span><span class="o">=</span><span class="default_value">'max'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a simple (wavelength, flux) plot of the SED.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmin</strong> (<em>float</em><em> or </em><em>'min'</em>) – minimum of the wavelength range of the plot</p></li>
<li><p><strong>xmax</strong> (<em>float</em><em> or </em><em>'max'</em>) – maximum of the wavelength range of the plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.redshift">
<code class="sig-name descname">redshift</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.redshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Redshifts the SED to redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – redshift</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.smooth">
<code class="sig-name descname">smooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smoothPix</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooths SED.flux with a uniform (boxcar) filter of width smoothPix. Cannot be undone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>smoothPix</strong> (<em>int</em>) – size of uniform filter applied to SED, in pixels</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.SED.writeToFile">
<code class="sig-name descname">writeToFile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.SED.writeToFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes SED to a white space delimited file in the format wavelength, flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fileName</strong> (<em>string</em>) – path to file</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt id="astLib.astSED.SOL">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">SOL</code><em class="property"> = &lt;astLib.astSED.SED object&gt;</em><a class="headerlink" href="#astLib.astSED.SOL" title="Permalink to this definition">¶</a></dt>
<dd><p>The SED of the Sun (<a class="reference internal" href="#astLib.astSED.SED" title="astLib.astSED.SED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SED</span></code></a> object).</p>
</dd></dl>

<dl class="py class">
<dt id="astLib.astSED.StellarPopulation">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">StellarPopulation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em>, <em class="sig-param"><span class="n">ageColumn</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">wavelengthColumn</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">fluxColumn</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.StellarPopulation" title="Permalink to this definition">¶</a></dt>
<dd><p>This class describes a stellar population model, either a Simple Stellar Population (SSP) or a
Composite Stellar Population (CSP), such as the models of Bruzual &amp; Charlot 2003 or Maraston 2005.</p>
<p>The constructor for this class can be used for generic SSPs or CSPs stored in white space delimited text
files, containing columns for age, wavelength, and flux. Columns are counted from 0 … n. Lines starting
with # are ignored.</p>
<p>The classes <a class="reference internal" href="#astLib.astSED.M05Model" title="astLib.astSED.M05Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">M05Model</span></code></a> (for Maraston 2005 models), <a class="reference internal" href="#astLib.astSED.BC03Model" title="astLib.astSED.BC03Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BC03Model</span></code></a> (for Bruzual &amp; Charlot 2003 models), and
<a class="reference internal" href="#astLib.astSED.P09Model" title="astLib.astSED.P09Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">P09Model</span></code></a> (for Percival et al. 2009 models) are derived from this class. The only difference between
them is the code used to load in the model data.</p>
<dl class="py method">
<dt id="astLib.astSED.StellarPopulation.calcEvolutionCorrection">
<code class="sig-name descname">calcEvolutionCorrection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">zFrom</span></em>, <em class="sig-param"><span class="n">zTo</span></em>, <em class="sig-param"><span class="n">zFormation</span></em>, <em class="sig-param"><span class="n">passband</span></em>, <em class="sig-param"><span class="n">magType</span><span class="o">=</span><span class="default_value">'Vega'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.StellarPopulation.calcEvolutionCorrection" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the evolution correction in magnitudes in the rest frame through the passband
from redshift zFrom to redshift zTo, where the stellarPopulation is assumed to be formed
at redshift zFormation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zFormation</strong> (<em>float</em>) – redshift to evolution correct from</p></li>
<li><p><strong>zTo</strong> (<em>float</em>) – redshift to evolution correct to</p></li>
<li><p><strong>zFormation</strong> – formation redshift of the StellarPopulation</p></li>
<li><p><strong>passband</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – filter passband through which to calculate magnitude</p></li>
<li><p><strong>magType</strong> (<em>string</em>) – either “Vega” or “AB”</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>evolution correction in magnitudes in the rest frame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.StellarPopulation.getColourEvolution">
<code class="sig-name descname">getColourEvolution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">passband1</span></em>, <em class="sig-param"><span class="n">passband2</span></em>, <em class="sig-param"><span class="n">zFormation</span></em>, <em class="sig-param"><span class="n">zStepSize</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">magType</span><span class="o">=</span><span class="default_value">'Vega'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.StellarPopulation.getColourEvolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the evolution of the colour observed through passband1 - passband2 for the
StellarPopulation with redshift, from z = 0 to z = zFormation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>passband1</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – filter passband through which to calculate the first magnitude</p></li>
<li><p><strong>passband2</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – filter passband through which to calculate the second magnitude</p></li>
<li><p><strong>zFormation</strong> (<em>float</em>) – formation redshift of the StellarPopulation</p></li>
<li><p><strong>zStepSize</strong> (<em>float</em>) – size of interval in z at which to calculate model colours</p></li>
<li><p><strong>magType</strong> (<em>string</em>) – either “Vega” or “AB”</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of numpy.arrays in format {‘z’, ‘colour’}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.StellarPopulation.getMagEvolution">
<code class="sig-name descname">getMagEvolution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">passband</span></em>, <em class="sig-param"><span class="n">magNormalisation</span></em>, <em class="sig-param"><span class="n">zNormalisation</span></em>, <em class="sig-param"><span class="n">zFormation</span></em>, <em class="sig-param"><span class="n">zStepSize</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">onePlusZSteps</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">magType</span><span class="o">=</span><span class="default_value">'Vega'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.StellarPopulation.getMagEvolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the evolution with redshift (from z = 0 to z = zFormation) of apparent magnitude
in the observed frame through the passband for the StellarPopulation, normalised to magNormalisation
(apparent) at z = zNormalisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>passband</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – filter passband through which to calculate the magnitude</p></li>
<li><p><strong>magNormalisation</strong> (<em>float</em>) – sets the apparent magnitude of the SED at zNormalisation</p></li>
<li><p><strong>zNormalisation</strong> (<em>float</em>) – the redshift at which the magnitude normalisation is carried out</p></li>
<li><p><strong>zFormation</strong> (<em>float</em>) – formation redshift of the StellarPopulation</p></li>
<li><p><strong>zStepSize</strong> (<em>float</em>) – size of interval in z at which to calculate model magnitudes</p></li>
<li><p><strong>onePlusZSteps</strong> (<em>bool</em>) – if True, zSteps are (1+z)*zStepSize, otherwise zSteps are linear</p></li>
<li><p><strong>magType</strong> (<em>string</em>) – either “Vega” or “AB”</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of numpy.arrays in format {‘z’, ‘mag’}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astLib.astSED.StellarPopulation.getSED">
<code class="sig-name descname">getSED</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ageGyr</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">normalise</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">label</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.StellarPopulation.getSED" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a SED for given age. Do linear interpolation between models if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ageGyr</strong> (<em>float</em>) – age of the SED in Gyr</p></li>
<li><p><strong>z</strong> (<em>float</em>) – redshift the SED from z = 0 to z = z</p></li>
<li><p><strong>normalise</strong> (<em>bool</em>) – normalise the SED to have area 1</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#astLib.astSED.SED" title="astLib.astSED.SED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SED</span></code></a> object</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>SED</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="astLib.astSED.TopHatPassband">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">TopHatPassband</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelengthMin</span></em>, <em class="sig-param"><span class="n">wavelengthMax</span></em>, <em class="sig-param"><span class="n">normalise</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.TopHatPassband" title="Permalink to this definition">¶</a></dt>
<dd><p>This class generates a passband with a top hat response between the given wavelengths.</p>
</dd></dl>

<dl class="py data">
<dt id="astLib.astSED.VEGA">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">VEGA</code><em class="property"> = &lt;astLib.astSED.VegaSED object&gt;</em><a class="headerlink" href="#astLib.astSED.VEGA" title="Permalink to this definition">¶</a></dt>
<dd><p>The SED of Vega, used for calculation of magnitudes on the Vega system (<a class="reference internal" href="#astLib.astSED.SED" title="astLib.astSED.SED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SED</span></code></a> object).</p>
</dd></dl>

<dl class="py class">
<dt id="astLib.astSED.VegaSED">
<em class="property">class </em><code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">VegaSED</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">normalise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.VegaSED" title="Permalink to this definition">¶</a></dt>
<dd><p>This class stores the SED of Vega, used for calculation of magnitudes on the Vega system.</p>
<p>The Vega SED used is taken from Bohlin 2007 (<a class="reference external" href="http://adsabs.harvard.edu/abs/2007ASPC..364..315B">http://adsabs.harvard.edu/abs/2007ASPC..364..315B</a>), and is
available from the STScI CALSPEC library (<a class="reference external" href="http://www.stsci.edu/hst/observatory/cdbs/calspec.html">http://www.stsci.edu/hst/observatory/cdbs/calspec.html</a>).</p>
</dd></dl>

<dl class="py function">
<dt id="astLib.astSED.fitSEDDict">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">fitSEDDict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">SEDDict</span></em>, <em class="sig-param"><span class="n">modelSEDDictList</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.fitSEDDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the given SED dictionary (made using <a class="reference internal" href="#astLib.astSED.mags2SEDDict" title="astLib.astSED.mags2SEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mags2SEDDict</span></code></a>) with the given list of model SED
dictionaries. The latter should be made using <a class="reference internal" href="#astLib.astSED.makeModelSEDDictList" title="astLib.astSED.makeModelSEDDictList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">makeModelSEDDictList</span></code></a>, and entries for fluxes should
correspond directly between the model and SEDDict.</p>
<p>Returns a dictionary with best fit values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SEDDict</strong> (dictionary, in format of <a class="reference internal" href="#astLib.astSED.mags2SEDDict" title="astLib.astSED.mags2SEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mags2SEDDict</span></code></a>) – dictionary of observed fluxes and uncertainties, in format of <a class="reference internal" href="#astLib.astSED.mags2SEDDict" title="astLib.astSED.mags2SEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mags2SEDDict</span></code></a></p></li>
<li><p><strong>modelSEDDictList</strong> (list of dictionaries, in format of <a class="reference internal" href="#astLib.astSED.makeModelSEDDictList" title="astLib.astSED.makeModelSEDDictList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">makeModelSEDDictList</span></code></a>) – list of dictionaries containing fluxes of models to be fitted to the observed fluxes listed in the SEDDict. This should be made using <a class="reference internal" href="#astLib.astSED.makeModelSEDDictList" title="astLib.astSED.makeModelSEDDictList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">makeModelSEDDictList</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>results of the fitting - keys:
- ‘minChiSq’: minimum chi squared value of best fit
- ‘chiSqContrib’: corresponding contribution at each passband to the minimum chi squared value
- ‘ageGyr’: the age in Gyr of the best fitting model
- ‘modelFileName’: the file name of the stellar population model corresponding to the best fit
- ‘modelListIndex’: the index of the best fitting model in the input modelSEDDictList
- ‘norm’: the normalisation that the best fit model should be multiplied by to match the SEDDict
- ‘z’: the redshift of the best fit model
- ‘E(B-V)’: the extinction, E(B-V), in magnitudes, of the best fit model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astSED.flux2Mag">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">flux2Mag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">fluxErr</span></em>, <em class="sig-param"><span class="n">passband</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.flux2Mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts given flux and uncertainty in erg/s/cm^2/Angstrom into AB magnitudes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>float</em>) – flux in erg/s/cm^2/Angstrom in passband</p></li>
<li><p><strong>fluxErr</strong> (<em>float</em>) – uncertainty in flux in passband, in erg/s/cm^2/Angstrom</p></li>
<li><p><strong>passband</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – <a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object at which ABMag was measured</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[ABMag, ABMagError], in AB magnitudes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astSED.mag2Flux">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">mag2Flux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ABMag</span></em>, <em class="sig-param"><span class="n">ABMagErr</span></em>, <em class="sig-param"><span class="n">passband</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.mag2Flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts given AB magnitude and uncertainty into flux, in erg/s/cm^2/Angstrom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ABMag</strong> (<em>float</em>) – magnitude on AB system in passband</p></li>
<li><p><strong>ABMagErr</strong> (<em>float</em>) – uncertainty in AB magnitude in passband</p></li>
<li><p><strong>passband</strong> (<a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object) – <a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> object at which ABMag was measured</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[flux, fluxError], in units of erg/s/cm^2/Angstrom</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astSED.mag2Jy">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">mag2Jy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ABMag</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.mag2Jy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an AB magnitude into flux density in Jy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ABMag</strong> (<em>float</em>) – AB magnitude</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flux density in Jy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astSED.mags2SEDDict">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">mags2SEDDict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ABMags</span></em>, <em class="sig-param"><span class="n">ABMagErrs</span></em>, <em class="sig-param"><span class="n">passbands</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.mags2SEDDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a set of corresponding AB magnitudes, uncertainties, and passbands, and
returns a dictionary with keys ‘flux’, ‘fluxErr’, ‘wavelength’. Fluxes are in units of
erg/s/cm^2/Angstrom, wavelength in Angstroms. These dictionaries are the staple diet of the
<a class="reference internal" href="#astLib.astSED.fitSEDDict" title="astLib.astSED.fitSEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fitSEDDict</span></code></a> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ABMags</strong> (<em>list</em><em> or </em><em>numpy array</em>) – AB magnitudes, specified in corresponding order to passbands and ABMagErrs</p></li>
<li><p><strong>ABMagErrs</strong> (<em>list</em><em> or </em><em>numpy array</em>) – AB magnitude errors, specified in corresponding order to passbands and ABMags</p></li>
<li><p><strong>passbands</strong> (list of <a class="reference internal" href="#astLib.astSED.Passband" title="astLib.astSED.Passband"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Passband</span></code></a> objects) – passband objects, specified in corresponding order to ABMags and ABMagErrs</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary with keys {‘flux’, ‘fluxErr’, ‘wavelength’}, suitable for input to <a class="reference internal" href="#astLib.astSED.fitSEDDict" title="astLib.astSED.fitSEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fitSEDDict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="astLib.astSED.makeModelSEDDictList">
<code class="sig-prename descclassname">astLib.astSED.</code><code class="sig-name descname">makeModelSEDDictList</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">modelList</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">passbandsList</span></em>, <em class="sig-param"><span class="n">labelsList</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">EBMinusVList</span><span class="o">=</span><span class="default_value">[0.0]</span></em>, <em class="sig-param"><span class="n">forceYoungerThanUniverse</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#astLib.astSED.makeModelSEDDictList" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine makes a list of SEDDict dictionaries (see <a class="reference internal" href="#astLib.astSED.mags2SEDDict" title="astLib.astSED.mags2SEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mags2SEDDict</span></code></a>) for fitting using
<a class="reference internal" href="#astLib.astSED.fitSEDDict" title="astLib.astSED.fitSEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fitSEDDict</span></code></a>. This speeds up the fitting as this allows us to calculate model SED magnitudes only once,
if all objects to be fitted are at the same redshift. We add some meta data to the modelSEDDicts (e.g.
the model file names).</p>
<p>The effect of extinction by dust (assuming the Calzetti et al. 2000 law) can be included by giving a list
of E(B-V) values.</p>
<p>If forceYoungerThanUniverse == True, ages which are older than the universe at the given z will not be
included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modelList</strong> (list of <a class="reference internal" href="#astLib.astSED.StellarPopulation" title="astLib.astSED.StellarPopulation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StellarPopulation</span></code></a> model objects) – list of StellarPopulation models to include</p></li>
<li><p><strong>z</strong> (<em>float</em>) – redshift to apply to all stellar population models in modelList</p></li>
<li><p><strong>EBMinusVList</strong> (<em>list</em>) – list of E(B-V) extinction values to apply to all models, in magnitudes</p></li>
<li><p><strong>labelsList</strong> (<em>list</em>) – optional list used for labelling passbands in output SEDDicts</p></li>
<li><p><strong>forceYoungerThanUniverse</strong> (<em>bool</em>) – if True, do not allow models that exceed the age of the universe at z</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of dictionaries containing model fluxes, to be used as input to <a class="reference internal" href="#astLib.astSED.fitSEDDict" title="astLib.astSED.fitSEDDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fitSEDDict</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="usage.html" class="btn btn-neutral float-left" title="Introduction and Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Matt Hilton &amp; Steven Boada.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>