(self.webpackChunkatoti_jupyterlab=self.webpackChunkatoti_jupyterlab||[]).push([[7741],{87741:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var l=s(56271),a=s.n(l),n=s(18032),o=s(25654),c=s(39030),r=s(98537),i=s.n(r),u=s(2689),m=s.n(u),p=s(95479),d=s(13423);const b=e=>{const t=[];return e.forEach((e=>{const s=e.name;t.includes(s)||(e.showlegend=!0,t.push(s))})),e};function h({cube:e,data:t,metaData:s,widgetState:{colors:l,isTextVisible:a,mapping:o,opacity:c=1}}){if(!e||!t||!s)return[];const r={},u={},d={mapping:{},numberOfUsedAutomaticColors:0},{attributesRedirection:h}=s,y=o.size.length>0;let g=0;const x=o.horizontalSubplots.length+o.verticalSubplots.length>0;(0,p.IG)(t,s.hierarchyIndicesInCellSet,(({cell:e,cellIndex:t,columnIndex:m,tuple:p,rowIndex:b})=>{const y=(0,n._F)(p,s.levelIndicesPerField,o,h),x=[...y.color,...y.horizontalSubplots,...y.verticalSubplots],I=y.splitBy,f=(0,n.Lj)(x),v=(0,n.Lj)(I),w=e.value,k=(({membersPerAttribute:e,pointKey:t,traceKey:o})=>(u[o]||(u[o]=function({traceKey:e,membersPerAttribute:t}){const o=(0,n.Ym)(t.color,0),r=Object.values(u).some((e=>e.name===o)),i=(0,n.he)({accumulator:d,colorway:s.colorway,colors:l,traceName:o});return{_key:e,hoverinfo:"none",legendgroup:o,mode:a?"text+markers":"markers",name:o,cellsIndices:[],showlegend:!r,text:[],textposition:"top center",type:"scatter",marker:{size:[],color:i},x:[],y:[],opacity:c}}({traceKey:o,membersPerAttribute:e})),i()(r,{[o]:{[t]:{}}}),r[o][t]))({membersPerAttribute:y,traceKey:f,pointKey:v});if(k.cellsIndices||(k.cellsIndices=[]),k.cellsIndices.push({rowIndex:b,columnIndex:m,cellIndex:t}),y.xValues.length>0)k.x=w;else if(y.yValues.length>0)k.y=w;else if(y.size.length>0){const e=Math.abs(w);k.size=e,e>g&&(g=e)}y.splitBy.length>0&&(k.text=(0,n.KT)(y.splitBy))})),Object.entries(u).forEach((([e,t])=>{const s=r[e];y||(t.marker.size=15),Object.values(s).forEach((e=>{const{cellsIndices:s,x:l,y:a,size:n,text:o}=e;t.cellsIndices.push(s),t.x.push(l),t.y.push(a),t.text.push(o),y&&t.marker.size.push(100*n/g)}))}));const I=Object.values(u);if(I.forEach((e=>{var t;e.axisIndices=m()(null===(t=e.x)||void 0===t?void 0:t.length)})),x){const e=s.subplots,t=(0,n.$)({traces:I,subplotsMetaData:e});return(0,n.Mr)(t,e),b(t),t}return b(I),I}const y=(0,n.i)((0,n.H9)((0,l.memo)((e=>{const{cube:t,data:s,metaData:r,widgetState:i,onLoaded:u}=e,m=(0,l.useMemo)((()=>(0,c.TS)(null==i?void 0:i.mapping)),[null==i?void 0:i.mapping]);(0,n.ge)({isEmpty:m,onLoaded:u});const p=(0,l.useMemo)((()=>h({cube:t,data:s,metaData:r,widgetState:i})),[t,s,r,i]),b=(0,l.useMemo)((()=>(e=>e?(0,d.IM)(n.bR,(0,n.S5)(e.subplots),(0,n.lH)(e.subplots)):{})(r)),[r]);return t&&s&&r&&!m?a().createElement(n.XN,(0,o.Z)({},e,{traces:p,layout:b,cube:t,data:s,metaData:r})):a().createElement(n.MQ,null)}))))}}]);