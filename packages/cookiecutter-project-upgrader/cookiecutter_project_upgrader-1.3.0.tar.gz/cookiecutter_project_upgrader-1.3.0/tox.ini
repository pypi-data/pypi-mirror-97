[globals]
source_folder = cookiecutter_project_upgrader

[tox]
envlist = py37,py36,flake8,mypy
toxworkdir = {toxinidir}/.dev/.tox

[gh-actions]
python =
    3.6: py36
    3.7: py37, mypy, flake8

[pytest_env_properties]
setenv =
    PYTHONPATH = {toxinidir}
extras = dev

# see https://tox.readthedocs.io/en/latest/example/pytest.html
changedir = tests
commands =
    pytest --basetemp={envtmpdir} --cov=../{[globals]source_folder} --cov-report=xml {posargs}
    coverage erase

[testenv:py37]
setenv = {[pytest_env_properties]setenv}
extras = {[pytest_env_properties]extras}
changedir = {[pytest_env_properties]changedir}
commands = {[pytest_env_properties]commands}

[testenv:py36]
setenv = {[pytest_env_properties]setenv}
extras = {[pytest_env_properties]extras}
changedir = {[pytest_env_properties]changedir}
commands = {[pytest_env_properties]commands}

[testenv:flake8]
basepython = python
deps = flake8
commands = flake8 {[globals]source_folder} tests
skip_install = true

[testenv:mypy]
basepython = python
extras = dev
commands = mypy {[globals]source_folder} tests/__init__.py  tests/files.py  tests/test_cli.py  tests/test_logic.py  tests/tmp_files.py
