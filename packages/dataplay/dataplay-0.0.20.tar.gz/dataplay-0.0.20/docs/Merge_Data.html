---

title: Merge Data


keywords: fastai
sidebar: home_sidebar

summary: "This notebook was made to demonstrate how to merge datasets by matching a single columns values from two datasets. We add columns of data from a foreign dataset into the ACS data we downloaded in our last tutorial."
description: "This notebook was made to demonstrate how to merge datasets by matching a single columns values from two datasets. We add columns of data from a foreign dataset into the ACS data we downloaded in our last tutorial."
nb_path: "notebooks/02_Merge_Data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/02_Merge_Data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/content/drive/My Drive/Sites/dataplay/dataplay/acsDownload.py:27: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option(&#39;display.max_colwidth&#39;, -1)
/usr/local/lib/python3.7/dist-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use &#34;pip install psycopg2-binary&#34; instead. For details see: &lt;http://initd.org/psycopg/docs/install.html#binary-install-from-pypi&gt;.
  &#34;&#34;&#34;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This Coding Notebook is the <strong>second</strong> in a series.</p>
<p>An Interactive version can be found here <a href="https://colab.research.google.com/github/karpatic/dataplay/blob/master/notebooks/02_Merge_Data.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>.</p>
<p>This colab and more can be found on our <a href="https://karpatic.github.io/dataplay/">webpage</a>.</p>
<ul>
<li><p>Content covered in previous tutorials will be used in later tutorials.</p>
</li>
<li><p><strong>New code and or  information <em>should</em> have explanations and or descriptions</strong> attached.</p>
</li>
<li><p>Concepts or code covered in previous tutorials will be used without being explaining in entirety.</p>
</li>
<li><p>The <a href="https://karpatic.github.io/dataplay/">Dataplay</a> Handbook development techniques covered in the <a href="https://karpatic.github.io/datalabs/">Datalabs</a> Guidebook</p>
</li>
<li><p><strong>If content can not be found in the current tutorial and is not covered in previous tutorials, please let me know.</strong></p>
</li>
<li><p>This notebook has been optimized for Google Colabs ran on a Chrome Browser.</p>
</li>
<li><p>Statements found in the index page on view expressed, responsibility, errors and ommissions, use at risk, and licensing  extend throughout the tutorial.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://mybinder.org/v2/gh/karpatic/datalab/master?filepath=%2Fnotebooks%2Findex.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt="Binder"></a>
<a href="https://colab.research.google.com/github/karpatic/datalab/blob/master/notebooks/index.ipynb"><img src="https://pete88b.github.io/fastpages/assets/badges/colab.svg" alt="Binder"></a>
<a href="https://github.com/karpatic/datalab/tree/master/notebooks/index.ipynb"><img src="https://pete88b.github.io/fastpages/assets/badges/github.svg" alt="Binder"></a>
<a href="https://github.com/ellerbrock/open-source-badges/"><img src="https://badges.frapsoft.com/os/v3/open-source.svg?v=103" alt="Open Source Love svg3"></a></p>
<p><a href="https://github.com/karpatic/dataplay/blob/master/LICENSE"><img src="https://img.shields.io/npm/l/all-contributors.svg?style=flat" alt="NPM License"></a>
<a href="https://karpatic.github.io"><img src="http://img.shields.io/badge/Status-Active-green.svg" alt="Active"></a> 
<a href="https://pypi.python.org/pypi/dataplay/"><img src="https://img.shields.io/pypi/pyversions/dataplay.svg" alt="Python Versions"></a>
<a href=""><img src="https://img.shields.io/github/last-commit/karpatic/dataplay.svg?style=flat" alt="GitHub last commit"></a> 
<a href="http://unmaintained.tech/"><img src="http://unmaintained.tech/badge.svg" alt="No Maintenance Intended"></a></p>
<p><a href="https://github.com/karpatic/dataplay"><img src="https://img.shields.io/github/stars/karpatic/dataplay.svg?style=social&amp;label=Star" alt="GitHub stars"></a> 
<a href="https://github.com/karpatic/dataplay"><img src="https://img.shields.io/github/watchers/karpatic/dataplay.svg?style=social&amp;label=Watch" alt="GitHub watchers"></a> 
<a href="https://github.com/karpatic/dataplay"><img src="https://img.shields.io/github/forks/karpatic/dataplay.svg?style=social&amp;label=Fork" alt="GitHub forks"></a> 
<a href="https://github.com/karpatic/dataplay"><img src="https://img.shields.io/github/followers/karpatic.svg?style=social&amp;label=Follow" alt="GitHub followers"></a></p>
<p><a href="https://twitter.com/intent/tweet?text=Check%20out%20this%20%E2%9C%A8%20colab%20by%20@bniajfi%20https://github.com/karpatic/dataplay%20%F0%9F%A4%97"><img src="https://img.shields.io/twitter/url/https/github.com/karpatic/dataplay.svg?style=social" alt="Tweet"></a> 
<a href="https://twitter.com/bniajfi"><img src="https://img.shields.io/twitter/follow/bniajfi.svg?style=social" alt="Twitter Follow"></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="About-this-Tutorial:">About this Tutorial:<a class="anchor-link" href="#About-this-Tutorial:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Whats-Inside?">Whats Inside?<a class="anchor-link" href="#Whats-Inside?"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-Tutorial"><strong>The Tutorial</strong><a class="anchor-link" href="#The-Tutorial"> </a></h4><p>In this notebook, the basics of how to perform a merge are introduced.</p>
<ul>
<li>We will merge two datasets</li>
<li>We will merge two datasets using a crosswalk</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Objectives"><strong>Objectives</strong><a class="anchor-link" href="#Objectives"> </a></h4><p>By the end of this tutorial users should have an understanding of:</p>
<ul>
<li>How dataset merges are performed</li>
<li>The types different union approaches a merge can take</li>
<li>The 'mergeData' function, and how to use it in the future</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Guided-Walkthrough">Guided Walkthrough<a class="anchor-link" href="#Guided-Walkthrough"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SETUP">SETUP<a class="anchor-link" href="#SETUP"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Install these libraries onto the virtual environment.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">capture</span>
!pip install geopandas
!pip install dataplay
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Retrieve-Datasets">Retrieve Datasets<a class="anchor-link" href="#Retrieve-Datasets"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our example will merge two simple datasets; pulling CSA names using tract ID's.</p>
<p>The <strong>First</strong> dataset will be obtained from the Census' ACS 5-year serveys.</p>
<p>Functions used to obtain this data were obtained from Tutorial 0) ACS: Explore and Download.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>Second</strong> dataset is from a publicly accessible link</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-the-Principal-dataset.">Get the Principal dataset.<a class="anchor-link" href="#Get-the-Principal-dataset."> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will use the function we created in our last tutorial to download the data!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Change these values in the cell below using different geographic reference codes will change those parameters</span>
<span class="n">tract</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;510&#39;</span>
<span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;24&#39;</span>

<span class="c1"># Specify the download parameters the function will receieve here</span>
<span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B19001&#39;</span>
<span class="n">year</span> <span class="o">=</span> <span class="s1">&#39;17&#39;</span>
<span class="n">saveAcs</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of Columns 17
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10,000</th>
      <th>B19001_003E_Total_$10,000_to_$14,999</th>
      <th>B19001_004E_Total_$15,000_to_$19,999</th>
      <th>B19001_005E_Total_$20,000_to_$24,999</th>
      <th>B19001_006E_Total_$25,000_to_$29,999</th>
      <th>B19001_007E_Total_$30,000_to_$34,999</th>
      <th>B19001_008E_Total_$35,000_to_$39,999</th>
      <th>B19001_009E_Total_$40,000_to_$44,999</th>
      <th>B19001_010E_Total_$45,000_to_$49,999</th>
      <th>B19001_011E_Total_$50,000_to_$59,999</th>
      <th>B19001_012E_Total_$60,000_to_$74,999</th>
      <th>B19001_013E_Total_$75,000_to_$99,999</th>
      <th>B19001_014E_Total_$100,000_to_$124,999</th>
      <th>B19001_015E_Total_$125,000_to_$149,999</th>
      <th>B19001_016E_Total_$150,000_to_$199,999</th>
      <th>B19001_017E_Total_$200,000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>tract</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Census Tract 2710.02</th>
      <td>1510</td>
      <td>209</td>
      <td>73</td>
      <td>94</td>
      <td>97</td>
      <td>110</td>
      <td>119</td>
      <td>97</td>
      <td>65</td>
      <td>36</td>
      <td>149</td>
      <td>168</td>
      <td>106</td>
      <td>66</td>
      <td>44</td>
      <td>50</td>
      <td>27</td>
      <td>24</td>
      <td>510</td>
      <td>271002</td>
    </tr>
    <tr>
      <th>Census Tract 2604.02</th>
      <td>1134</td>
      <td>146</td>
      <td>29</td>
      <td>73</td>
      <td>80</td>
      <td>41</td>
      <td>91</td>
      <td>49</td>
      <td>75</td>
      <td>81</td>
      <td>170</td>
      <td>57</td>
      <td>162</td>
      <td>63</td>
      <td>11</td>
      <td>6</td>
      <td>0</td>
      <td>24</td>
      <td>510</td>
      <td>260402</td>
    </tr>
    <tr>
      <th>Census Tract 2712</th>
      <td>2276</td>
      <td>69</td>
      <td>43</td>
      <td>41</td>
      <td>22</td>
      <td>46</td>
      <td>67</td>
      <td>0</td>
      <td>30</td>
      <td>30</td>
      <td>80</td>
      <td>146</td>
      <td>321</td>
      <td>216</td>
      <td>139</td>
      <td>261</td>
      <td>765</td>
      <td>24</td>
      <td>510</td>
      <td>271200</td>
    </tr>
    <tr>
      <th>Census Tract 2804.04</th>
      <td>961</td>
      <td>111</td>
      <td>108</td>
      <td>61</td>
      <td>42</td>
      <td>56</td>
      <td>37</td>
      <td>73</td>
      <td>30</td>
      <td>31</td>
      <td>106</td>
      <td>119</td>
      <td>74</td>
      <td>23</td>
      <td>27</td>
      <td>24</td>
      <td>39</td>
      <td>24</td>
      <td>510</td>
      <td>280404</td>
    </tr>
    <tr>
      <th>Census Tract 901</th>
      <td>1669</td>
      <td>158</td>
      <td>124</td>
      <td>72</td>
      <td>48</td>
      <td>108</td>
      <td>68</td>
      <td>121</td>
      <td>137</td>
      <td>99</td>
      <td>109</td>
      <td>191</td>
      <td>160</td>
      <td>141</td>
      <td>28</td>
      <td>88</td>
      <td>17</td>
      <td>24</td>
      <td>510</td>
      <td>90100</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-the-Secondary-Dataset">Get the Secondary Dataset<a class="anchor-link" href="#Get-the-Secondary-Dataset"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Spatial data can be attained by using the 2010 Census Tract Shapefile Picking <a href="https://www.census.gov/cgi-bin/geo/shapefiles/index.php?year=2010&amp;layergroup=Census+Tracts">Tool</a> or search their website for
Tiger/<a href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2010.html">Line</a> Shapefiles</p>
<blockquote><p>The core TIGER/Line Files and Shapefiles do not include demographic data, but they do contain geographic entity codes (GEOIDs) that can be linked to the Census Bureau’s demographic data, available on data.census.gov.-census.gov</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this example, we will simply pull a local dataset containing columns labeling tracts within Baltimore City and their corresponding CSA (Community Statistical Area). Typically, we use this dataset internally as a "crosswalk" where-upon a succesfull merge using the tract column, will be merged with a 3rd dataset along it's CSA column.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>curl https://bniajfi.org/vs_resources/CSA-to-Tract-2010.csv	&gt; CSA-to-Tract-2010.csv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  8101  100  8101    0     0  23896      0 --:--:-- --:--:-- --:--:-- 23896
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Boundaries Example:CSA-to-Tract-2010.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Boundaries Example:CSA-to-Tract-2010.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Our Example dataset contains Polygon Geometry information. </span>
<span class="c1"># We want to merge this over to our principle dataset. </span>
<span class="c1"># we will grab it by matching on either CSA or Tract</span>

<span class="c1"># The url listed below is public.</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tract 2 CSA Crosswalk : CSA-to-Tract-2010.csv&#39;</span><span class="p">)</span>

<span class="n">inFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Please enter the location of your file : </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>

<span class="n">crosswalk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="n">inFile</span> <span class="p">)</span> 
<span class="n">crosswalk</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Tract 2 CSA Crosswalk : CSA-to-Tract-2010.csv

 Please enter the location of your file : 
CSA-to-Tract-2010.csv
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10100</td>
      <td>24510010100</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10200</td>
      <td>24510010200</td>
      <td>Patterson Park N...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10300</td>
      <td>24510010300</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10400</td>
      <td>24510010400</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10500</td>
      <td>24510010500</td>
      <td>Fells Point</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Perform-Merge-&amp;-Save">Perform Merge &amp; Save<a class="anchor-link" href="#Perform-Merge-&amp;-Save"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following picture does nothing important but serves as a friendly reminder of the 4 basic join types.</p>
<image src="https://docs.trifacta.com/download/attachments/123830435/JoinVennDiagram.png" height='200px'/>

<ul>
<li>Left - returns all left records, only includes the right record if it has a match</li>
<li>Right - Returns all right records, only includes the left record if it has a match </li>
<li>Full - Returns all records regardless of keys matching</li>
<li>Inner - Returns only records where a key match</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get Columns from both datasets to match on</p>
<p>You can get these values from the column values above.</p>
<p>Our Examples will work with the prompted values</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Princpal Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">left_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Left on principal column: (&#39;tract&#39;) </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span><span class="p">);</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Crosswalk Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">right_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Right on crosswalk column: (&#39;TRACTCE10&#39;) </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Princpal Columns Index([&#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)
Left on principal column: (&#39;tract&#39;) 
tract
 
 
Crosswalk Columns Index([&#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)
Right on crosswalk column: (&#39;TRACTCE10&#39;) 
TRACTCE10
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Specify how the merge will be performed</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will perform a left merge in this example.</p>
<p>It will return our Principal dataset with columns from the second dataset appended to records where their specified columns match.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;How: (‘left’, ‘right’, ‘outer’, ‘inner’) &quot;</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>How: (‘left’, ‘right’, ‘outer’, ‘inner’) outer
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Actually perfrom the merge</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">crosswalk</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10,000</th>
      <th>B19001_003E_Total_$10,000_to_$14,999</th>
      <th>B19001_004E_Total_$15,000_to_$19,999</th>
      <th>B19001_005E_Total_$20,000_to_$24,999</th>
      <th>B19001_006E_Total_$25,000_to_$29,999</th>
      <th>B19001_007E_Total_$30,000_to_$34,999</th>
      <th>B19001_008E_Total_$35,000_to_$39,999</th>
      <th>B19001_009E_Total_$40,000_to_$44,999</th>
      <th>B19001_010E_Total_$45,000_to_$49,999</th>
      <th>B19001_011E_Total_$50,000_to_$59,999</th>
      <th>B19001_012E_Total_$60,000_to_$74,999</th>
      <th>B19001_013E_Total_$75,000_to_$99,999</th>
      <th>B19001_014E_Total_$100,000_to_$124,999</th>
      <th>B19001_015E_Total_$125,000_to_$149,999</th>
      <th>B19001_016E_Total_$150,000_to_$199,999</th>
      <th>B19001_017E_Total_$200,000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1510</td>
      <td>209</td>
      <td>73</td>
      <td>94</td>
      <td>97</td>
      <td>110</td>
      <td>119</td>
      <td>97</td>
      <td>65</td>
      <td>36</td>
      <td>149</td>
      <td>168</td>
      <td>106</td>
      <td>66</td>
      <td>44</td>
      <td>50</td>
      <td>27</td>
      <td>24</td>
      <td>510</td>
      <td>271002.0</td>
      <td>2.45e+10</td>
      <td>Greater Govans</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1134</td>
      <td>146</td>
      <td>29</td>
      <td>73</td>
      <td>80</td>
      <td>41</td>
      <td>91</td>
      <td>49</td>
      <td>75</td>
      <td>81</td>
      <td>170</td>
      <td>57</td>
      <td>162</td>
      <td>63</td>
      <td>11</td>
      <td>6</td>
      <td>0</td>
      <td>24</td>
      <td>510</td>
      <td>260402.0</td>
      <td>2.45e+10</td>
      <td>Claremont/Armistead</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2276</td>
      <td>69</td>
      <td>43</td>
      <td>41</td>
      <td>22</td>
      <td>46</td>
      <td>67</td>
      <td>0</td>
      <td>30</td>
      <td>30</td>
      <td>80</td>
      <td>146</td>
      <td>321</td>
      <td>216</td>
      <td>139</td>
      <td>261</td>
      <td>765</td>
      <td>24</td>
      <td>510</td>
      <td>271200.0</td>
      <td>2.45e+10</td>
      <td>North Baltimore/...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>961</td>
      <td>111</td>
      <td>108</td>
      <td>61</td>
      <td>42</td>
      <td>56</td>
      <td>37</td>
      <td>73</td>
      <td>30</td>
      <td>31</td>
      <td>106</td>
      <td>119</td>
      <td>74</td>
      <td>23</td>
      <td>27</td>
      <td>24</td>
      <td>39</td>
      <td>24</td>
      <td>510</td>
      <td>280404.0</td>
      <td>2.45e+10</td>
      <td>Allendale/Irving...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1669</td>
      <td>158</td>
      <td>124</td>
      <td>72</td>
      <td>48</td>
      <td>108</td>
      <td>68</td>
      <td>121</td>
      <td>137</td>
      <td>99</td>
      <td>109</td>
      <td>191</td>
      <td>160</td>
      <td>141</td>
      <td>28</td>
      <td>88</td>
      <td>17</td>
      <td>24</td>
      <td>510</td>
      <td>90100.0</td>
      <td>2.45e+10</td>
      <td>Greater Govans</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, our Census data will now have a CSA appended to it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the new Filename to save the data to (&#39;acs_csa_merge_test&#39;: &quot;</span> <span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outFile</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Please enter the new Filename to save the data to (&#39;acs_csa_merge_test&#39;: acs_csa_merge_test
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Final-Result">Final Result<a class="anchor-link" href="#Final-Result"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flag</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter a URL? If not ACS data will be used. (Y/N):  &quot;</span> <span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">flag</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the location of your Principal file: &quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">tract</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter tract id (*): &quot;</span> <span class="p">)</span>
  <span class="n">county</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter county id (510): &quot;</span> <span class="p">)</span>
  <span class="n">state</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter state id (24): &quot;</span> <span class="p">)</span>
  <span class="n">tableId</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter acs table id (B19001): &quot;</span> <span class="p">)</span> 
  <span class="n">year</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter acs year (18): &quot;</span> <span class="p">)</span>
  <span class="n">saveAcs</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Save ACS? (Y/N): &quot;</span> <span class="p">)</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Principal Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Crosswalk Example: CSA-to-Tract-2010.csv&#39;</span><span class="p">)</span>

<span class="n">crosswalk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the location of your crosswalk file: &quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Crosswalk Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">left_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Left on: &quot;</span> <span class="p">)</span>
<span class="n">right_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Right on: &quot;</span> <span class="p">)</span>
<span class="n">how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;How: (‘left’, ‘right’, ‘outer’, ‘inner’) &quot;</span> <span class="p">)</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">crosswalk</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Save the data</span>
<span class="c1"># Save the data</span>
<span class="n">saveFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Save File (&#39;Y&#39; or &#39;N&#39;): &quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">saveFile</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span> <span class="ow">or</span> <span class="n">saveFile</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
  <span class="n">outFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Saved Filename (Do not include the file extension ): &quot;</span><span class="p">)</span>
  <span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outFile</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Enter a URL? If not ACS data will be used. (Y/N):  n
Please enter tract id (*): *
Please enter county id (510): 510
Please enter state id (24): 24
Please enter acs table id (B19001): B19001
Please enter acs year (18): 18
Save ACS? (Y/N): N
Number of Columns 17
Principal Columns Index([&#39;B19001_001E_Total&#39;, &#39;B19001_002E_Total_Less_than_$10,000&#39;,
       &#39;B19001_003E_Total_$10,000_to_$14,999&#39;,
       &#39;B19001_004E_Total_$15,000_to_$19,999&#39;,
       &#39;B19001_005E_Total_$20,000_to_$24,999&#39;,
       &#39;B19001_006E_Total_$25,000_to_$29,999&#39;,
       &#39;B19001_007E_Total_$30,000_to_$34,999&#39;,
       &#39;B19001_008E_Total_$35,000_to_$39,999&#39;,
       &#39;B19001_009E_Total_$40,000_to_$44,999&#39;,
       &#39;B19001_010E_Total_$45,000_to_$49,999&#39;,
       &#39;B19001_011E_Total_$50,000_to_$59,999&#39;,
       &#39;B19001_012E_Total_$60,000_to_$74,999&#39;,
       &#39;B19001_013E_Total_$75,000_to_$99,999&#39;,
       &#39;B19001_014E_Total_$100,000_to_$124,999&#39;,
       &#39;B19001_015E_Total_$125,000_to_$149,999&#39;,
       &#39;B19001_016E_Total_$150,000_to_$199,999&#39;,
       &#39;B19001_017E_Total_$200,000_or_more&#39;, &#39;state&#39;, &#39;county&#39;, &#39;tract&#39;],
      dtype=&#39;object&#39;)
Crosswalk Example: CSA-to-Tract-2010.csv
Please enter the location of your crosswalk file: CSA-to-Tract-2010.csv
Crosswalk Columns Index([&#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)

Left on: tract
Right on: TRACTCE10
How: (‘left’, ‘right’, ‘outer’, ‘inner’) outer
Save File (&#39;Y&#39; or &#39;N&#39;): n
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10,000</th>
      <th>B19001_003E_Total_$10,000_to_$14,999</th>
      <th>B19001_004E_Total_$15,000_to_$19,999</th>
      <th>B19001_005E_Total_$20,000_to_$24,999</th>
      <th>B19001_006E_Total_$25,000_to_$29,999</th>
      <th>B19001_007E_Total_$30,000_to_$34,999</th>
      <th>B19001_008E_Total_$35,000_to_$39,999</th>
      <th>B19001_009E_Total_$40,000_to_$44,999</th>
      <th>B19001_010E_Total_$45,000_to_$49,999</th>
      <th>B19001_011E_Total_$50,000_to_$59,999</th>
      <th>B19001_012E_Total_$60,000_to_$74,999</th>
      <th>B19001_013E_Total_$75,000_to_$99,999</th>
      <th>B19001_014E_Total_$100,000_to_$124,999</th>
      <th>B19001_015E_Total_$125,000_to_$149,999</th>
      <th>B19001_016E_Total_$150,000_to_$199,999</th>
      <th>B19001_017E_Total_$200,000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1842</td>
      <td>140</td>
      <td>71</td>
      <td>143</td>
      <td>112</td>
      <td>169</td>
      <td>101</td>
      <td>113</td>
      <td>116</td>
      <td>56</td>
      <td>147</td>
      <td>158</td>
      <td>151</td>
      <td>200</td>
      <td>8</td>
      <td>89</td>
      <td>68</td>
      <td>24</td>
      <td>510</td>
      <td>272004.0</td>
      <td>2.45e+10</td>
      <td>Cross-Country/Ch...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1638</td>
      <td>246</td>
      <td>71</td>
      <td>90</td>
      <td>104</td>
      <td>74</td>
      <td>168</td>
      <td>115</td>
      <td>97</td>
      <td>173</td>
      <td>115</td>
      <td>16</td>
      <td>117</td>
      <td>64</td>
      <td>0</td>
      <td>91</td>
      <td>97</td>
      <td>24</td>
      <td>510</td>
      <td>120202.0</td>
      <td>2.45e+10</td>
      <td>Greater Charles ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1252</td>
      <td>91</td>
      <td>27</td>
      <td>55</td>
      <td>75</td>
      <td>71</td>
      <td>59</td>
      <td>85</td>
      <td>44</td>
      <td>47</td>
      <td>80</td>
      <td>131</td>
      <td>108</td>
      <td>78</td>
      <td>43</td>
      <td>104</td>
      <td>154</td>
      <td>24</td>
      <td>510</td>
      <td>272005.0</td>
      <td>2.45e+10</td>
      <td>Cross-Country/Ch...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1622</td>
      <td>235</td>
      <td>177</td>
      <td>184</td>
      <td>79</td>
      <td>67</td>
      <td>88</td>
      <td>71</td>
      <td>64</td>
      <td>60</td>
      <td>72</td>
      <td>155</td>
      <td>140</td>
      <td>100</td>
      <td>77</td>
      <td>20</td>
      <td>33</td>
      <td>24</td>
      <td>510</td>
      <td>272006.0</td>
      <td>2.45e+10</td>
      <td>Glen-Fallstaff</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1775</td>
      <td>127</td>
      <td>70</td>
      <td>190</td>
      <td>136</td>
      <td>111</td>
      <td>114</td>
      <td>152</td>
      <td>106</td>
      <td>11</td>
      <td>172</td>
      <td>143</td>
      <td>193</td>
      <td>42</td>
      <td>86</td>
      <td>53</td>
      <td>69</td>
      <td>24</td>
      <td>510</td>
      <td>272007.0</td>
      <td>2.45e+10</td>
      <td>Glen-Fallstaff</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>196</th>
      <td>2143</td>
      <td>138</td>
      <td>37</td>
      <td>76</td>
      <td>33</td>
      <td>16</td>
      <td>30</td>
      <td>28</td>
      <td>17</td>
      <td>64</td>
      <td>111</td>
      <td>286</td>
      <td>181</td>
      <td>206</td>
      <td>100</td>
      <td>234</td>
      <td>586</td>
      <td>24</td>
      <td>510</td>
      <td>20300.0</td>
      <td>2.45e+10</td>
      <td>Fells Point</td>
    </tr>
    <tr>
      <th>197</th>
      <td>1220</td>
      <td>159</td>
      <td>93</td>
      <td>82</td>
      <td>137</td>
      <td>51</td>
      <td>79</td>
      <td>102</td>
      <td>79</td>
      <td>98</td>
      <td>55</td>
      <td>140</td>
      <td>85</td>
      <td>38</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>24</td>
      <td>510</td>
      <td>150400.0</td>
      <td>2.45e+10</td>
      <td>Greater Mondawmin</td>
    </tr>
    <tr>
      <th>198</th>
      <td>1393</td>
      <td>41</td>
      <td>12</td>
      <td>22</td>
      <td>0</td>
      <td>10</td>
      <td>11</td>
      <td>19</td>
      <td>85</td>
      <td>30</td>
      <td>95</td>
      <td>128</td>
      <td>200</td>
      <td>207</td>
      <td>240</td>
      <td>180</td>
      <td>113</td>
      <td>24</td>
      <td>510</td>
      <td>10200.0</td>
      <td>2.45e+10</td>
      <td>Patterson Park N...</td>
    </tr>
    <tr>
      <th>199</th>
      <td>761</td>
      <td>94</td>
      <td>39</td>
      <td>39</td>
      <td>53</td>
      <td>31</td>
      <td>20</td>
      <td>16</td>
      <td>33</td>
      <td>27</td>
      <td>49</td>
      <td>127</td>
      <td>50</td>
      <td>64</td>
      <td>22</td>
      <td>49</td>
      <td>48</td>
      <td>24</td>
      <td>510</td>
      <td>60400.0</td>
      <td>2.45e+10</td>
      <td>Oldtown/Middle East</td>
    </tr>
    <tr>
      <th>200</th>
      <td>238436</td>
      <td>27518</td>
      <td>15246</td>
      <td>13682</td>
      <td>11154</td>
      <td>11984</td>
      <td>12142</td>
      <td>10574</td>
      <td>10545</td>
      <td>8506</td>
      <td>19226</td>
      <td>20731</td>
      <td>25536</td>
      <td>17068</td>
      <td>10693</td>
      <td>11228</td>
      <td>12603</td>
      <td>24</td>
      <td>510</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>201 rows × 22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Advanced">Advanced<a class="anchor-link" href="#Advanced"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this next example to work, we will need to import hypothetical csv files</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Intro</strong></p>
<p>The following Python function is a bulked out version of the previous notes.</p>
<ul>
<li>It contains everything from the tutorial plus more.</li>
<li>It can be imported and used in future projects or stand alone.</li>
</ul>
<p><strong>Description:</strong> add columns of data from a foreign dataset into a primary dataset along set parameters.</p>
<p><strong>Purpose:</strong> Makes Merging datasets simple</p>
<p><strong>Services</strong></p>
<ul>
<li>Merge two datasets without a crosswalk</li>
<li>Merge two datasets with a crosswalk</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mergeDatasets" class="doc_header"><code>mergeDatasets</code><a href="https://github.com/karpatic/dataplay/tree/master/dataplay/merge.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mergeDatasets</code>(<strong><code>left_ds</code></strong>=<em><code>False</code></em>, <strong><code>right_ds</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_ds</code></strong>=<em><code>False</code></em>, <strong><code>left_col</code></strong>=<em><code>False</code></em>, <strong><code>right_col</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_left_col</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_right_col</code></strong>=<em><code>False</code></em>, <strong><code>merge_how</code></strong>=<em><code>False</code></em>, <strong><code>interactive</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Function-Explanation">Function Explanation<a class="anchor-link" href="#Function-Explanation"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Input(s):</strong></p>
<ul>
<li>Dataset url</li>
<li>Crosswalk Url </li>
<li>Right On </li>
<li>Left On </li>
<li>How </li>
<li>New Filename </li>
</ul>
<p><strong>Output:</strong> File</p>
<p><strong>How it works:</strong></p>
<ul>
<li>Read in datasets</li>
<li><p>Perform Merge</p>
</li>
<li><p>If the 'how' parameter is equal to ['left', 'right', 'outer', 'inner']</p>
</li>
<li><ul>
<li>then a merge will be performed. </li>
</ul>
</li>
<li>If a column name is provided in the 'how' parameter</li>
<li><ul>
<li>then that single column will be pulled from the right dataset as a new column in the left_ds.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-Diagrams">Function Diagrams<a class="anchor-link" href="#Function-Diagrams"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Diagram the mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://bniajfi.org/images/mermaid/class_diagram_merge_datasets.PNG&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://bniajfi.org/images/mermaid/class_diagram_merge_datasets.PNG">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>mergeDatasets Flow Chart</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://bniajfi.org/images/mermaid/flow_chart_merge_datasets.PNG&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://bniajfi.org/images/mermaid/flow_chart_merge_datasets.PNG">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gannt Chart  mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://bniajfi.org/images/mermaid/gannt_chart_merge_datasets.PNG&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://bniajfi.org/images/mermaid/gannt_chart_merge_datasets.PNG">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sequence Diagram  mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://bniajfi.org/images/mermaid/sequence_diagram_merge_datasets.PNG&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://bniajfi.org/images/mermaid/sequence_diagram_merge_datasets.PNG">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-Examples">Function Examples<a class="anchor-link" href="#Function-Examples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Interactive-Example-1">Interactive Example 1<a class="anchor-link" href="#Interactive-Example-1"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">dataplay.geoms</span> <span class="kn">import</span> <span class="n">readInGeometryData</span> 
<span class="n">Hhchpov</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/1/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson&quot;</span><span class="p">)</span>
<span class="n">Hhchpov</span> <span class="o">=</span> <span class="n">Hhchpov</span><span class="p">[[</span><span class="s1">&#39;CSA2010&#39;</span><span class="p">,</span> <span class="s1">&#39;hhchpov15&#39;</span><span class="p">,</span>	<span class="s1">&#39;hhchpov16&#39;</span><span class="p">,</span>	<span class="s1">&#39;hhchpov17&#39;</span><span class="p">,</span>	<span class="s1">&#39;hhchpov18&#39;</span><span class="p">]]</span>
<span class="n">Hhchpov</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;Hhchpov.csv&#39;</span><span class="p">)</span>

<span class="n">Hhpov</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhpov/FeatureServer/1/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson&quot;</span><span class="p">)</span>
<span class="n">Hhpov</span> <span class="o">=</span> <span class="n">Hhpov</span><span class="p">[[</span><span class="s1">&#39;CSA2010&#39;</span><span class="p">,</span> <span class="s1">&#39;hhpov15&#39;</span><span class="p">,</span>	<span class="s1">&#39;hhpov16&#39;</span><span class="p">,</span>	<span class="s1">&#39;hhpov17&#39;</span><span class="p">,</span>	<span class="s1">&#39;hhpov18&#39;</span><span class="p">]]</span>
<span class="n">Hhpov</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;Hhpov.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Hhchpov</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CSA2010</th>
      <th>hhchpov15</th>
      <th>hhchpov16</th>
      <th>hhchpov17</th>
      <th>hhchpov18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Allendale/Irving...</td>
      <td>38.93</td>
      <td>34.73</td>
      <td>32.77</td>
      <td>35.27</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Hhpov</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CSA2010</th>
      <th>hhpov15</th>
      <th>hhpov16</th>
      <th>hhpov17</th>
      <th>hhpov18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Allendale/Irving...</td>
      <td>24.15</td>
      <td>21.28</td>
      <td>20.7</td>
      <td>23.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ls</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>24510_B19001_5y18_est.csv           CSA-to-Tract-2010.csv  <span class="ansi-blue-intense-fg ansi-bold">sample_data</span>/
24510_B19001_5y18_est_Original.csv  Hhchpov.csv
acs_csa_merge_test.csv              Hhpov.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="c1"># Table: FDIC Baltimore Banks</span>
<span class="c1"># Columns: Bank Name, Address(es), Census Tract</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s1">&#39;Hhpov.csv&#39;</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;CSA2010&#39;</span>

<span class="c1"># Table: Crosswalk Census Communities</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;Hhchpov.csv&#39;</span>
<span class="n">right_col</span><span class="o">=</span><span class="s1">&#39;CSA2010&#39;</span>

<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span><span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span>
                  <span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">merge_how</span><span class="o">=</span><span class="n">merge_how</span><span class="p">,</span> <span class="c1"># left right or columnname to retrieve</span>
                  <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 Loading Left Dataset
getData :  Hhpov.csv

 Loading Right Dataset
getData :  Hhchpov.csv

 Validating the merge_how Parameter

 Import a crosswalk? (&#39;True&#39;/&#39;False&#39;) False

 coerceForMerge: Left-Right
cols :  CSA2010 CSA2010
BEFORE COERCE :  object object
AFTER COERCE object object CSA2010
PERFORMING MERGE : LEFT-&gt;RIGHT
first_col :  CSA2010 object
how:  outer
second_col :  CSA2010 object
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>CSA2010</th>
      <th>hhpov15</th>
      <th>hhpov16</th>
      <th>hhpov17</th>
      <th>hhpov18</th>
      <th>Unnamed: 0_y</th>
      <th>hhchpov15</th>
      <th>hhchpov16</th>
      <th>hhchpov17</th>
      <th>hhchpov18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Allendale/Irving...</td>
      <td>24.15</td>
      <td>21.28</td>
      <td>20.70</td>
      <td>23.00</td>
      <td>0</td>
      <td>38.93</td>
      <td>34.73</td>
      <td>32.77</td>
      <td>35.27</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Beechfield/Ten H...</td>
      <td>11.17</td>
      <td>11.59</td>
      <td>10.47</td>
      <td>10.90</td>
      <td>1</td>
      <td>19.42</td>
      <td>21.22</td>
      <td>23.92</td>
      <td>21.90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Belair-Edison</td>
      <td>18.61</td>
      <td>19.59</td>
      <td>20.27</td>
      <td>22.83</td>
      <td>2</td>
      <td>36.88</td>
      <td>36.13</td>
      <td>34.56</td>
      <td>39.74</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Brooklyn/Curtis ...</td>
      <td>28.36</td>
      <td>26.33</td>
      <td>24.21</td>
      <td>21.54</td>
      <td>3</td>
      <td>45.01</td>
      <td>46.45</td>
      <td>46.41</td>
      <td>39.89</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Canton</td>
      <td>3.00</td>
      <td>2.26</td>
      <td>3.66</td>
      <td>2.05</td>
      <td>4</td>
      <td>5.49</td>
      <td>2.99</td>
      <td>4.02</td>
      <td>4.61</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ls</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>24510_B19001_5y18_est.csv           CSA-to-Tract-2010.csv  <span class="ansi-blue-intense-fg ansi-bold">sample_data</span>/
24510_B19001_5y18_est_Original.csv  Hhchpov.csv
acs_csa_merge_test.csv              Hhpov.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-2-)-Get-CSA-and-Geometry-with-a-Crosswalk-using-3-links">Example 2 ) Get CSA and Geometry with a Crosswalk using 3 links<a class="anchor-link" href="#Example-2-)-Get-CSA-and-Geometry-with-a-Crosswalk-using-3-links"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Description: I created a public dataset from a google xlsx sheet &#39;Bank Addresses and Census Tract&#39; from a workbook of the same name.</span>
<span class="c1"># Table: FDIC Baltimore Banks</span>
<span class="c1"># Columns: Bank Name, Address(es), Census Tract</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s1">&#39;https28768&amp;single=true&amp;output=csv&#39;</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;Census Tract&#39;</span>

<span class="c1"># Alternate Primary Table</span>
<span class="c1"># Description: Same workbook, different Sheet: &#39;Branches per tract&#39; </span>
<span class="c1"># Columns: Census Tract, Number branches per tract</span>
<span class="c1"># left_ds = &#39;https://docssingle=true&amp;output=csv&#39;</span>
<span class="c1"># lef_col = &#39;Number branches per tract&#39;</span>

<span class="c1"># Crosswalk Table</span>
<span class="c1"># Table: Crosswalk Census Communities</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">crosswalk_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.goot=csv&#39;</span>
<span class="n">use_crosswalk</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="s1">&#39;TRACT2010&#39;</span>
<span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="s1">&#39;GEOID2010&#39;</span>

<span class="c1"># Secondary Table</span>
<span class="c1"># Table: Baltimore Boundaries</span>
<span class="c1"># &#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA&#39;, &#39;NAME10&#39;, &#39;Tract&#39;, &#39;geometry&#39;</span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;httpse=true&amp;output=csv&#39;</span>
<span class="n">right_col</span> <span class="o">=</span><span class="s1">&#39;GEOID10&#39;</span>

<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;geometry&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>

<span class="n">merged_df_geom</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span><span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span>
                  <span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">merge_how</span><span class="o">=</span><span class="n">merge_how</span><span class="p">,</span> <span class="c1"># left right or columnname to retrieve</span>
                  <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">merged_df_geom</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we can save the data so that it may be used in later tutorials.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;test_save_data_with_geom_and_csa&#39;</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">string</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-3:-Ran-Alone">Example 3: Ran Alone<a class="anchor-link" href="#Example-3:-Ran-Alone"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergeDatasets</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

