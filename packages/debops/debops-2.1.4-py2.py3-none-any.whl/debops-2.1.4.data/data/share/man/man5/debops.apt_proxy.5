.\" Man page generated from reStructuredText.
.
.TH "DEBOPS.APT_PROXY" "5" "Mar 03, 2021" "v2.1.4" "DebOps"
.SH NAME
debops.apt_proxy \- Manage HTTP/HTTPS/FTP proxy for APT with Ansible
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.sp
\fBdebops service/apt_proxy\fP [\fB\-\-limit\fP \fIgroup,host,\fP\&...] [\fB\-\-diff\fP] [\fB\-\-check\fP] [\fB\-\-tags\fP \fItag1,tag2,\fP\&...] [\fB\-\-skip\-tags\fP \fItag1,tag2,\fP\&...] [<\fBansible\-playbook\fP options>] ...
.SH DESCRIPTION
.sp
This role manages the HTTP/HTTPS/FTP proxy configuration for APT. You can
define what proxy to use, what hosts should be connected to directly, as well
as set additional APT configuration options related to proxies as needed.
.sp
The role also features proxy online detection support to silently
skip/ignore temporally offline proxies which can make sense for
workstations and home servers.
.SH GETTING STARTED
.SS Default configuration
.sp
The role will enable APT proxy support automatically if \fBhttp_proxy\fP,
\fBhttps_proxy\fP or \fBftp_proxy\fP environment variables are set on a given host.
They can be configured using the debops.environment Ansible role.
.sp
Unfortunately using the above environment variables directly through \fBsudo\fP
is problematic. To mitigate that, you can use the \fBinventory__*_environment\fP
variables configured in the playbook to provide the correct variables to the
role. See the \fBdebops\-playbooks\fP documentation for more details.
.SS Example inventory
.sp
The \fBdebops.apt_proxy\fP role is included by default in the \fBcommon.yml\fP
DebOps playbook, you don\(aqt need to add hosts to any groups to enable it.
.SS Example playbook
.sp
If you are using this role without DebOps, here\(aqs an example Ansible playbook
that uses the \fBdebops.apt_proxy\fP role:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
\-\-\-

\- name: Configure APT proxy
  collections: [ \(aqdebops.debops\(aq, \(aqdebops.roles01\(aq,
                 \(aqdebops.roles02\(aq, \(aqdebops.roles03\(aq ]
  hosts: [ \(aqdebops_all_hosts\(aq, \(aqdebops_service_apt_proxy\(aq ]
  become: True

  environment: \(aq{{ inventory__environment | d({})
                   | combine(inventory__group_environment | d({}))
                   | combine(inventory__host_environment  | d({})) }}\(aq

  roles:

    \- role: apt_proxy
      tags: [ \(aqrole::apt_proxy\(aq, \(aqskip::apt_proxy\(aq ]

.ft P
.fi
.UNINDENT
.UNINDENT
.SS Ansible tags
.sp
You can use Ansible \fB\-\-tags\fP or \fB\-\-skip\-tags\fP parameters to limit what
tasks are performed during Ansible run. This can be used after a host was first
configured to speed up playbook execution, when you are sure that most of the
configuration is already in the desired state.
.sp
Available role tags:
.INDENT 0.0
.TP
.B \fBrole::apt_proxy\fP
Main role tag, should be used in the playbook to execute all tasks.
.UNINDENT
.SH AUTHOR
Maciej Delmanowski, Robin Schneider
.SH COPYRIGHT
2014-2021, Maciej Delmanowski, Nick Janetakis, Robin Schneider and others
.\" Generated by docutils manpage writer.
.
