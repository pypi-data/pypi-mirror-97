{% load cfdi_tags %}
<detallista:detallista 
    {% for xmlns in complemento.xmlns_list %}
        {{ xmlns|safe }}
    {% endfor %}
    type="SimpleInvoiceType" 
    contentVersion="1.3.1" 
    documentStructureVersion="AMC8.1" 
    documentStatus="{{ complemento.documentStatus }}" 
    > 

    <detallista:requestForPaymentIdentification>
        <detallista:entityType>{{ complemento.entityType }}</detallista:entityType>
    </detallista:requestForPaymentIdentification> 

    <detallista:specialInstruction code="{{ complemento.code }}">
        <detallista:text>{{ complemento.cantidad_letra }}</detallista:text>
    </detallista:specialInstruction>

    <detallista:orderIdentification>
        <detallista:referenceIdentification type="ON">{{ complemento.referenceIdentification }}</detallista:referenceIdentification>
        <detallista:ReferenceDate>{{ complemento.fecha_oc }}</detallista:ReferenceDate>
    </detallista:orderIdentification>

    <detallista:AdditionalInformation>
        <detallista:referenceIdentification type="ACE">1</detallista:referenceIdentification>
    </detallista:AdditionalInformation>

    <detallista:DeliveryNote>
        <detallista:referenceIdentification>{{ complemento.deliveryNote }}</detallista:referenceIdentification>
        <detallista:ReferenceDate>{{ complemento.fecha_referencia }}</detallista:ReferenceDate>
    </detallista:DeliveryNote>

    <detallista:buyer>
        <detallista:gln>{{ complemento.buyerGLN }}</detallista:gln>
        <detallista:contactInformation>
            <detallista:personOrDepartmentName>
                <detallista:text>{{ complemento.personDepartament }}</detallista:text>
            </detallista:personOrDepartmentName>
        </detallista:contactInformation>
    </detallista:buyer> 
                
    <detallista:seller>
        <detallista:gln>{{ complemento.sellerGLN|stringformat:"013d" }}</detallista:gln>
        <detallista:alternatePartyIdentification type="SELLER_ASSIGNED_IDENTIFIER_FOR_A_PARTY">{{ complemento.sellerGLN }}</detallista:alternatePartyIdentification>
    </detallista:seller>

    <detallista:allowanceCharge allowanceChargeType="ALLOWANCE_GLOBAL" settlementType="OFF_INVOICE">
        <detallista:specialServicesType>AJ</detallista:specialServicesType>
        <detallista:monetaryAmountOrPercentage>
            <detallista:rate base="INVOICE_VALUE">
                <detallista:percentage>0</detallista:percentage>
            </detallista:rate>
        </detallista:monetaryAmountOrPercentage>
    </detallista:allowanceCharge>
    <detallista:lineItem number="1">
        <detallista:tradeItemIdentification>
            <detallista:gtin>2050081295008</detallista:gtin>
        </detallista:tradeItemIdentification>
        <detallista:alternateTradeItemIdentification type="BUYER_ASSIGNED">2050081295008</detallista:alternateTradeItemIdentification>
        <detallista:tradeItemDescriptionInformation language="ES">
            <detallista:longText>IREEMO 2 BLANCO</detallista:longText>
        </detallista:tradeItemDescriptionInformation>
        <detallista:invoicedQuantity unitOfMeasure="PIEZA">252</detallista:invoicedQuantity>
        <detallista:grossPrice>
            <detallista:Amount>782.145</detallista:Amount>
        </detallista:grossPrice>
        <detallista:netPrice>
            <detallista:Amount>782.145</detallista:Amount>
        </detallista:netPrice>
        <detallista:totalLineAmount>
            <detallista:grossAmount>
                <detallista:Amount>197100.540</detallista:Amount>
            </detallista:grossAmount>
            <detallista:netAmount>
                <detallista:Amount>197100.540</detallista:Amount>
            </detallista:netAmount>
        </detallista:totalLineAmount>
    </detallista:lineItem>
    <detallista:totalAmount>
        <detallista:Amount>228636.63</detallista:Amount>
    </detallista:totalAmount>
    <detallista:TotalAllowanceCharge allowanceOrChargeType="ALLOWANCE">
        <detallista:specialServicesType>AA</detallista:specialServicesType>
        <detallista:Amount>0</detallista:Amount>
    </detallista:TotalAllowanceCharge>
</detallista:detallista>