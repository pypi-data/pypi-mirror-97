{% load cfdi_tags %}
<pago10:Pagos 
    Version="1.0"
    >
    {% for pago in complemento.pagos %}
        <pago10:Pago 
            FechaPago="{{ pago.FechaPago|iso_date:complemento.timezone }}"
            FormaDePagoP="{{ pago.FormaDePagoP }}"
            MonedaP="{{ pago.MonedaP }}"
            Monto="{{ pago.Monto }}"
            
            {% if pago.MonedaP != "MXN" and pago.TipoCambioP %}
                TipoCambioP="{{ pago.TipoCambioP }}" 
            {% endif %}
        
            {% set_field 'NumOperacion' pago.NumOperacion %}
            {% set_field 'NomBancoOrdExt' pago.NomBancoOrdExt %}
            {% set_field 'CtaOrdenante' pago.CtaOrdenante %}
            {% set_field 'RfcEmisorCtaOrd' pago.RfcEmisorCtaOrd %}
            {% set_field 'RfcEmisorCtaBen' pago.RfcEmisorCtaBen %}
            {% set_field 'CtaBeneficiario' pago.CtaBeneficiario %}
            {% set_field 'TipoCadPago' pago.TipoCadPago %}
            {% set_field 'CertPago' pago.CertPago %}
            {% set_field 'CadPago' pago.CadPago %}
            {% set_field 'SelloPago' pago.SelloPago %}
            >

            {% for docto in pago.DoctoRelacionado_set %}
                <pago10:DoctoRelacionado 
                    IdDocumento="{{ docto.IdDocumento }}" 
                    {% set_field 'Serie' docto.Serie %}
                    {% set_field 'Folio' docto.Folio %}
                    {% set_field 'MonedaDR' docto.MonedaDR %}
                    {% set_field 'TipoCambioDR' docto.TipoCambioDR %}
                    MetodoDePagoDR="{{ docto.MetodoDePagoDR }}"
                    NumParcialidad="{{ docto.NumParcialidad }}"
                    ImpSaldoAnt="{{ docto.ImpSaldoAnt }}"
                    ImpPagado="{{ docto.ImpPagado }}"
                    ImpSaldoInsoluto="{{ docto.ImpSaldoInsoluto }}"
                    />
            {% endfor %}
        </pago10:Pago>
    {% endfor %}
</pago10:Pagos>