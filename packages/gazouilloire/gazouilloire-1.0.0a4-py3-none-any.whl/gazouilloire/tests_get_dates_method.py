from gazouilloire.tweets import get_dates
from pytz import timezone

locale = timezone("Europe/Paris")
field = "user_created_at"
t = {'_id': '1331225442305490947', 'local_time': '2020-11-24T14:17:33', 'timestamp_utc': 1606220253, 'text': "Biden will likely have to reimagine the future of U.S. economic leadership in Asia, says expert - CNBC: * Biden will likely have to reimagine the future of U.S. economic leadership in Asia, says expert\xa0\xa0CNBC * Opinion | Trump's policies separated this… http://dlvr.it/RmKYr3", 'url': 'https://twitter.com/WausauWisconsi/statuses/1331225442305490947', 'quoted_id': None, 'quoted_user': None, 'quoted_user_id': None, 'quoted_timestamp_utc': None, 'retweeted_id': None, 'retweeted_user': None, 'retweeted_user_id': None, 'retweeted_timestamp_utc': None, 'media_files': [], 'media_urls': [], 'links': ['http://dlvr.it/RmKYr3'], 'links_to_resolve': True, 'hashtags': [], 'mentioned_ids': [], 'mentioned_names': [], 'collection_time': '2020-11-24T14:25:49.723988', 'collected_via': ['search'], 'match_query': True, 'to_tweetid': None, 'to_username': None, 'to_userid': None, 'lang': 'en', 'coordinates': None, 'possibly_sensitive': False, 'retweet_count': 0, 'like_count': 0, 'user_id': '1156254228', 'user_screen_name': 'WausauWisconsi', 'user_name': 'Wausau Wisconsin', 'user_friends': 4, 'user_followers': 308, 'user_location': '', 'user_verified': False, 'user_description': '', 'user_created_at': 'Thu Feb 07 06:43:33 +0000 2013', 'user_tweets': 34891, 'user_likes': 0, 'user_lists': 8, 'user_image': 'https://pbs.twimg.com/profile_images/3558582720/b68089cd4178127f1f22af9b3e5e9529_normal.jpeg', 'user_url': None}

user_timestamp_utc, user_local_time = get_dates(t, locale, field)

assert user_timestamp_utc == 1360215813
assert user_local_time == '2013-02-07T07:43:33'


locale = timezone("Europe/Paris")
field = "created_at"
t = {'created_at': 'Tue Nov 24 12:24:06 +0000 2020', 'id': 1331211992175095811, 'id_str': '1331211992175095811', 'full_text': '"Giuliani admits to exaggerating claims of fraud after saying Detroit had more voters than citizens" Let me fix this: Giuliani admits to lying as a co-conspirator in Trump\'s coup attempt https://t.co/qe1KldUn3S via @Yahoo', 'truncated': False, 'display_text_range': [0, 221], 'entities': {'hashtags': [], 'symbols': [], 'user_mentions': [{'screen_name': 'Yahoo', 'name': 'Yahoo', 'id': 19380829, 'id_str': '19380829', 'indices': [215, 221]}], 'urls': [{'url': 'https://t.co/qe1KldUn3S', 'expanded_url': 'https://www.yahoo.com/entertainment/giuliani-admits-exaggerating-claims-voter-fraud-saying-detroit-more-voters-than-citizens-070252221.html?soc_src=social-sh&soc_trk=tw&tsrc=twtr', 'display_url': 'yahoo.com/entertainment/…', 'indices': [187, 210]}]}, 'metadata': {'iso_language_code': 'en', 'result_type': 'recent'}, 'source': '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'in_reply_to_status_id': None, 'in_reply_to_status_id_str': None, 'in_reply_to_user_id': None, 'in_reply_to_user_id_str': None, 'in_reply_to_screen_name': None, 'user': {'id': 18320938, 'id_str': '18320938', 'name': '(((DeanObeidallah)))', 'screen_name': 'DeanObeidallah', 'location': '', 'description': 'Host: The Dean Obeidallah show @SXMProgress channel 127 6-9PMET. Lawyer. Columnist: @thedailybeast @CNNOpinion Host: @Salon', 'url': 'https://t.co/YUuEZVGY8N', 'entities': {'url': {'urls': [{'url': 'https://t.co/YUuEZVGY8N', 'expanded_url': 'http://www.deanofradio.com', 'display_url': 'deanofradio.com', 'indices': [0, 23]}]}, 'description': {'urls': []}}, 'protected': False, 'followers_count': 112041, 'friends_count': 8338, 'listed_count': 1462, 'created_at': 'Mon Dec 22 23:46:14 +0000 2008', 'favourites_count': 68581, 'utc_offset': None, 'time_zone': None, 'geo_enabled': False, 'verified': True, 'statuses_count': 157640, 'lang': None, 'contributors_enabled': False, 'is_translator': False, 'is_translation_enabled': False, 'profile_background_color': '0099B9', 'profile_background_image_url': 'http://abs.twimg.com/images/themes/theme1/bg.png', 'profile_background_image_url_https': 'https://abs.twimg.com/images/themes/theme1/bg.png', 'profile_background_tile': True, 'profile_image_url': 'http://pbs.twimg.com/profile_images/1325872539906809856/DN_XD2MN_normal.jpg', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1325872539906809856/DN_XD2MN_normal.jpg', 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/18320938/1605037307', 'profile_link_color': '1B95E0', 'profile_sidebar_border_color': 'FFFFFF', 'profile_sidebar_fill_color': '95E8EC', 'profile_text_color': '3C3940', 'profile_use_background_image': True, 'has_extended_profile': False, 'default_profile': False, 'default_profile_image': False, 'following': False, 'follow_request_sent': False, 'notifications': False, 'translator_type': 'none'}, 'geo': None, 'coordinates': None, 'place': None, 'contributors': None, 'is_quote_status': False, 'retweet_count': 40, 'favorite_count': 189, 'favorited': False, 'retweeted': False, 'possibly_sensitive': False, 'lang': 'en', 'gazouilloire_source': 'retweet'}

timestamp_utc, local_time = get_dates(t, locale, field)

assert timestamp_utc == 1606217046
assert local_time == '2020-11-24T13:24:06'

locale = timezone("Australia/Adelaide")
field = "created_at"
t = {'created_at': 'Sun Nov 22 22:49:46 +0000 2020', 'id': 1330644671693983750, 'id_str': '1330644671693983750', 'full_text': 'What a train wreck\n\nOn left (Nov 22): \n\n"Sidney Powell...is not a member of the Trump Legal Team"\n\nOn right (Nov 14):\n\nTrump: "Giuliani...Sidney Powell, and Jenna Ellis, a truly great team, added to our other wonderful lawyers"\n\nI guess it turns on what the meaning of "is" is. https://t.co/PbXawZ3xRa', 'truncated': False, 'display_text_range': [0, 277], 'entities': {'hashtags': [], 'symbols': [], 'user_mentions': [], 'urls': [], 'media': [{'id': 1330643017649319941, 'id_str': '1330643017649319941', 'indices': [278, 301], 'media_url': 'http://pbs.twimg.com/media/EndkxkXXcAUVTdA.jpg', 'media_url_https': 'https://pbs.twimg.com/media/EndkxkXXcAUVTdA.jpg', 'url': 'https://t.co/PbXawZ3xRa', 'display_url': 'pic.twitter.com/PbXawZ3xRa', 'expanded_url': 'https://twitter.com/rgoodlaw/status/1330644671693983750/photo/1', 'type': 'photo', 'sizes': {'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}, 'small': {'w': 548, 'h': 680, 'resize': 'fit'}, 'medium': {'w': 812, 'h': 1007, 'resize': 'fit'}, 'large': {'w': 812, 'h': 1007, 'resize': 'fit'}}}]}, 'extended_entities': {'media': [{'id': 1330643017649319941, 'id_str': '1330643017649319941', 'indices': [278, 301], 'media_url': 'http://pbs.twimg.com/media/EndkxkXXcAUVTdA.jpg', 'media_url_https': 'https://pbs.twimg.com/media/EndkxkXXcAUVTdA.jpg', 'url': 'https://t.co/PbXawZ3xRa', 'display_url': 'pic.twitter.com/PbXawZ3xRa', 'expanded_url': 'https://twitter.com/rgoodlaw/status/1330644671693983750/photo/1', 'type': 'photo', 'sizes': {'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}, 'small': {'w': 548, 'h': 680, 'resize': 'fit'}, 'medium': {'w': 812, 'h': 1007, 'resize': 'fit'}, 'large': {'w': 812, 'h': 1007, 'resize': 'fit'}}}, {'id': 1330643384785117184, 'id_str': '1330643384785117184', 'indices': [278, 301], 'media_url': 'http://pbs.twimg.com/media/EndlG8DXIAA67m_.png', 'media_url_https': 'https://pbs.twimg.com/media/EndlG8DXIAA67m_.png', 'url': 'https://t.co/PbXawZ3xRa', 'display_url': 'pic.twitter.com/PbXawZ3xRa', 'expanded_url': 'https://twitter.com/rgoodlaw/status/1330644671693983750/photo/1', 'type': 'photo', 'sizes': {'large': {'w': 844, 'h': 428, 'resize': 'fit'}, 'small': {'w': 680, 'h': 345, 'resize': 'fit'}, 'medium': {'w': 844, 'h': 428, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}}]}, 'metadata': {'iso_language_code': 'en', 'result_type': 'recent'}, 'source': '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'in_reply_to_status_id': None, 'in_reply_to_status_id_str': None, 'in_reply_to_user_id': None, 'in_reply_to_user_id_str': None, 'in_reply_to_screen_name': None, 'user': {'id': 1171109054, 'id_str': '1171109054', 'name': 'Ryan Goodman', 'screen_name': 'rgoodlaw', 'location': 'New York, NY', 'description': 'Former Special Counsel @DeptofDefense. Co-editor-in-chief @just_security. Chaired Professor NYU Law. Former Chaired Professor Harvard Law. Co-director @RCLS_NYU', 'url': 'https://t.co/p53NiAaTHG', 'entities': {'url': {'urls': [{'url': 'https://t.co/p53NiAaTHG', 'expanded_url': 'http://its.law.nyu.edu/facultyprofiles/index.cfm?fuseaction=profile.overview&personid=27772', 'display_url': 'its.law.nyu.edu/facultyprofile…', 'indices': [0, 23]}]}, 'description': {'urls': []}}, 'protected': False, 'followers_count': 134234, 'friends_count': 2207, 'listed_count': 1696, 'created_at': 'Tue Feb 12 06:31:09 +0000 2013', 'favourites_count': 11134, 'utc_offset': None, 'time_zone': None, 'geo_enabled': False, 'verified': True, 'statuses_count': 12732, 'lang': None, 'contributors_enabled': False, 'is_translator': False, 'is_translation_enabled': False, 'profile_background_color': 'C0DEED', 'profile_background_image_url': 'http://abs.twimg.com/images/themes/theme1/bg.png', 'profile_background_image_url_https': 'https://abs.twimg.com/images/themes/theme1/bg.png', 'profile_background_tile': False, 'profile_image_url': 'http://pbs.twimg.com/profile_images/925263985301221378/3HmQGOXm_normal.jpg', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/925263985301221378/3HmQGOXm_normal.jpg', 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/1171109054/1489355654', 'profile_link_color': '1DA1F2', 'profile_sidebar_border_color': 'C0DEED', 'profile_sidebar_fill_color': 'DDEEF6', 'profile_text_color': '333333', 'profile_use_background_image': True, 'has_extended_profile': True, 'default_profile': True, 'default_profile_image': False, 'following': None, 'follow_request_sent': None, 'notifications': None, 'translator_type': 'none'}, 'geo': None, 'coordinates': None, 'place': None, 'contributors': None, 'is_quote_status': False, 'retweet_count': 971, 'favorite_count': 4104, 'favorited': False, 'retweeted': False, 'possibly_sensitive': False, 'lang': 'en', 'gazouilloire_source': 'retweet'}

timestamp_utc, local_time = get_dates(t, locale, field)

assert timestamp_utc == 1606081786
assert local_time == '2020-11-23T09:19:46'