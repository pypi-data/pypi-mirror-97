var __awaiter=this&&this.__awaiter||function(t,e,i,n){function s(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,o){function a(t){try{l(n.next(t))}catch(e){o(e)}}function r(t){try{l(n["throw"](t))}catch(e){o(e)}}function l(t){t.done?i(t.value):s(t.value).then(a,r)}l((n=n.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,s,o,a;return a={next:r(0),throw:r(1),return:r(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function r(t){return function(e){return l([t,e])}}function l(a){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,s&&(o=a[0]&2?s["return"]:a[0]?s["throw"]||((o=s["return"])&&o.call(s),0):s.next)&&!(o=o.call(s,a[1])).done)return o;if(s=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:i.label++;return{value:a[1],done:false};case 5:i.label++;s=a[1];a=[0];continue;case 7:a=i.ops.pop();i.trys.pop();continue;default:if(!(o=i.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){i=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(a[0]===6&&i.label<o[1]){i.label=o[1];o=a;break}if(o&&i.label<o[2]){i.label=o[2];i.ops.push(a);break}if(o[2])i.ops.pop();i.trys.pop();continue}a=e.call(t,i)}catch(r){a=[6,r];s=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-6089d0c4.system.js","./p-f4e56c2a.system.js","./p-1c3f461e.system.js","./p-90ea9d99.system.js"],(function(t){"use strict";var e,i,n,s,o,a,r,l,c,u;return{setters:[function(t){e=t.r;i=t.c;n=t.h;s=t.g},function(t){o=t.E},function(t){a=t.f;r=t.a;l=t.b;c=t.r},function(t){u=t.w}],execute:function(){var d="limel-dialog{--dialog-heading-icon-background-color:#f49132}limel-dialog .ga-body{overflow:auto;min-height:-webkit-min-content;min-height:-moz-min-content;min-height:min-content;margin-top:1rem}limel-dialog .ga-top-bar{position:-webkit-sticky;position:sticky;top:0;height:5rem;background-color:#fff;z-index:4;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;z-index:9}@media (min-width: 1074px){limel-dialog{--dialog-width:65rem;--dialog-height:40rem}}@media (max-width: 1075px){limel-dialog{--dialog-width:55rem;--dialog-height:40rem}}@media (min-width: 1800px){limel-dialog{--dialog-width:70rem;--dialog-height:60rem}}limel-button{--lime-primary-color:#f49132}.logo-container{height:2.2rem;width:10rem;margin-bottom:1rem;cursor:pointer;-webkit-transition:width 0.5s;transition:width 0.5s;overflow:hidden}.logo-container.compact{width:2.8rem}.logo-container:hover{opacity:0.8}.logo-container .logo{height:2.2rem}.actionpad-container{width:100%}.getaccept-button{width:100%;display:-ms-flexbox;display:flex;-ms-flex-pack:start;justify-content:start;-ms-flex-align:center;align-items:center;padding:0.425rem 0.875rem 0.425rem 0.875rem;border:none;border-radius:2rem;cursor:pointer;-webkit-transition:background 0.8s;transition:background 0.8s;background-position:center;font-size:0.8rem;font-weight:bold;color:#444;background:#eee}.getaccept-button:focus{outline:0}.getaccept-button:hover{background:#f5f5f5 radial-gradient(circle, transparent 1%, #f5f5f5 1%) center/15000%}.getaccept-button:active{background-color:white;background-size:100%;-webkit-transition:background 0s;transition:background 0s}.getaccept-button img{height:2rem;-ms-flex:0;flex:0}.getaccept-button .button-text{margin-left:0.5rem;-ms-flex:2;flex:2;text-align:left}.getaccept-button .document-count{margin-left:auto;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.getaccept-button .document-count limel-icon{margin-right:0.3rem}workflow-progress-bar{position:absolute;top:1.5rem;left:4rem;right:4rem}";var m=t("lwc_getaccept_root",function(){function t(t){e(this,t);this.errorHandler=i(this,"errorHandler",7);this.isOpen=false;this.entities=[];this.activeView=o.login;this.errorMessage="";this.documents=[];this.isSending=false;this.openDialog=this.openDialog.bind(this);this.renderLayout=this.renderLayout.bind(this);this.loadInitialData=this.loadInitialData.bind(this);this.loadSentDocuments=this.loadSentDocuments.bind(this);this.showWorkflow=this.showWorkflow.bind(this)}t.prototype.componentWillLoad=function(){this.externalId=this.context.limetype+"_"+this.context.id;this.activeView=this.checkIfSessionExists?o.home:o.login;if(this.session){this.loadInitialData()}this.setDefaultDocumentData()};t.prototype.loadInitialData=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n;return __generator(this,(function(s){switch(s.label){case 0:this.loadSentDocuments();s.label=1;case 1:s.trys.push([1,3,,4]);return[4,a(this.platform,this.session)];case 2:t=s.sent(),e=t.user,i=t.entities;this.user=e;this.entities=i;return[3,4];case 3:n=s.sent();this.errorHandler.emit("Could not load user session. Try relogging");return[3,4];case 4:this.loadEntityDetails();return[2]}}))}))};t.prototype.loadEntityDetails=function(){return __awaiter(this,void 0,void 0,(function(){var t,e;return __generator(this,(function(i){switch(i.label){case 0:i.trys.push([0,2,,3]);return[4,r(this.platform,this.session)];case 1:t=i.sent().entity;this.session.entity_id=t.id;this.documentData.email_send_message=t.email_send_message!==""?t.email_send_message:t.default_email_send_message;this.documentData.email_send_subject=t.email_send_subject!==""?t.email_send_subject:t.default_email_send_subject;return[3,3];case 2:e=i.sent();this.errorHandler.emit("Could not load user session. Try relogging");return[3,3];case 3:return[2]}}))}))};t.prototype.render=function(){var t=this;return[n("limel-flex-container",{class:"actionpad-container"},n("button",{class:"getaccept-button",onClick:this.openDialog},n("img",{src:"getaccept/logos/logo_only"}),n("span",{class:"button-text"},"Send document"),this.renderDocumentCount(!!this.session))),n("limel-dialog",{open:this.isOpen,closingActions:{escapeKey:false,scrimClick:false},onClose:function(){t.isOpen=false}},n("div",{class:"ga-top-bar"},this.renderLogo(this.showWorkflow()),function(){if(t.activeView!==o.login){return[n("layout-menu",{activeView:t.activeView,isSending:t.isSending}),n("workflow-progress-bar",{isVisible:t.showWorkflow(),activeView:t.activeView})]}}()),n("div",{class:"ga-body"},this.renderLayout()),n("limel-button-group",{slot:"button"},n("limel-button",{label:"Cancel",onClick:function(){t.isOpen=false}})),n("error-message",{error:this.errorMessage}))]};t.prototype.renderDocumentCount=function(t){if(t){return n("span",{class:"document-count"},n("limel-icon",{name:"file",size:"small"}),n("span",null,this.documents.length))}return[]};t.prototype.renderLogo=function(t){var e=this;var i="logo-container "+(t?"compact":"");return n("div",{class:i},n("img",{onClick:function(){return e.activeView=o.home},src:"getaccept/logos/logo-inverted",class:"logo"}))};t.prototype.showWorkflow=function(){var t=this;if(this.isSending||this.isSealed){return false}return u.some((function(e){return e.currentView===t.activeView}))};t.prototype.renderLayout=function(){switch(this.activeView){case o.home:return n("layout-overview",{platform:this.platform,session:this.session,externalId:this.externalId,documents:this.documents});case o.login:return n("layout-login",{platform:this.platform});case o.selectFile:return n("layout-select-file",{platform:this.platform,session:this.session,context:this.context,selectedLimeDocument:this.limeDocument,selectedTemplate:this.template,customFields:this.templateFields});case o.recipient:return n("layout-select-recipient",{platform:this.platform,document:this.documentData});case o.settings:return n("layout-settings",{user:this.user,entities:this.entities,session:this.session,platform:this.platform});case o.help:return n("layout-help",null);case o.sendDocument:return n("layout-send-document",{document:this.documentData,limeDocument:this.limeDocument,template:this.template});case o.videoLibrary:return n("layout-video-library",{platform:this.platform,session:this.session});case o.documentDetail:return n("layout-document-details",{platform:this.platform,session:this.session,documentId:this.documentId});case o.documentValidation:return n("layout-validate-document",{platform:this.platform,session:this.session,document:this.documentData,limeDocument:this.limeDocument,template:this.template,fields:this.templateFields,isSealed:this.isSealed,isSending:this.isSending});default:return n("layout-overview",null)}};t.prototype.logout=function(){localStorage.removeItem("getaccept_session");this.documents=[];this.activeView=o.login};t.prototype.openDialog=function(){this.isOpen=true};t.prototype.loadSentDocuments=function(){return __awaiter(this,void 0,void 0,(function(){var t,e;return __generator(this,(function(i){switch(i.label){case 0:this.isLoadingDocuments=true;i.label=1;case 1:i.trys.push([1,3,,4]);t=this;return[4,l(this.platform,this.externalId,this.session)];case 2:t.documents=i.sent();return[3,4];case 3:e=i.sent();this.errorHandler.emit("Something went wrong while documents from GetAccept...");return[3,4];case 4:this.isLoadingDocuments=false;return[2]}}))}))};t.prototype.changeViewHandler=function(t){if(t.detail===o.logout){this.logout()}else if(this.isSealed){this.activeView=o.home;this.setDefaultDocumentData()}else{this.activeView=t.detail}};t.prototype.setTemplate=function(t){this.template=t.detail;this.documentData.name=t.detail.text;this.limeDocument=null;this.templateFields=[]};t.prototype.setLimeDocument=function(t){this.limeDocument=t.detail;this.template=null;this.templateFields=[]};t.prototype.setCustomFields=function(t){this.templateFields=t.detail};t.prototype.updateDocumentRecipientHandler=function(t){this.documentData.recipients=t.detail};t.prototype.documentTypeHandler=function(t){this.documentData.is_signing=t.detail};t.prototype.setSessionHandler=function(t){this.setSessionData(t.detail);this.activeView=o.home;this.loadInitialData()};t.prototype.setDocumentName=function(t){this.documentData=Object.assign(Object.assign({},this.documentData),{name:t.detail})};t.prototype.setDocumentValue=function(t){this.documentData=Object.assign(Object.assign({},this.documentData),{value:t.detail})};t.prototype.setDocumentSmartReminder=function(t){this.documentData.is_reminder_sending=t.detail};t.prototype.setDocumentIsSmsSending=function(t){this.documentData.is_sms_sending=t.detail};t.prototype.setDocumentEmailSubject=function(t){this.documentData.email_send_subject=t.detail};t.prototype.setDocumentEmailMessage=function(t){this.documentData.email_send_message=t.detail};t.prototype.validateDocumentHandler=function(){this.activeView=o.documentValidation};t.prototype.openDocumentDetails=function(t){this.activeView=o.documentDetail;this.documentId=t.detail.id};t.prototype.setDocumentVideo=function(t){this.documentData.video_id=t.detail;this.documentData.is_video=true};t.prototype.removeDocumentVideo=function(){this.documentData.video_id="";this.documentData.is_video=false};t.prototype.setIsSending=function(t){this.isSending=t.detail};t.prototype.documentCompleted=function(t){this.setDefaultDocumentData();this.loadEntityDetails();this.isSealed=t.detail;if(!this.isSealed){this.activeView=o.home}this.loadSentDocuments()};t.prototype.onError=function(t){var e=this;this.errorMessage=t.detail;setTimeout((function(){return e.errorMessage=""}),100)};Object.defineProperty(t.prototype,"checkIfSessionExists",{get:function(){var t=window.localStorage.getItem("getaccept_session");if(!!t){var e=JSON.parse(t);this.validateToken(e);this.session=e}return!!t},enumerable:false,configurable:true});t.prototype.validateToken=function(t){return __awaiter(this,void 0,void 0,(function(){var e,i,n,s,o;var a=this;return __generator(this,(function(r){switch(r.label){case 0:return[4,c(this.platform,t)];case 1:e=r.sent(),i=e.data,n=e.success;if(n){s=window.localStorage.getItem("getaccept_session");if(!!s){o=JSON.parse(s);o.expires_in=i.expires_in;o.access_token=i.access_token;this.setSessionData(o)}}else{this.errorMessage="Could not refresh token.";setTimeout((function(){return a.errorMessage=""}))}return[2,true]}}))}))};t.prototype.setSessionData=function(t){window.localStorage.setItem("getaccept_session",JSON.stringify(t));this.session=t};t.prototype.setDefaultDocumentData=function(){this.documentData={is_signing:false,name:"",recipients:[],template_id:"",custom_fields:[],is_reminder_sending:false,is_sms_sending:false,email_send_subject:"",email_send_message:"",video_id:"",is_video:false,external_id:this.externalId,value:0};this.templateFields=[];this.isSealed=false;this.template=null;this.limeDocument=null};Object.defineProperty(t.prototype,"element",{get:function(){return s(this)},enumerable:false,configurable:true});return t}());m.style=d}}}));