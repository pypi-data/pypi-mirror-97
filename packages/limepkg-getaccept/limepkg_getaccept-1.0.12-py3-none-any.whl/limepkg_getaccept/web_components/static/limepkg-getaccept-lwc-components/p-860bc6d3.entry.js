import{r as t,h as e,g as i,c as s}from"./p-d2227a7a.js";import{E as n}from"./p-e3f65935.js";import{c as a,d as l,e as o,g as r,h as c,P as h,s as d,u as m,i as u,j as p,k as g}from"./p-12e61077.js";import{w as f}from"./p-566c05d2.js";import{m as w,E as y}from"./p-5b23429f.js";const x=class{constructor(e){t(this,e),this.timeout=1e4,this.error="",this.message="",this.triggerSnackbar=this.triggerSnackbar.bind(this)}componentDidUpdate(){this.error&&(this.message=this.error,this.triggerSnackbar())}render(){return[e("limel-snackbar",{message:this.message,timeout:this.timeout,actionText:"Ok"})]}triggerSnackbar(){this.host.shadowRoot.querySelector("limel-snackbar").show()}get host(){return i(this)}},v=class{constructor(e){t(this,e),this.changeView=s(this,"changeView",7),this.documentData={},this.isLoading=!1,this.removeDocumentHandler=this.removeDocumentHandler.bind(this),this.openDocumentIntGetAcceptHandler=this.openDocumentIntGetAcceptHandler.bind(this)}componentWillLoad(){this.loadDocumentDetails()}render(){return[e("div",null,e("h3",null,"Document Details"),(()=>this.isLoading?e("ga-loader",null):e("div",{class:"document-details-container"},e("div",{class:"document-details-info"},e("ul",{class:"document-details-info-list"},e("li",null,e("span",{class:"document-detail-title"},"Document name:")," ",this.documentData.name),e("li",null,e("span",{class:"document-detail-title"},"Status:")," ",this.documentData.status),e("li",null,e("span",{class:"document-detail-title"},"Deal value:")," ",this.documentData.value),e("li",null,e("span",{class:"document-detail-title"},"Expiration date:")," ",this.documentData.expiration_date),e("li",null,e("span",{class:"document-detail-title"},"Send date:")," ",this.documentData.send_date)),e("div",{class:"document-details-action-buttons"},e("limel-button",{primary:!0,label:"Open in GetAccept",onClick:this.openDocumentIntGetAcceptHandler}),e("limel-button",{class:"document-details-action-button-remove",primary:!1,label:"Remove document",onClick:this.removeDocumentHandler}))),e("div",{class:"document-details-pages"},e("ul",null,this.documentData.pages.map(t=>e("document-page-info",{documentId:this.documentData.id,session:this.session,page:t,totalTime:this.totalPageViewTime}))))))())]}async loadDocumentDetails(){this.isLoading=!0;const t=await a(this.platform,this.session,this.documentId);this.documentData={id:t.id,name:t.name,page_count:t.page_count,status:t.status,value:t.value,expiration_date:w(t.expiration_date).format("YYYY-MM-DD"),send_date:this.getSendDate(t),pages:this.getDocumentPages(t)},this.totalPageViewTime=this.getTotalPageViewTime(t),this.isLoading=!1}getSendDate(t){return t.send_date&&w(t.send_date).format("YYYY-MM-DD")||""}getDocumentPages(t){return t.pages&&t.pages.map(t=>({page_id:t.page_id,thumb_url:t.thumb_url,page_time:t.page_time,order_num:t.order_num,page_num:t.page_num}))||[]}getTotalPageViewTime(t){return t.pages&&t.pages.reduce((t,e)=>t+e.page_time,0)||0}async removeDocumentHandler(){this.isLoading=!0;const t=await l(this.platform,this.session,this.documentId);this.isLoading=!1,t&&this.changeView.emit(n.home)}openDocumentIntGetAcceptHandler(){window.open(`https://app.getaccept.com/document/${this.documentData.status===y.draft?"edit":"view"}/${this.documentData.id}`,"_blank")}};v.style=".document-details-container{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;max-height:50vh;overflow:auto}.document-details-container .document-details-info-list{padding:0;margin:0;list-style-type:none}.document-details-container .document-details-info-list .document-detail-title{font-weight:bold}.document-details-container .document-details-action-buttons{margin-top:1rem}.document-details-container .document-details-action-buttons .document-details-action-button-remove{margin-left:1rem}@media (min-width: 1074px){.document-details-container .document-details-info{width:65%}.document-details-container .document-details-pages{width:33%}}@media (max-width: 1075px){.document-details-container .document-details-info{width:100%}.document-details-container .document-details-pages{width:100%}}limel-button{--lime-primary-color:#f49132}";const b=class{constructor(e){t(this,e)}render(){return[e("div",null,e("h3",null,"Help"),e("div",{class:"help-container"},e("div",{class:"help-support"},e("a",{class:"help-support-link",href:"https://www.getaccept.com/support"},"Have any questions or just looking for someone to talk to. Our support are always there for you"),e("ul",{class:"support-links-list"},e("li",null,e("limel-icon",{class:"support",name:"phone",size:"small"}),e("a",{href:"tel:+46406688158"},"+46 40-668-81-58")),e("li",null,e("limel-icon",{class:"support",name:"email",size:"small"}),e("a",{href:"mailto:support@getaccept.com"},"support@getaccept.com"))))))]}};b.style=".help-container{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.help-container .help-support{width:100%}.help-container .help-support .help-support-link{text-decoration:none;color:#212121}.help-container .help-support .support-links-list{list-style-type:none;padding:0;margin-top:1rem}.help-container .help-support .support-links-list li{display:-ms-flexbox;display:flex;margin-top:0.5rem}.help-container .help-support .support-links-list li a{text-decoration:none;color:#212121;margin-left:0.5rem}";const k=class{constructor(e){t(this,e),this.isSignup=!1,this.toggleSignupContainer=this.toggleSignupContainer.bind(this)}render(){const t=this.isSignup?"signup-container active":"signup-container";return[e("div",{class:"auth-container"},e("div",{class:this.isSignup?"login-container":"login-container active",onClick:()=>this.toggleSignupContainer(!1)},e("h3",null,"Welcome Back"),e("ga-login",{platform:this.platform})),e("div",{class:t,onClick:()=>this.toggleSignupContainer(!0)},e("h3",null,"Create Account"),(()=>this.isSignup?e("ga-signup",{platform:this.platform}):e("limel-input-field",{label:"Email address",type:"email",value:"",trailingIcon:"filled_message"}))()))]}toggleSignupContainer(t){this.isSignup=t}};k.style=".auth-container{display:-ms-flexbox;display:flex;height:100%;width:100%}.auth-container .login-container{width:25%;padding:1rem;border-right:1px solid #ccc}.auth-container .login-container.active{width:60%}.auth-container .signup-container{width:40%;padding:1rem}.auth-container .signup-container.active{width:75%}";const C=class{constructor(e){t(this,e),this.changeView=s(this,"changeView",7),this.menuItems=[{text:"Help",icon:"ask_question",value:n.help},{text:"Settings",icon:"settings",value:n.settings},{text:"Logout",icon:"exit",value:n.logout}],this.isOpen=!1,this.toggleMenu=this.toggleMenu.bind(this),this.handleBack=this.handleBack.bind(this),this.showBackButton=this.showBackButton.bind(this),this.previousViewOnClose=this.previousViewOnClose.bind(this),this.onNavigate=this.onNavigate.bind(this),this.onCancelMenu=this.onCancelMenu.bind(this)}render(){return this.isSending?[]:this.showBackButton()?e("limel-button",{class:"ga-menu",onClick:this.handleBack,label:"Back"}):e("limel-menu",{class:"ga-menu",label:"Menu",items:this.menuItems,onCancel:this.onCancelMenu,onSelect:this.onNavigate,open:this.isOpen},e("div",{slot:"trigger"},e("limel-icon-button",{icon:"menu",onClick:this.toggleMenu})))}toggleMenu(){this.isOpen=!this.isOpen}handleBack(){this.changeView.emit(this.previousViewOnClose())}onNavigate(t){this.changeView.emit(t.detail.value),this.isOpen=!1}onCancelMenu(){this.isOpen=!1}previousViewOnClose(){switch(this.activeView){case n.videoLibrary:return n.sendDocument;case n.invite:case n.help:case n.settings:case n.documentDetail:return n.home;case n.documentValidation:return n.sendDocument;default:return this.activeView}}showBackButton(){switch(this.activeView){case n.videoLibrary:case n.invite:case n.help:case n.settings:case n.documentDetail:return!0;case n.documentValidation:default:return!1}}};C.style=".ga-menu{position:absolute;top:1rem;right:1rem}limel-button{--lime-primary-color:#f49132}";const _=class{constructor(e){t(this,e),this.documents=[]}render(){return[e("div",{class:"main-layout"},e("div",{class:"send-new-document-container"},e("h3",null,"Send new document"),e("div",{class:"send-new-document-buttons"},e("send-new-document-button",{isSigning:!0}),e("send-new-document-button",{isSigning:!1}))),e("div",{class:"related-documents"},e("h3",null,"Related documents"),this.isLoadingDocuments?e("ga-loader",null):e("document-list",{documents:this.documents})))]}};var S;_.style=".main-layout{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:distribute;justify-content:space-around}@media (min-width: 1074px){.main-layout .send-new-document-container{width:65%}.main-layout .send-new-document-container .send-new-document-buttons{display:-ms-flexbox;display:flex;overflow:hidden;width:100%;-ms-flex-pack:distribute;justify-content:space-around;-ms-flex-wrap:wrap;flex-wrap:wrap}.main-layout .related-documents{margin-right:1rem;width:33%}}@media (max-width: 1075px){.main-layout .send-new-document-container{width:100%}.main-layout .related-documents{width:100%}}",function(t){t.None="none",t.Template="template",t.LimeDocuments="limeDocuments"}(S||(S={}));const D=class{constructor(e){t(this,e),this.setCustomFields=s(this,"setCustomFields",7),this.errorHandler=s(this,"errorHandler",7),this.customFields=[],this.isLoadingTemplates=!1,this.templates=[],this.isLoadingFields=!1,this.openSection=S.Template,this.loadTemplates=this.loadTemplates.bind(this),this.loadTemplateFields=this.loadTemplateFields.bind(this),this.loadLimeDocuments=this.loadLimeDocuments.bind(this),this.onChangeSection=this.onChangeSection.bind(this),this.setTemplates=this.setTemplates.bind(this),this.setLimeDocuments=this.setLimeDocuments.bind(this),this.setFields=this.setFields.bind(this)}render(){return[e("div",{class:"layout-select-file-container"},e("h3",null,"Select file to send"),",",e("div",{class:"select-file-container"},e("div",{class:"file-column"},e("limel-collapsible-section",{header:"Templates",isOpen:this.openSection===S.Template,onOpen:t=>this.onChangeSection(t,S.Template),onClose:t=>this.onChangeSection(t,S.None)},e("template-list",{templates:this.templates,selectedTemplate:this.selectedTemplate,isLoading:this.isLoadingTemplates})),e("limel-collapsible-section",{header:"Lime documents",isOpen:this.openSection===S.LimeDocuments,onOpen:t=>this.onChangeSection(t,S.LimeDocuments),onClose:t=>this.onChangeSection(t,S.None)},e("lime-document-list",{documents:this.limeDocuments,isLoading:this.isLoadingLimeDocuments}))),e("div",{class:"file-column"},e("template-preview",{template:this.selectedTemplate,isLoading:this.isLoadingFields,session:this.session}),e("custom-fields",{template:this.selectedTemplate,customFields:this.customFields,isLoading:this.isLoadingFields}))),",")]}componentWillLoad(){this.loadTemplates(),this.loadLimeDocuments()}onChangeSection(t,e){t.stopPropagation(),this.openSection=e}async loadTemplates(){this.isLoadingTemplates=!0;try{this.templates=await o(this.platform,this.session,this.selectedTemplate)}catch(t){this.errorHandler.emit("Could not load templates from GetAccept...")}this.isLoadingTemplates=!1}async loadLimeDocuments(){this.isLoadingLimeDocuments=!0;const{id:t,limetype:e}=this.context;try{this.limeDocuments=await r(this.platform,e,t,this.selectedLimeDocument)}catch(i){this.errorHandler.emit("Could not load related Lime documents...")}this.isLoadingLimeDocuments=!1}async loadTemplateFields(){if(!this.selectedTemplate)return this.customFields=[],void this.setCustomFields.emit(this.customFields);this.isLoadingFields=!0;const{id:t,limetype:e}=this.context;try{const i=await c(this.platform,this.session,e,t,this.selectedTemplate);this.setFields(i)}catch(i){this.errorHandler.emit("Could not fetch template fields from GetAccept...")}this.isLoadingFields=!1}setFields(t){const e=t.map(this.mapField);this.setCustomFields.emit(e)}onChangeTemplate(t){this.setTemplates(t),t&&this.loadTemplateFields()}setTemplates(t){this.templates=this.getSelectedListItems(this.templates,t)}onChangeDocument(t){this.setLimeDocuments(t)}mapField(t){return{value:t.field_value,id:t.field_id,label:t.field_label||t.field_value,is_editable:!!t.is_editable}}setLimeDocuments(t){this.limeDocuments=this.getSelectedListItems(this.limeDocuments,t)}getSelectedListItems(t,e){return t.map(t=>e&&t.value===e.value?e:Object.assign(Object.assign({},t),{selected:!1}))}updateFieldValue(t){const{id:e,value:i}=t.detail,s=this.customFields.map(t=>t.id===e?Object.assign(Object.assign({},t),{value:i}):t);this.setCustomFields.emit(s)}static get watchers(){return{selectedTemplate:["onChangeTemplate"],selectedLimeDocument:["onChangeDocument"]}}};D.style=".layout-select-file-container{max-height:60vh;overflow:auto}.layout-select-file-container .select-file-container{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}@media (min-width: 1074px){.layout-select-file-container .select-file-container .file-column{width:45%;padding:1rem}}@media (max-width: 1075px){.layout-select-file-container .select-file-container .file-column{width:100%}}";const L=class{constructor(e){t(this,e),this.updateDocumentRecipient=s(this,"updateDocumentRecipient",7),this.errorHandler=s(this,"errorHandler",7),this.selectedRecipientList=[],this.includeCoworkers=!1,this.recipientList=[],this.selectRecipientHandler=this.selectRecipientHandler.bind(this),this.isAdded=this.isAdded.bind(this),this.onSearch=this.onSearch.bind(this),this.toggleIncludeCoworkers=this.toggleIncludeCoworkers.bind(this),this.fetchRecipients=this.fetchRecipients.bind(this)}componentWillLoad(){this.selectedRecipientList=this.document.recipients}render(){return[e("div",{class:"select-recipient-container"},e("div",{class:"recipient-container"},e("h3",null,"Search Recipient"),e("div",{class:"recipient-toolbar"},e("limel-input-field",{label:"Search recipient",value:this.searchTerm,onChange:this.onSearch}),e("limel-switch",{label:"Include coworkers",value:this.includeCoworkers,onChange:this.toggleIncludeCoworkers})),e("ul",{class:"recipient-list"},this.recipientList.map(t=>{if(!this.isAdded(t.lime_id))return e("recipient-item",{recipient:t,showAdd:!0,onClick:()=>{this.selectRecipientHandler(t)}})}))),e("div",{class:"selected-recipient-container"},e("h3",null,"Added recipients"),e("selected-recipient-list",{recipients:this.selectedRecipientList,document:this.document})))]}selectRecipientHandler(t){t.mobile||t.email?(this.selectedRecipientList=[...this.selectedRecipientList,t],this.updateDocumentRecipient.emit(this.selectedRecipientList)):this.errorHandler.emit("A recipient needs to have a mobile number or an email address")}removeRecipientHandler(t){let e=t.detail;this.selectedRecipientList=this.selectedRecipientList.filter(t=>t.lime_id!=e.lime_id),this.updateDocumentRecipient.emit(this.selectedRecipientList)}changeRecipientRoleHandler(t){const e=t.detail,i=this.selectedRecipientList.findIndex(t=>t.lime_id===e.lime_id);this.selectedRecipientList[i]=e,this.updateDocumentRecipient.emit(this.selectedRecipientList)}isAdded(t){return!!this.selectedRecipientList.find(e=>e.lime_id===t)}toggleIncludeCoworkers(){this.includeCoworkers=!this.includeCoworkers,this.fetchRecipients()}async onSearch(t){this.searchTerm=t.detail,this.fetchRecipients()}async fetchRecipients(){const t={params:{search:this.searchTerm,limit:"10",offset:"0"}};try{const e=await this.fetchPersons(t),i=await this.fetchCoworkers(t,this.includeCoworkers);this.recipientList=[...e,...i]}catch(e){this.errorHandler.emit("Something went wrong while communicating with the server...")}}async fetchPersons(t){return(await this.platform.get(h.Http).get("getaccept/persons",t)).map(t=>({email:t.email,name:t.name,mobile:t.mobilephone||t.phone,limetype:"person",lime_id:t.id,company:t.company}))}async fetchCoworkers(t,e){return e?(await this.platform.get(h.Http).get("getaccept/coworkers",t)).map(t=>({mobile:t.mobilephone||t.phone,name:t.name,email:t.email,limetype:"coworker",lime_id:t.id,company:t.company})):[]}};L.style=".select-recipient-container{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;max-height:60vh;overflow:auto}@media (min-width: 1074px){.select-recipient-container .recipient-container{width:45%;padding:1rem}.select-recipient-container .selected-recipient-container{width:45%;padding:1rem}}@media (max-width: 1075px){.select-recipient-container .recipient-container{width:100%}.select-recipient-container .selected-recipient-container{width:100%}}.recipient-list{list-style-type:none;padding:0;margin:0;max-height:50vh;overflow:auto}.recipient-toolbar{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:center;align-items:center}.recipient-toolbar :first-child{-ms-flex-positive:1;flex-grow:1;margin-right:1.5rem}limel-switch{--lime-primary-color:#f49132}";const j=class{constructor(e){t(this,e),this.setNewDocumentName=s(this,"setNewDocumentName",7),this.setDocumentValue=s(this,"setDocumentValue",7),this.setIsSmsSending=s(this,"setIsSmsSending",7),this.setSmartReminder=s(this,"setSmartReminder",7),this.changeView=s(this,"changeView",7),this.removeVideo=s(this,"removeVideo",7),this.documentName="",this.value=0,this.smartReminder=!1,this.sendLinkBySms=!1,this.documentVideo=!1,this.handleChangeDocumentName=this.handleChangeDocumentName.bind(this),this.handleChangeValue=this.handleChangeValue.bind(this),this.handleChangeSmartReminder=this.handleChangeSmartReminder.bind(this),this.handleChangeSendLinkBySms=this.handleChangeSendLinkBySms.bind(this),this.handleAddVideo=this.handleAddVideo.bind(this),this.handleRemoveVideo=this.handleRemoveVideo.bind(this)}componentWillLoad(){this.documentName=this.fileName(),this.setNewDocumentName.emit(this.documentName),this.value=this.document.value||0,this.smartReminder=this.document.is_reminder_sending,this.sendLinkBySms=this.document.is_sms_sending,this.documentVideo=""!==this.document.video_id}componentDidUpdate(){this.value=this.document.value,this.documentName=this.document.name||this.fileName()}render(){return[e("div",{class:"send-document-container"},e("div",{class:"send-document-prepare-container"},e("h3",null,"Prepare sending"),e("limel-flex-container",{align:"stretch"},e("limel-input-field",{label:"Document Name",value:this.documentName,onChange:this.handleChangeDocumentName}),e("limel-input-field",{label:"Value",value:this.value.toString(),onChange:this.handleChangeValue})),e("div",null,e("h4",null,"Document engagement"),this.documentVideo?e("div",null,e("div",{class:"video-is-added"},e("limel-icon",{name:"tv_show",size:"large",class:"video-is-added-icon"}),e("span",null,"Video is added"),e("limel-icon",{class:"video-remove-icon",name:"multiply",size:"small",onClick:this.handleRemoveVideo}))):e("limel-button",{class:"add-video-button",primary:!0,label:"Add Video introduction",onClick:this.handleAddVideo}),e("limel-checkbox",{label:"Send smart reminders",id:"SmartReminder",checked:this.smartReminder,onChange:this.handleChangeSmartReminder}),e("limel-checkbox",{label:"Send link by SMS",id:"SendLinkBySMS",checked:this.sendLinkBySms,onChange:this.handleChangeSendLinkBySms}))),e("div",{class:"send-document-email-container"},e("create-email",{document:this.document})))]}fileName(){return this.limeDocument?this.limeDocument.text:this.template?this.template.text:""}handleChangeDocumentName(t){this.setNewDocumentName.emit(t.detail)}handleChangeValue(t){this.setDocumentValue.emit(t.detail)}handleChangeSmartReminder(t){this.setSmartReminder.emit(t.detail)}handleChangeSendLinkBySms(t){this.setIsSmsSending.emit(t.detail)}handleAddVideo(){this.changeView.emit(n.videoLibrary)}handleRemoveVideo(){this.removeVideo.emit(),this.documentVideo=!1}};j.style=".send-document-container{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}@media (min-width: 1074px){.send-document-container .send-document-prepare-container{width:calc(50% - 0.5rem);padding-right:0.5rem}.send-document-container .send-document-email-container{width:calc(50% - 0.5rem);padding-left:0.5rem}}@media (max-width: 1075px){.send-document-container .send-document-prepare-container{width:100%}.send-document-container .send-document-email-container{margin-top:1.5rem;width:100%}}.send-document-container .add-video-button{margin-bottom:0.5rem}.send-document-container .video-is-added{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;margin-left:0.5rem;border-radius:1rem;cursor:pointer;background-color:#f5f5f5}.send-document-container .video-is-added .video-is-added-icon{padding:0.1rem;margin-right:0.5rem;background-color:#2dc990;color:#fff}.send-document-container .video-is-added .video-remove-icon{margin-left:0.5rem;padding:0.1rem;color:#ccc}.send-document-container .video-is-added:hover{background-color:#ccc}.send-document-container .video-is-added:hover .video-remove-icon{color:#212121}.send-document-container .video-remove-container{display:-ms-flexbox;display:flex;cursor:pointer}limel-button{--lime-primary-color:#f49132}limel-checkbox{--lime-primary-color:#f49132}limel-flex-container limel-input-field:first-child{-ms-flex:2;flex:2;margin-right:0.5rem}limel-flex-container limel-input-field:last-child{-ms-flex:1;flex:1;margin-left:0.5rem}";const O=class{constructor(e){t(this,e),this.setSession=s(this,"setSession",7),this.error="",this.onChangeEntity=this.onChangeEntity.bind(this),this.renderContent=this.renderContent.bind(this)}componentWillLoad(){this.entityOptions=this.entities.map(t=>({value:t.id,text:t.name})),this.selectedEntity=this.entityOptions.find(t=>t.value===this.user.entity_id)}render(){return[e("h3",null,"Settings"),e("div",{class:"settings-container"},this.isLoading?this.renderLoader():this.renderContent())]}renderLoader(){return e("ga-loader",{class:"full-width"})}renderContent(){return[e("div",{class:"settings-column"},e("h4",null,"My profile"),e("limel-flex-container",{justify:"center"},e("profile-picture",{thumbUrl:this.user.thumb_url})),e("limel-input-field",{label:"Name",value:`${this.user.first_name} ${this.user.last_name}`,disabled:!0}),e("limel-input-field",{label:"Title",value:this.user.title,disabled:!0}),e("limel-input-field",{label:"Email",value:this.user.email,disabled:!0}),e("limel-input-field",{label:"Phone",value:this.user.mobile,disabled:!0}),e("limel-input-field",{label:"Role",value:this.user.role,disabled:!0})),e("div",{class:"settings-column"},e("h4",null,"Change entity"),e("limel-select",{class:"entity-selector",label:"Entity",value:this.selectedEntity,options:this.entityOptions,onChange:this.onChangeEntity,required:!0}),this.renderError(this.error))]}renderError(t){return t?e("span",{class:"error"},t):""}async onChangeEntity(t){if(t.detail.value==this.selectedEntity.value)return;this.isLoading=!0;const e=this.selectedEntity;this.selectedEntity=t.detail;try{const t=await d(this.selectedEntity.value,this.platform,this.session);this.setSession.emit(t)}catch(i){this.error="Could not switch entity. Please try again at a later time.",setTimeout(()=>{this.error=""},3e3),this.selectedEntity=e}this.isLoading=!1}};O.style=".settings-container{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.settings-container .error{display:block;color:#f88987;margin-top:1rem}@media (min-width: 1074px){.settings-container .settings-column{width:45%;padding:1rem}}@media (max-width: 1075px){.settings-container .settings-column{width:100%}}.full-width{width:100%}";const T=class{constructor(e){t(this,e),this.documentCompleted=s(this,"documentCompleted",7),this.errorHandler=s(this,"errorHandler",7),this.isSendingDocument=s(this,"isSendingDocument",7),this.isSealed=!1,this.isLoading=!0,this.recipients=[],this.errorList=[],this.handleCreateDocument=this.handleCreateDocument.bind(this),this.sealDocument=this.sealDocument.bind(this),this.hasProperty=this.hasProperty.bind(this),this.openInNewTab=this.openInNewTab.bind(this),this.handleOpenGetAccept=this.handleOpenGetAccept.bind(this)}async componentWillLoad(){await this.validateDocument()}render(){return e("div",null,(()=>this.isLoading?e("ga-loader-with-text",{showText:this.isSending,text:"We are creating your document!"}):this.isSealed?this.recipients.length>0?e("div",{class:"share-document-container"},e("h3",null,"Share document link:"),e("ul",{class:"share-document-recipient-list"},this.recipients.map(t=>e("share-document-link",{recipient:t}))),e("div",{class:"action-buttons"},e("limel-button",{label:"Done",primary:!0,onClick:()=>{this.documentCompleted.emit(!1)}}),e("limel-button",{label:"Open in GetAccept",primary:!1,onClick:()=>this.handleCreateDocument(!1,!0)}))):void 0:e("div",null,(()=>this.errorList.length>0?e("document-error-feedback",{document:this.document,errorList:this.errorList}):e("document-validate-info",{document:this.document}))(),e("div",{class:"validate-document-button-container"},(()=>0===this.errorList.length?[e("limel-button",{class:"send-button",label:"Send",primary:!0,onClick:()=>this.handleCreateDocument(!0,!1)}),e("limel-button",{label:"Share document link",primary:!1,onClick:()=>this.handleCreateDocument(!1,!1)}),e("limel-button",{label:"Open in GetAccept",primary:!1,onClick:()=>this.handleCreateDocument(!1,!0)})]:e("limel-button",{label:"Open in GetAccept",primary:!1,onClick:()=>this.handleCreateDocument(!1,!0)}))())))())}async hasTemplateRoles(){if(!this.template)return!1;try{return(await a(this.platform,this.session,this.template.value)).recipients.filter(t=>"1"===t.status).length>0}catch(t){return this.errorHandler.emit("Could not fetch template data from GetAccept"),!1}}async handleUploadDocument(){if(this.limeDocument){const{data:t,success:e}=await m(this.platform,this.session,this.limeDocument.value);if(e)return t.file_id;this.errorHandler.emit("Could not upload Lime document to GetAccept")}return""}async handleCreateDocument(t,e){this.toggleLoading(!0);const i=await this.handleUploadDocument(),s=Object.assign(Object.assign({},this.document),{template_id:this.template?this.template.value:"",custom_fields:this.template?this.fields:[],file_ids:i,is_automatic_sending:t}),{data:n,success:a}=await u(this.platform,this.session,s);if(!a)return this.errorHandler.emit("Could not create document. Make sure that all data is correctly supplied"),void this.toggleLoading(!1);e&&this.openInNewTab("https://app.getaccept.com/document/edit/"+n.id),this.sentDocument=Object.assign({},n),t||e?(this.toggleLoading(!1),this.documentCompleted.emit(!1)):this.sealDocument(n.id)}async sealDocument(t,e=1){const{data:i,success:s}=await p(this.platform,this.session,t);return!s&&e<5?setTimeout(()=>this.sealDocument(t,e+=1),5e3):!s&&e>=5?(this.errorHandler.emit("Could not seal document do to lengthy import. Try to open it in GetAccept and seal it from there."),void this.toggleLoading(!1)):(this.toggleLoading(!1),this.recipients=i.recipients.map(t=>({name:t.fullname,document_url:t.document_url,role:t.role,email:t.email})),void this.documentCompleted.emit(!0))}handleOpenGetAccept(){this.sentDocument&&this.openInNewTab("https://app.getaccept.com/document/view/"+this.sentDocument.id)}async validateDocument(){this.isLoading=!0,this.limeDocument||this.template||this.errorList.push({header:"No document",title:"You are missing a document.",icon:"dog_tag",view:n.selectFile}),0===this.document.recipients.length&&this.errorList.push({header:"No recipients",title:"You need to add at least one recipient.",icon:"user_male_circle",view:n.recipient}),this.document.recipients.length>0&&this.document.is_signing&&!this.haveSigner()&&this.errorList.push({header:"No signer",title:"You need to add at least one signer when you are sending a documet for signing.",icon:"autograph",view:n.recipient}),this.document.recipients.length>0&&!this.document.is_sms_sending&&this.recipientsWithOnlyPhoneExists()&&this.errorList.push({header:"Need to activate SMS sending",title:"You need to activate SMS sendings due to recipients without email",icon:"cell_phone",view:n.sendDocument}),this.document.recipients.length>0&&this.recipientMissingEmailAndPhoneExists()&&this.errorList.push({header:"Recipient missing contact information",title:"One or many recipients are missing contact information",icon:"about_us_male",view:n.recipient}),await this.hasTemplateRoles()&&this.errorList.push({header:"Template has unassigned roles",title:"The process must be completed in GetAccept before sending.",icon:"id_not_verified",view:n.selectFile}),this.isLoading=!1}haveSigner(){return this.document.recipients.filter(t=>"signer"===t.role).length>0}recipientsWithOnlyPhoneExists(){return this.document.recipients.some(t=>!t.email&&""!==t.mobile)}recipientMissingEmailAndPhoneExists(){return this.document.recipients.some(t=>!t.email&&!t.mobile)}hasProperty(t){return t?"Yes":"No"}openInNewTab(t){this.toggleLoading(!1),this.documentCompleted.emit(),window.open(t,"_blank").focus()}toggleLoading(t){this.isLoading=t,this.isSendingDocument.emit(t)}};T.style=".document-error-list{padding:0;margin:0}.share-document-recipient-list{list-style-type:none;padding:0;margin:0}.validate-document-button-container{display:-ms-flexbox;display:flex;margin:2rem 0}.validate-document-button-container .send-button{padding-right:1rem}.action-buttons{margin-top:2rem}.action-buttons limel-button{margin-right:1rem}limel-button{--lime-primary-color:#f49132}";const A=class{constructor(e){t(this,e),this.changeView=s(this,"changeView",7),this.videos=[],this.isLoadingVideos=!1,this.handelClose=this.handelClose.bind(this)}componentWillLoad(){this.loadVideos()}render(){return[e("div",{class:"video-library-container"},e("h3",null,"Select a video"),e("p",null,"It will be present for the recipient when they open the document."),this.isLoadingVideos&&e("ga-loader",null),e("ul",{class:"video-list"},this.videos.map(t=>e("video-thumb",{video:t}))))]}async loadVideos(){this.isLoadingVideos=!0;const{videos:t}=await g(this.platform,this.session);this.videos=t.map(t=>({thumb_url:t.thumb_url,video_id:t.video_id,video_title:t.video_title,video_type:t.video_type,video_url:t.video_url})),this.isLoadingVideos=!1}handelClose(){this.changeView.emit(n.sendDocument)}};A.style=".video-list{display:-ms-flexbox;display:flex;-ms-flex-flow:row wrap;flex-flow:row wrap;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-item-align:start;align-self:flex-start;list-style-type:none;padding:0;margin:0;width:100%}";const V=class{constructor(e){t(this,e),this.changeView=s(this,"changeView",7),this.changeViewHandlerPrevious=this.changeViewHandlerPrevious.bind(this),this.changeViewHandlerNext=this.changeViewHandlerNext.bind(this),this.changeViewSelectedStep=this.changeViewSelectedStep.bind(this)}render(){return(()=>{if(this.isVisible)return e("ul",{class:"progress-steps"},e("li",{class:"progress-action-button",onClick:this.changeViewHandlerPrevious},"Back"),f.map((t,i)=>{let s="progress-step-icon";return t.currentView===this.activeView&&(s+=" active"),e("li",{class:"progress-step",onClick:()=>this.changeViewSelectedStep(t.currentView)},e("span",{class:s},i+1),e("span",{class:"progress-step-text"},t.label))}),e("li",{class:"progress-action-button",onClick:this.changeViewHandlerNext},"Next"))})()}changeViewHandlerPrevious(){let t=f.find(t=>t.currentView===this.activeView);this.changeView.emit(t.previousView)}changeViewHandlerNext(){let t=f.find(t=>t.currentView===this.activeView);this.changeView.emit(t.nextView)}changeViewSelectedStep(t){this.changeView.emit(t)}};V.style=".progress-steps{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;list-style-type:none;padding:0;margin:0;-ms-flex-pack:center;justify-content:center}.progress-steps limel-icon{color:#f49132}.progress-steps .progress-action-button{margin:0 2.5rem;color:#f49132;font-size:0.7rem;text-transform:uppercase;font-weight:bolder;cursor:pointer}.progress-steps .progress-step{text-align:center;margin:0 1rem;text-align:center;margin:0 1rem;width:5rem;-ms-flex-wrap:wrap;flex-wrap:wrap;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.progress-steps .progress-step .progress-step-icon{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;text-align:center;border-radius:50%;height:2em;width:2em;overflow:hidden;background-color:#f5f5f5;color:#f49132;cursor:pointer}.progress-steps .progress-step .progress-step-icon.active{background-color:#f49132;color:#fff}.progress-steps .progress-step .progress-step-text{font-size:0.55rem}";export{x as error_message,v as layout_document_details,b as layout_help,k as layout_login,C as layout_menu,_ as layout_overview,D as layout_select_file,L as layout_select_recipient,j as layout_send_document,O as layout_settings,T as layout_validate_document,A as layout_video_library,V as workflow_progress_bar}