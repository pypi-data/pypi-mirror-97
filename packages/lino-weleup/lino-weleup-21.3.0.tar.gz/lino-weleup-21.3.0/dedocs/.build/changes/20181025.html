
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2018-10-25 &#8212; Lino für ÖSHZ</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/linodocs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="Über dieses Dokument" href="../about.html" />
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="Alte Release-Notizen" href="old.html" />
    <link rel="prev" title="19.11.0 (coming)" href="19.11.0.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Stichwortverzeichnis"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="old.html" title="Alte Release-Notizen"
             accesskey="N">weiter</a> |</li>
        <li class="right" >
          <a href="19.11.0.html" title="19.11.0 (coming)"
             accesskey="P">zurück</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Lino für ÖSHZ</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Release-Notizen</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">2018-10-25</a></li> 
      </ul>
    </div>


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
  <div class="section" id="id1">
<h1>2018-10-25<a class="headerlink" href="#id1" title="Link zu dieser Überschrift">¶</a></h1>
<div class="contents local topic" id="inhalt">
<ul class="simple">
<li><p><a class="reference internal" href="#regressionen-nach-dem-einsatz" id="id2">Regressionen nach dem Einsatz</a></p></li>
<li><p><a class="reference internal" href="#anderungen" id="id3">Änderungen</a></p></li>
<li><p><a class="reference internal" href="#ungefragte-neuerungen" id="id4">Ungefragte Neuerungen</a></p></li>
<li><p><a class="reference internal" href="#prufung-datumsbereich-beschlusse-bescheinigungen" id="id5">Prüfung Datumsbereich Beschlüsse &amp; Bescheinigungen</a></p></li>
<li><p><a class="reference internal" href="#technische-checkliste" id="id6">Technische Checkliste</a></p></li>
</ul>
</div>
<div class="section" id="regressionen-nach-dem-einsatz">
<h2><a class="toc-backref" href="#id2">Regressionen nach dem Einsatz</a><a class="headerlink" href="#regressionen-nach-dem-einsatz" title="Link zu dieser Überschrift">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://bugs.saffre-rumma.net/tickets/Ticket/2619">#2619</a> Vertragspartner einer VSE per Doppelklick eingeben.
–&gt; Workaround : die Benutzer müssen im Feld Organisation der
Phantomzeile auf [F2] drücken und dann den Namen der Organisation
eintippen.  Für die nächste Version stellen wir den Doppelklick wieder
her.</p></li>
<li><p><a class="reference external" href="http://bugs.saffre-rumma.net/tickets/Ticket/2602">#2602</a> [Automatisch aktualisieren] ist weg.
–&gt; Wurde wiederhergestellt.</p></li>
</ul>
</div>
<div class="section" id="anderungen">
<h2><a class="toc-backref" href="#id3">Änderungen</a><a class="headerlink" href="#anderungen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die folgenden Punkte sind erledigt seit dem 2018-10-25.</p>
<ul class="simple">
<li><p>(caroline) In der Historie konnten wir keine neuen Einträge
hinzufügen bei Personen, die schon viele Einträge haben. Z.B.
Klient 21748.  Das Panel zeigt jetzt eine zusammenfassende Ansicht
(die fünf letzten Einträge) und einen Button (+), um einen neuen
Eintrag zu erstellen. Um alle Einträge zu sehen wie gewohnt auf den
Button oben rechts klicken.</p></li>
<li><p>(Schuldnerberatung) Bei manchen Tabellen im Ausdruck eines Budgets
war die Formatierung noch nicht korrekt.  Genauer gesagt kam das
Problem vor allem in Budgets mit zwei Akteuren und diversen Arten
von Schulden, so dass in manchen Tabellen der Platz zu eng wurde.
Lino machte dann unsinnige Zeilenumbrüche in Beträgen.</p></li>
<li><p>(melanie) Inhalt der Bescheinigungen: Adressfeld ist versetzt!
Layout nicht ok!  –&gt; Das lag daran, dass Lino jetzt lxml-Elemente
benutzt und <code class="docutils literal notranslate"><span class="pre">class_=&quot;Recipient&quot;</span></code> deshalb ersetzt werden muss durch
die neue Syntax <code class="docutils literal notranslate"><span class="pre">**{'class':&quot;Recipient&quot;}</span></code>.  NB Falls das Problem
wiederkommt bzw. nicht gelöst ist, habe ich wahrscheinlich lediglich
vergessen, nach der letzten Datenübername die Druckvorlage
<cite>excerpts/Default.odt</cite> anzupassen.</p></li>
<li><p>(caroline) Für Benutzerart X fehlt im Reiter „Verträge“ das Panel wo
die VSE-Verträge angezeigt wurden.</p></li>
<li><p>(melanie) Übersetzung AMK Französisch war unverändert nicht
korrekt.  Zum Beispiel
<code class="file docutils literal notranslate"><span class="pre">/media/cache/appypdf/aids.RefundConfirmation-5341.pdf</span></code>.  NB
Falls das Problem wiederkommt bzw. nicht gelöst ist, habe ich
wahrscheinlich lediglich vergessen, nach der letzten Datenübername
die Textkörpervorlage <code class="xref std std-xfile docutils literal notranslate"><span class="pre">aids/medical_refund.body.html</span></code> zu
löschen.</p></li>
<li><p>(server) Export nach Excel ging nicht. Ein Benutzer hat versucht,
Bescheinigungen zu exportieren.</p></li>
<li><p>(server) Fehlermeldung beim Ausdrucken gewisser Verträge.</p></li>
<li><p>(melanie) Kann kein Komma in Zahlenfelder eingeben.</p></li>
<li><p>(martina) in Schuldnerberatung erscheint jetzt bei der 1000 Stelle
ein Komma anstatt ein Freizeichen.</p></li>
</ul>
<ul class="simple">
<li><p>wdav und beid ohne Java</p></li>
<li><p><strong>Kontauszüge um den Jahreswechsel herum</strong> wurden bisher nicht
importiert, weil Lino da einen Fehlalarm „different years“ auslöste.
In der testlino kann man das jetzt noch nicht sehen, aber wenn die
neue Version aktiviert worden ist, müssten die fehlenden Auszüge
automatisch (nach dem nächsten Import) erscheinen.</p></li>
<li><p><a class="reference internal" href="#prufung-datumsbereich-beschlusse-bescheinigungen">Prüfung Datumsbereich Beschlüsse &amp; Bescheinigungen</a> (siehe unten)</p></li>
<li><p>Die Mitarbeiter des Sekretariats/Backoffice/Empfang (Benutzerart 210
„Empfangsschalter“) können jetzt auch die Reiter „Kalender“ und
„Verträge“ sehen.</p></li>
<li><p>In Klienten kann man jetzt wieder <strong>per Schnellsuche nach Adresse
und Nationalregisternummer</strong> suchen (so wie es früher schon mal
war).</p></li>
<li><p>Tipp : um einen Klienten nach seiner ID (Partnernummer) zu finden,
kann man im Schnellsuch-Feld ein „#“ vor die Nummer setzen.  Das
Gleiche gilt auch für Verträge, Auszüge etc.</p></li>
<li><p>Lino schlug par défaut „Pflegemutter“ statt „Mutter“ vor.</p></li>
<li><p>Beim Einfügen eines Termins vom Klienten aus ist das Dialogfenster
optimiert: Enddatum steht dort jetzt nicht mehr, und die Eintragsart
wurde hinzugefügt.</p></li>
<li><p>Eine ungefragte Änderung: Es gibt jetzt einen Quicklink <cite>[Suchen]</cite>,
mit dem man eine <strong>Schnellsuche in allen Tabellen</strong> auf einmal
durchführen kann. Momentan ist die Funktion nur sichtbar für
Systemverwalter. Wartet auf Feedback.</p></li>
<li><p>Deutlichere Fehlermeldung im Fall eines Problems bei der Verbindung
zur Datenbank.</p></li>
<li><p>Die Buttons im Fenster „Meine Einstellungen“ sind jetzt oben (wie
gewohnt) statt unten. Und jetzt haben sie auch alle einen Hilfetext.</p></li>
<li><p>Bescheinigung Kleiderkammer (Kostenübernahme Kleidung) : Der Satz
„Wir bescheinigen hiermit, für folgende Personen die Kosten für den
Ankauf von Kleidung bis in Höhe von 20 EUR zu übernehmen:“ war noch
nicht übersetzt. Ab jetzt „Par la présente nous confirmons la prise
en charge des achats de vêtements jusqu’à un montant de 20 € pour
les personnes suivantes:“</p></li>
<li><p>Wenn ein Benutzer eine Vollmacht hatte, deren Feld <cite>user</cite> (d.h. der
vollmachtgebende Benutzer) leer war, dann konnte dieser Benutzer
sich nicht mehr anmelden bzw. bekam dann einen Fehler 500 mit
interner Fehlermeldung <code class="docutils literal notranslate"><span class="pre">AttributeError:</span> <span class="pre">'NoneType'</span> <span class="pre">object</span>
<span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'id'</span></code>.</p></li>
<li><p>Behoben: Fehlermeldung „AttrDict instance has no key ‚immersion‘“
beim Aktualisieren der ESF-Daten.</p></li>
<li><p>Wenn man einen Begleiter zuweist, steht die neue Begleitung jetzt
automatisch auf primär. Falls es bereits einen PB gab, wird dieser
abgeschaltet.</p></li>
<li><p>Was tun, wenn ein Sozi aufhört?  end_date ausfüllen. Benutzerart
nicht auf leer setzen, weil man sonst nicht mehr als dieser User
arbeiten kann.</p></li>
<li><p>Kalendereinträge pro Klient werden jetzt chronologisch rückwärts
sortiert</p></li>
<li><p>Fehlermeldung bei Ausdruck einer Anwesenheitsbestätigung, wenn der
Gast noch nicht ausgecheckt war (<a class="reference external" href="http://bugs.saffre-rumma.net/tickets/Ticket/2443">#2443</a>).</p></li>
<li><p><span class="menuselection">Explorer ‣ Büro ‣ Auszüge</span> zeigte „There was a
problem with the database connection. If the error persists, try
reloading your browser“, und in der <a class="reference external" href="https://www.lino-framework.org/admin/logging.html#xfile-lino.log" title="(in The Lino Book v20.1)"><code class="xref std std-xfile docutils literal notranslate"><span class="pre">lino.log</span></code></a> stand dann
<code class="docutils literal notranslate"><span class="pre">'datetime.time</span> <span class="pre">object'</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'date'</span></code>.</p></li>
</ul>
</div>
<div class="section" id="ungefragte-neuerungen">
<h2><a class="toc-backref" href="#id4">Ungefragte Neuerungen</a><a class="headerlink" href="#ungefragte-neuerungen" title="Link zu dieser Überschrift">¶</a></h2>
<ul class="simple">
<li><p>Eine neue Tabelle <strong>Tagesplaner</strong> zeigt eine Tagesübersicht der
Termine aller Benutzer an, wobei die Termine je nach Art in
verschiedene Kolonnen ventiliert werden.  (<a class="reference external" href="http://bugs.saffre-rumma.net/tickets/Ticket/2382">#2382</a>)</p></li>
<li><p><a class="reference external" href="http://bugs.saffre-rumma.net/tickets/Ticket/2441">#2441</a> : „Intelligentere“ Übersicht der Termine pro Kurs.</p></li>
<li><p><strong>Überfällige Termine</strong> zeigt jetzt nicht mehr die von heute an,
sondern endet schon gestern. Denn die von heute sind ja unter „Meine
Termine“ zu sehen.</p></li>
</ul>
</div>
<div class="section" id="prufung-datumsbereich-beschlusse-bescheinigungen">
<h2><a class="toc-backref" href="#id5">Prüfung Datumsbereich Beschlüsse &amp; Bescheinigungen</a><a class="headerlink" href="#prufung-datumsbereich-beschlusse-bescheinigungen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Wir haben die Erklärung für <a class="reference external" href="http://bugs.saffre-rumma.net/tickets/Ticket/1354">#1354</a> gefunden : es ist üblich,
dass ein Hilfebeschluss zunächst ohne Enddatum registriert wird, und
dass daraus dann eine Serie von Bestätigungen ebenfalls ohne Enddatum
erstellt werden. Wenn dann irgendwann der Beschluss abgeschlossen
wird, dann setzt der verantwortliche Sozi auf dem Beschluss ein
Enddatum ein und erstellt ggf einen neuen Beschluss. Was Lino in
diesem Moment nicht meldete, war, dass dadurch -zumindest für Lino-
alle Bescheinigungen ungültig wurden, deren Enddatum leer war : Wenn
der Beschluss ein bekanntes Enddatum hat, dann darf die Bescheinigung
nicht ohne Enddatum sein. Diese Regel hat bis März 2017 regelmäßig zum
Verlust von Bescheinigungen geführt, weil Lino den Regelverstoß erst
bei der Datenmigration bemerkte und betroffene Bescheinigungen
löschte. Ich berichtete dann zwar immer, dass wieder eine Serie von
ungültigen Bescheinigungen gelöscht worden waren, aber weil keiner
eine Ahnung hatte, worum es genau ging, habt ihr euch erst Anfang 2017
erstmals beschwert, dass manche Bescheinigungen nicht mehr in Lino
drin sind. Woraufhin ich die -wie wir annahmen allzu strenge- Regel
entfernt habe. Aber seitdem hatten die Benutzer Narrenfreiheit und
haben dann auch prompt versehentlich neue Bescheinigungen zu alten
Hilfebeschlüssen ausgedruckt.</p>
<p>Soweit die Erklärung. Jetzt die Lösung bzw. der Anfang davon.</p>
<ol class="arabic simple">
<li><p>ich habe die Regel entschärft : wenn der Beschluss ein Enddatum
hat, dann darf das Enddatum der Bescheinigung leer sein. Wenn sie
eines hat, dann darf es nicht nach dem Enddatum des Beschlusses
liegen.</p></li>
<li><p>mit der entschärften Regel haben wir den Integritätstest
(checkdata) neu laufen lassen. Dadurch wurden die ursprünglich 682
Fehlwarnungen auf ein paar Dutzend echte Warnungen reduziert.</p></li>
</ol>
<p>TODO: Ich sollte die (entschärfte) Prüfung wieder auf „hart“ schalten,
damit Lino es schon bei der Eingabe prüft und nicht erst im
nächtlichen checkdata.</p>
<p>Aber was machen wir dann mit diesen paar Dutzend echten Warnungen?
Beispiel: AMK/01.10.14/22346/4232. Also das sind Bescheinigungen,
deren Datenbereich tatsächlich ungültig ist. Wenn wir die
(entschärfte) Prüfung wieder auf hart schalten, dann würden diese echt
falschen Bescheinigungen wieder gelöscht.  Was sagt ihr dazu? Ich sehe
zwei Möglichkeiten:</p>
<ol class="loweralpha simple">
<li><p>Das wollen wir nicht, denn die sind ja ausgestellt worden und
rausgegangen. Also Lino muss ein System kriegen, mit dem man
solche Datenprobleme dann „absegnen“ kann, also dass man Lino
irgendwie mitteilt „Ja, Bescheinigung X verstößt gegen die Regel,
aber wir drücken da ausnahmsweise ein Auge zu“.</p></li>
<li><p>Es ist uns egal, wenn Lino diese Bescheinigungen
löscht. Hauptsache, dass die entschärfte Regel wieder aktiviert
wird und es zukünftig nicht mehr zu solchen echten Fehlern kommt.</p></li>
</ol>
<p>Weil keine Antwort kam, habe ich eine dritte Möglichkeit programmiert:
<a class="reference external" href="http://welfare.lino-framework.org/api/lino_welfare.modlib.aids.html#lino_welfare.modlib.aids.Plugin.no_date_range_veto_until" title="(in Lino Welfare project home)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lino_welfare.modlib.aids.Plugin.no_date_range_veto_until</span></code></a>. Also
<span class="menuselection">Explorer ‣ ÖSHZ ‣ Hilfebeschlüsse</span> um die letzte
Nummer zu sehen (3942 am 07.05.18).</p>
</div>
<div class="section" id="technische-checkliste">
<h2><a class="toc-backref" href="#id6">Technische Checkliste</a><a class="headerlink" href="#technische-checkliste" title="Link zu dieser Überschrift">¶</a></h2>
<p>Start the last data migration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ go testlino
$ sudo service apache2 stop
$ sudo service supervisor stop
$ ./initdb_preview_from_prod.sh
</pre></div>
</div>
<p>The data migration lasts about 1:30 hours.  When it is done:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swap preview and prod

$ sudo service apache2 start
$ sudo service supervisor start
</pre></div>
</div>
<p>Open the <cite>excerpts/Default.odt</cite> document template and manually
edit it:</p>
<ul class="simple">
<li><p>(melanie) Inhalt der Bescheinigungen: Adressfeld ist versetzt!
Layout nicht ok!  –&gt; Das lag daran, dass Lino jetzt lxml-Elemente
benutzt und <code class="docutils literal notranslate"><span class="pre">class_=&quot;Recipient&quot;</span></code> deshalb ersetzt werden muss durch
die neue Syntax <code class="docutils literal notranslate"><span class="pre">**{'class':&quot;Recipient&quot;}</span></code>.  NB Falls das Problem
wiederkommt bzw. nicht gelöst ist, habe ich wahrscheinlich lediglich
vergessen, nach der letzten Datenübername die Druckvorlage
<cite>excerpts/Default.odt</cite> anzupassen.</p></li>
</ul>
<p>Maybe also check the other local document templates?</p>
<blockquote>
<div><p>$ find config/ -name Default.odt</p>
</div></blockquote>
</div>
</div>



          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo_web3.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Inhalt</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tour/index.html">Lino-Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../handbuch.html">Benutzerhandbuch</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Release-Notizen</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="19.11.0.html">19.11.0 (coming)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2018-10-25</a></li>
<li class="toctree-l2"><a class="reference internal" href="old.html">Alte Release-Notizen</a></li>
<li class="toctree-l2"><a class="reference internal" href="coming.html">Kommende Version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../testlauf.html">Allgemeine Testanweisungen</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">Über Lino Welfare</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kontakt.html">Kontakt</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Schnellsuche</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Los" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre/lino-welfare" target="_blank">GitHub</a>
<a href="http://pypi.python.org/pypi/lino-welfare" target="_blank">pypi</a>
</p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Stichwortverzeichnis"
             >Index</a></li>
        <li class="right" >
          <a href="old.html" title="Alte Release-Notizen"
             >weiter</a> |</li>
        <li class="right" >
          <a href="19.11.0.html" title="19.11.0 (coming)"
             >zurück</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Lino für ÖSHZ</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Release-Notizen</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">2018-10-25</a></li> 
      </ul>
    </div>


    <div class="footer">
        &copy; Copyright 2012-2018 Rumma &amp; Ko OÜ.
      Zuletzt aktualisiert am März 08, 2021.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.4.2.
    <a href="https://raw.github.com/lino-framework/welcht/master/dedocs/changes/20181025.rst"
           rel="nofollow">Quellcode anzeigen</a>.
    <a href="http://de.welfare.lino-framework.org/changes/20181025.html">Online Link</a>.
    </div>
  </body>
</html>