The solution for the table factory case.
