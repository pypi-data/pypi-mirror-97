(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{603:function(t,_,s){"use strict";s.r(_);var e=s(21),v=Object(e.a)({},(function(){var t=this,_=t.$createElement,s=t._self._c||_;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"nonebot-rule-模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nonebot-rule-模块"}},[t._v("#")]),t._v(" NoneBot.rule 模块")]),t._v(" "),s("h2",{attrs:{id:"规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规则"}},[t._v("#")]),t._v(" 规则")]),t._v(" "),s("p",[t._v("每个事件响应器 "),s("code",[t._v("Matcher")]),t._v(" 拥有一个匹配规则 "),s("code",[t._v("Rule")]),t._v(" ，其中是 "),s("strong",[t._v("异步")]),t._v(" "),s("code",[t._v("RuleChecker")]),t._v(" 的集合，只有当所有 "),s("code",[t._v("RuleChecker")]),t._v(" 检查结果为 "),s("code",[t._v("True")]),t._v(" 时继续运行。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[s("code",[t._v("RuleChecker")]),t._v(" 既可以是 async function 也可以是 sync function，但在最终会被 "),s("code",[t._v("nonebot.utils.run_sync")]),t._v(" 转换为 async function")])]),t._v(" "),s("h2",{attrs:{id:"class-rule"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-rule"}},[t._v("#")]),t._v(" "),s("em",[t._v("class")]),t._v(" "),s("code",[t._v("Rule")])]),t._v(" "),s("p",[t._v("基类："),s("code",[t._v("object")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[s("code",[t._v("Matcher")]),t._v(" 规则类，当事件传递时，在 "),s("code",[t._v("Matcher")]),t._v(" 运行前进行检查。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("示例")])])])]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Rule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("async_function"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sync_function\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 等价于")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" nonebot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" run_sync\nRule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("async_function"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" run_sync"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sync_function"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"init-checkers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#init-checkers"}},[t._v("#")]),t._v(" "),s("code",[t._v("__init__(*checkers)")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("*checkers: Callable[[Bot, Event, T_State], Awaitable[bool]]")]),t._v(": "),s("strong",[t._v("异步")]),t._v(" RuleChecker")])])])]),t._v(" "),s("h3",{attrs:{id:"checkers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#checkers"}},[t._v("#")]),t._v(" "),s("code",[t._v("checkers")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[t._v("存储 "),s("code",[t._v("RuleChecker")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("类型")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("Set[Callable[[Bot, Event, T_State], Awaitable[bool]]]")])])])])]),t._v(" "),s("h3",{attrs:{id:"async-call-bot-event-state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#async-call-bot-event-state"}},[t._v("#")]),t._v(" "),s("em",[t._v("async")]),t._v(" "),s("code",[t._v("__call__(bot, event, state)")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[t._v("检查是否符合所有规则")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("bot: Bot")]),t._v(": Bot 对象")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("event: Event")]),t._v(": Event 对象")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("state: T_State")]),t._v(": 当前 State")])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("返回")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("bool")])])])])]),t._v(" "),s("h2",{attrs:{id:"startswith-msg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#startswith-msg"}},[t._v("#")]),t._v(" "),s("code",[t._v("startswith(msg)")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[t._v("匹配消息开头")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("msg: str")]),t._v(": 消息开头字符串")])])])]),t._v(" "),s("h2",{attrs:{id:"endswith-msg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#endswith-msg"}},[t._v("#")]),t._v(" "),s("code",[t._v("endswith(msg)")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[t._v("匹配消息结尾")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("msg: str")]),t._v(": 消息结尾字符串")])])])]),t._v(" "),s("h2",{attrs:{id:"keyword-keywords"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#keyword-keywords"}},[t._v("#")]),t._v(" "),s("code",[t._v("keyword(*keywords)")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[t._v("匹配消息关键词")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("*keywords: str")]),t._v(": 关键词")])])])]),t._v(" "),s("h2",{attrs:{id:"command-cmds"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#command-cmds"}},[t._v("#")]),t._v(" "),s("code",[t._v("command(*cmds)")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[t._v("命令形式匹配，根据配置里提供的 "),s("code",[t._v("command_start")]),t._v(", "),s("code",[t._v("command_sep")]),t._v(" 判断消息是否为命令。")]),t._v(" "),s("p",[t._v("可以通过 "),s("code",[t._v('state["_prefix"]["command"]')]),t._v(" 获取匹配成功的命令（例："),s("code",[t._v('("test",)')]),t._v("），通过 "),s("code",[t._v('state["_prefix"]["raw_command"]')]),t._v(" 获取匹配成功的原始命令文本（例："),s("code",[t._v('"/test"')]),t._v("）。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("*cmds: Union[str, Tuple[str, ...]]")]),t._v(": 命令内容")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("示例")])]),t._v(" "),s("p",[t._v("使用默认 "),s("code",[t._v("command_start")]),t._v(", "),s("code",[t._v("command_sep")]),t._v(" 配置")]),t._v(" "),s("p",[t._v("命令 "),s("code",[t._v('("test",)')]),t._v(" 可以匹配："),s("code",[t._v("/test")]),t._v(" 开头的消息\n命令 "),s("code",[t._v('("test", "sub")')]),t._v(" 可以匹配”"),s("code",[t._v("/test.sub")]),t._v(" 开头的消息")])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("命令内容与后续消息间无需空格！")])]),t._v(" "),s("h2",{attrs:{id:"regex-regex-flags-0"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#regex-regex-flags-0"}},[t._v("#")]),t._v(" "),s("code",[t._v("regex(regex, flags=0)")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[t._v("根据正则表达式进行匹配。")]),t._v(" "),s("p",[t._v("可以通过 "),s("code",[t._v('state["_matched"]')]),t._v(" 获取正则表达式匹配成功的文本。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("regex: str")]),t._v(": 正则表达式")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("flags: Union[int, re.RegexFlag]")]),t._v(": 正则标志")])])])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("正则表达式匹配使用 search 而非 match，如需从头匹配请使用 "),s("code",[t._v('r"^xxx"')]),t._v(" 来确保匹配开头")])]),t._v(" "),s("h2",{attrs:{id:"to-me"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#to-me"}},[t._v("#")]),t._v(" "),s("code",[t._v("to_me()")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("说明")])]),t._v(" "),s("p",[t._v("通过 "),s("code",[t._v("event.is_tome()")]),t._v(" 判断事件是否与机器人有关")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("ul",[s("li",[t._v("无")])])])])])}),[],!1,null,null,null);_.default=v.exports}}]);