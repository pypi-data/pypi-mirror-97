(window.webpackJsonp=window.webpackJsonp||[]).push([[200],{463:function(t,s,a){"use strict";a.r(s);var n=a(21),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"开始使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始使用"}},[t._v("#")]),t._v(" 开始使用")]),t._v(" "),a("p",[t._v("一切都安装成功后，你就已经做好了进行简单配置以运行一个最小的 NoneBot 实例的准备工作。")]),t._v(" "),a("h2",{attrs:{id:"最小实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最小实例"}},[t._v("#")]),t._v(" 最小实例")]),t._v(" "),a("p",[t._v("如果你已经按照推荐方式安装了 "),a("code",[t._v("nb-cli")]),t._v("，使用它创建一个空项目：")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("nb create\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("根据引导进行项目配置，完成后会在当前目录下创建一个项目目录，项目目录内包含 "),a("code",[t._v("bot.py")]),t._v("。")]),t._v(" "),a("p",[t._v("如果未安装 "),a("code",[t._v("nb-cli")]),t._v("，使用你最熟悉的编辑器或 IDE，创建一个名为 "),a("code",[t._v("bot.py")]),t._v(" 的文件，内容如下（这里以 CQHTTP 适配器为例）：")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" nonebot\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" nonebot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("adapters"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cqhttp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Bot "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" CQHTTPBot\n\nnonebot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nonebot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register_adapter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cqhttp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CQHTTPBot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nnonebot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load_builtin_plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__main__"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    nonebot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("h2",{attrs:{id:"解读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解读"}},[t._v("#")]),t._v(" 解读")]),t._v(" "),a("p",[t._v("在上方 "),a("code",[t._v("bot.py")]),t._v(" 中，这几行高亮代码将依次：")]),t._v(" "),a("ol",[a("li",[t._v("使用默认配置初始化 NoneBot")]),t._v(" "),a("li",[t._v("加载 NoneBot 内置的 CQHTTP 协议适配组件"),a("br"),t._v(" "),a("code",[t._v("register_adapter")]),t._v(" 的第一个参数我们传入了一个字符串，该字符串将会在后文 "),a("a",{attrs:{href:"#%E9%85%8D%E7%BD%AE-cqhttp-%E5%8D%8F%E8%AE%AE%E7%AB%AF-%E4%BB%A5-qq-%E4%B8%BA%E4%BE%8B"}},[t._v("配置 CQHTTP 协议端")]),t._v(" 时使用。")]),t._v(" "),a("li",[t._v("加载 NoneBot 内置的插件")]),t._v(" "),a("li",[t._v("在地址 "),a("code",[t._v("127.0.0.1:8080")]),t._v(" 运行 NoneBot")])]),t._v(" "),a("p",[t._v("在命令行使用如下命令即可运行这个 NoneBot 实例：")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nb-cli")]),t._v("\nnb run\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 其他")]),t._v("\npython bot.py\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("运行后会产生如下日志：")]),t._v(" "),a("div",{staticClass:"language-plain line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('09-14 21:02:00 [INFO] nonebot | Succeeded to import "nonebot.plugins.base"\n09-14 21:02:00 [INFO] nonebot | Running NoneBot...\n09-14 21:02:00 [INFO] uvicorn | Started server process [1234]\n09-14 21:02:00 [INFO] uvicorn | Waiting for application startup.\n09-14 21:02:00 [INFO] uvicorn | Application startup complete.\n09-14 21:02:00 [INFO] uvicorn | Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("h2",{attrs:{id:"配置协议端上报"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置协议端上报"}},[t._v("#")]),t._v(" 配置协议端上报")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("bot.py")]),t._v(" 文件中使用 "),a("code",[t._v("register_adapter")]),t._v(" 注册协议适配之后即可配置协议端来完成与 NoneBot 的通信，详细配置方法参考：")]),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"./cqhttp-guide.html"}},[t._v("配置 CQHTTP")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"./ding-guide.html"}},[t._v("配置钉钉")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"./mirai-guide.html"}},[t._v("配置 mirai-api-http")])],1)]),t._v(" "),a("p",[t._v("NoneBot 接受的上报地址与 "),a("code",[t._v("Driver")]),t._v(" 有关，默认使用的 "),a("code",[t._v("FastAPI Driver")]),t._v(" 所接受的上报地址有：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("/{adapter name}/")]),t._v(": HTTP POST 上报")]),t._v(" "),a("li",[a("code",[t._v("/{adapter name}/http/")]),t._v(": HTTP POST 上报")]),t._v(" "),a("li",[a("code",[t._v("/{adapter name}/ws")]),t._v(": WebSocket 上报")]),t._v(" "),a("li",[a("code",[t._v("/{adapter name}/ws/")]),t._v(": WebSocket 上报")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("如果到这一步你没有在 NoneBot 看到连接成功日志，比较常见的出错点包括：")]),t._v(" "),a("ul",[a("li",[t._v("NoneBot 监听 "),a("code",[t._v("0.0.0.0")]),t._v("，然后在协议端上报配置中填了 "),a("code",[t._v("ws://0.0.0.0:8080/***/ws")])]),t._v(" "),a("li",[t._v("在 Docker 容器内运行协议端，并通过 "),a("code",[t._v("127.0.0.1")]),t._v(" 访问宿主机上的 NoneBot")]),t._v(" "),a("li",[t._v("想从公网访问，但没有修改云服务商的安全组策略或系统防火墙")]),t._v(" "),a("li",[t._v("NoneBot 所监听的端口存在冲突，已被其它程序占用")]),t._v(" "),a("li",[t._v("弄混了 NoneBot 的 "),a("code",[t._v("host")]),t._v("、"),a("code",[t._v("port")]),t._v(" 参数与协议端上报配置中的 "),a("code",[t._v("host")]),t._v("、"),a("code",[t._v("port")]),t._v(" 参数")]),t._v(" "),a("li",[a("code",[t._v("ws://")]),t._v(" 错填为 "),a("code",[t._v("http://")])]),t._v(" "),a("li",[t._v("协议端或 NoneBot 启动时遭到外星武器干扰")])]),t._v(" "),a("p",[t._v("请尝试重启协议端 NoneBot、更换端口、修改防火墙、重启系统、仔细阅读前面的文档及提示、更新协议端 和 NoneBot 到最新版本等方式来解决。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);